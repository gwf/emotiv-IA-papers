Hindawi
Computational Intelligence and Neuroscience
Volume 2019, Article ID 2361282, 13 pages
https://doi.org/10.1155/2019/2361282

Research Article
Channel Projection-Based CCA Target Identification Method for
an SSVEP-Based BCI System of Quadrotor Helicopter Control
Qiang Gao ,1 Yuxin Zhang ,1 Zhe Wang ,1 Enzeng Dong ,1 Xiaolin Song ,2
and Yu Song 1
1

Tianjin Key Laboratory for Control Theory and Applications in Complicated Systems, Tianjin University of Technology,
Tianjin 300384, China
2
Engineering Training Center, Tianjin University of Technology, Tianjin 300384, China
Correspondence should be addressed to Xiaolin Song; songxiaolin16@hotmail.com and Yu Song; jasonsongrain@hotmail.com
Received 11 July 2019; Revised 21 November 2019; Accepted 27 November 2019; Published 16 December 2019
Academic Editor: Giosuè Lo Bosco
Copyright © 2019 Qiang Gao et al. This is an open access article distributed under the Creative Commons Attribution License,
which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.
The brain-computer interface (BCI) plays an important role in assisting patients with amyotrophic lateral sclerosis (ALS) to enable them to
participate in communication and entertainment. In this study, a novel channel projection-based canonical correlation analysis (CP-CCA)
target identiﬁcation method for steady-state visual evoked potential- (SSVEP-) based BCI system was proposed. The single-channel
electroencephalography (EEG) signals of multiple trials were recorded when the subject is under the same stimulus frequency. The CCAs
between single-channel EEG signals of multiple trials and sine-cosine reference signals were obtained. Then, the optimal reference signal of
each channel was utilized to estimate the test EEG signal. To validate the proposed method, we acquired the training dataset with two
testing conditions including the optimal time window length and the number of the trial of training data. The oﬄine experiments
conducted a comparison of the proposed method with the traditional canonical correlation analysis (CCA) and power spectrum density
analysis (PSDA) method using a 5-class SSVEP dataset that was recorded from 10 subjects. Based on the training dataset, the online 3Dhelicopter control experiment was carried out. The oﬄine experimental results showed that the proposed method outperformed the CCA
and the PSDA methods in terms of classiﬁcation accuracy and information transfer rate (ITR). Furthermore, the online experiments of 3DOF helicopter control achieved an average accuracy of 87.94 ± 5.93% with an ITR of 21.07 ± 4.42 bit/min.

1. Introduction
Brain-computer interface (BCI) is a direct communicationcontrol system which establishes a transmission channel
between electrical signals of a human’s brain and external
devices without the involvement of muscles and peripheral
nervous system [1]. For several decades, BCI techniques have
been increasingly developed by utilizing neurophysiological
signals, such as EEG, magnetoencephalography (MEG),
near-infrared spectroscopy (NIRS), and functional magnetic
resonance imaging (fMRI) [2–4]. Recently, EEG-based BCI
has been successfully used in clinical rehabilitation, assistive
mobility, mental-state recognition, and game due to its
noninvasiveness, reliability, portability, and remarkable time
signal resolution [5]. Moreover, BCI can not only improve
the quality of life of disabled people but also can provide

additional help and entertainment mode for healthy people
to achieve multifunctional augmentative and alternative
tasks [6].
Nowadays several basic paradigms have been utilized to
realize EEG-based BCIs, such as event-related potential
(ERP) [7], P300 potential [8], steady-state visual evoked
potential (SSVEP) [9, 10], slow cortical potential (SCP) [11],
and motor imagery (MI) [12]. SSVEP-based BCI has
attracted much attention due to its possibility of achieving a
high-dimensional control (degrees of freedom) which remains a critical issue for developing multidimensional and
multifunctional BCI applications. In addition, the high
signal-to-noise ratio (SNR), high ITR, and little training
required can be achieved by the SSVEP-based BCI system
[13]. The SSVEP is a periodic response of brain which is
reﬂected by repetitive visual stimuli ﬂickering with a certain

2
ﬁxed frequency (generally higher than 6 Hz). Several studies
have been proposed to develop SSVEP-based BCI applications. The 40-target SSVEP-based BCI was developed for the
high-speed brain speller, which can achieve an ITR of
267 bit/min [14]. An SSVEP-based BCI application was
designed for a maze game. The four operation instructions,
up, down, left, and right, were responded to four commands
of stimuli to control the movement of an object in a maze
[15]. The two diﬀerent types of visual stimuli, pattern-reversal checkerboard stimulus (PRCS) and grow/shrink
stimulus (GSS), were compared during SSVEP-based BCI
application in virtual reality environment. It indicated that
the optimal visual stimulus for an individual can improve
the performance of the SSVEP-based BCIs and reduce visual
fatigue in the VR environment [16]. The signal-channel
SSVEP-based BCI speller system was designed [17]. The
novel virtual keyboard contained 58 characters, special
symbols, and digits, and the ﬁve stimulation boxes
(6 cm × 6 cm) were present in each layer (three layers for one
target character). The online experiment accuracy is about
97.4% with the ITR of 49 ± 7.7 bit/min.
However, for real-life applications, the multichannel
system could not be widely accepted due to the high cost of
the device and a complicated setup process. The commercial
and low-cost EEG recording device, Emotiv EPOC, which
combines low spatial resolution and acceptable signal
quality, was used for BCI applications out of the lab. The
Emotiv EPOC was utilized in the shooting game in which the
subject could use their brain to control the direction of the
pistol in the online target shooting [18]. The researchers
designed a wearable BCI system based on SSVEP, which
enabled 3-D navigation of quadcopter ﬂight with immersive
ﬁrst-person visual feedback using a head-mounted device
[19]. Therefore, the Emotiv EPOC device is quite enough to
be used in portable daily-life applications to improve life
quality for healthy and disabled people [20].
To improve the performance of SSVEP-based BCIs, the
two main directions are taken into consideration [21]: increasing the number of stimuli classes and improving the
accuracy by target recognition algorithms. The number of
frequencies that can be presented on the computer screen is
limited by its refresh rate. Hence, to improve the control
performance and increase the number of selections, the
hybrid modality that combines SSVEP and other EEG
features (P300) or electrophysiology features has been developed [22]. Target recognition algorithms play an important role in enhancing the performance of SSVEP-based
BCIs. The power spectrum density analysis (PSDA) is a
widely utilized and easily implemented method in SSVEP
recognition, which estimates the PSD values of EEG signals
at diﬀerent frequencies within a speciﬁc time window,
typically by fast Fourier transform (FFT) and discrete
Fourier transform (DFT) [23]. The frequency with the
maximal PSD value (peak subsequently) is recognized as the
visual stimulus frequency. Nevertheless, the PSDA is sensitivity to noise that leads to low accuracy in the SSVEP
frequency detection. In addition, a relatively long time
window is usually required to estimate the spectrum that
may restrict its real-time application. To overcome the

Computational Intelligence and Neuroscience
limitations of PSDA, several studies have employed multivariate statistical analysis as classiﬁers to detect SSVEP
frequencies, such as canonical correlation analysis (CCA)
[24] and least absolute shrinkage and selection operator
(LASSO) [25]. The CCA-based classiﬁer has been used to
improve the classiﬁcation accuracy in the cases of multichannel-based application due to its ability to enhance the
SNR of the SSVEP-based BCI system [26]. The EEG data are
multidimensional, which contain diﬀerences of multiple
experiments, uncertainty among subjects, and so on.
However, the above algorithms cannot satisfy the need for
simultaneous processing of multidimensional information
in EEG signals (especially SSVEP). In order to solve this
limitation, we try to combine multidimensional signal
processing technology with CCA algorithm to optimize and
improve the performance of the BCI system in the process of
feature extraction and classiﬁcation of SSVEP.
This study proposed a channel projection-based target
recognition method with CCA to improve the performance
of an SSVEP-based BCI. The performance of an oﬄine
experiment was evaluated using a 5-target SSVEP dataset
recorded from 10 subjects. The traditional CCA method and
PSDA method were used to compare the performance with
the proposed method. After optimizing parameters (data
length, the number of training trials, and the number of
electrodes), an online BCI system was carried out to control
a 3-DOF helicopter by the proposed method. The structure
of the remaining parts of the paper is as follows: Section 2
describes all details of the used materials, proposed classiﬁcation/control methods, and oﬄine and online experimental setups. The oﬄine and online experimental results
are shown out in Section 3. Finally, discussion and conclusion are presented in Sections 4.

2. Materials and Methods
Figure 1 shows a block diagram of the proposed SSVEPbased BCI system. The subject sits on the chair in front of a
liquid crystal display (LCD) screen and stares at the stimuli
boxes. The raw EEG data are recorded by the dry electrodes
and then are transmitted to the host computer for preprocessing to increase the SNR. For target recognition, one
way is to combine the feature extraction method and feature
classiﬁcation method to ﬁnd the right stimulus frequency.
Another is using the diﬀerent target recognition methods to
identify the target stimuli. Finally, the control commands are
generated by the computer according to the classiﬁcation
results. The 3-D helicopter will conduct the control commands to move to the target position.
2.1. Experiment Environment. Ten healthy volunteers (7
males and 3 females) participated in the oﬄine and online
experiments, respectively. All participants ranged in age
from 21 to 26 (average age 24). These fully BCI-naive
subjects have normal or corrected to normal vision. All the
participants were informed by clear written consent about
the purpose and possible consequences of the experiment in
detail.

Computational Intelligence and Neuroscience

Signal
acquisition

Signal
preprocessing

3

Feature
classiﬁcation

Feature
extraction

Target
recognition
EEG
signal

Visual
stimulation

Visual feedback

3-D helicopter

Control
interface

Figure 1: Block diagram of the proposed BCI system.

In this BCI experiment, LCD was used to demonstrate
stimulus on the monitor that the resolution and refresh rate
are 1920 × 1080 pixels and 60 Hz, respectively. The blackwhite color combination was selected in the stimulator
design to show diﬀerent stimulus frequency. Each stimuli
box is a square of 4 cm × 4 cm, as shown in Figure 2(a). The
stimulus frequencies of the ﬁve targets are 6.67 Hz, 7.5 Hz,
8.57 Hz, 10 Hz, and 12 Hz which located at the left, middle,
right, top, and bottom of the screen, respectively.
Combined with the cost-eﬀective, portable, and no
training features, Emotiv EPOC headset is used to collect
EEG signals, and the device is shown in Figure 3. For brain
activity recording, 14 channels are placed on the standard
locations according to the 10–20 international system, which
are named AF3, F7, F3, FC5, T7, P7, O1, O2, P8, T8, FC6, F4,
F8, and AF4. Moreover, CMS/DRL reference positions are
also employed, which are located behind the ear of the
subject. The EEG signals are sampled at an internal rate of
2048 Hz and down-sampled to 128 Hz in each EEG channel.
2.2. Experimental Design
2.2.1. Oﬄine BCI Experiment. During the SSVEP-based BCI
experiment, the subjects seated in a comfortable position in a
normally bright room, with a 40 cm distance from the
monitor, which was placed in front of the subjects. For the
oﬄine experiment, the subjects performed a simulated
online experiment to record EEG data for oﬄine analysis.
The subjects were guided to gaze one of the ﬁve stimulus
targets according to the command that was sounded by the
speaker. Each subject completed 10 runs, and each run was
composed of 5 trials. To prevent the subjects from visual
fatigue, the 2 min break was given after 5 runs. Moreover,
every stimulus frequency was performed with a random
sequence. Each trial lasted 6 seconds and consists of two
parts: a cue phase with 1 s and a stimulation phase with 5 s.

Figure 4 shows the timing of the whole procedure. To reduce
eye movement artifacts, subjects were asked to avoid eye
blinks during the stimulation. The ten-fold cross-validation
was utilized to evaluate the precision of SSVEP recognition
for one subject. That means nine trails as the training dataset,
and then the rest one trial was the testing data. The traditional CCA method and PSDA method were used to
compare the performance with the proposed method.

2.2.2. Online BCI Experiment. The online experiment was
conducted to validate the eﬀectiveness of the proposed
feature recognition method. The oﬄine data were utilized as
a training dataset during the online experiment. The subject
was asked to control a 3-DOF helicopter by the proposed
method. The schematic of the helicopter is shown in Figure 5. The state-space equation of the linearized system was
utilized in our previous study [27]. The Matlab toolboxes
and QuanRC software were used to connect the experiment
platform for controlling the attitude of the 3-DOF helicopter. According to designed stimulus frequencies, four
tasks of the helicopter can be conducted (left, right, upward,
and downward movements) which correspond to four
stimuli positions on the screen. The middle stimuli box of
the screen is used to cancel the previous action when it
comes with a wrong command. The top view of the helicopter ﬂight task is shown in Figure 6. The subject was
required to navigate the helicopter from the start position A
to the target position B and then went back to position A.
When the helicopter received one control command, it
would move ten degrees along the axis in the corresponding
reorientation. Thus, 18 right commands should be produced
to ﬁnish the task. The number of correct counts of the 18
commands is used to evaluate the system accuracy. Once the
incorrect command is generated, the user can choose the
middle box to take the helicopter back to the last position.

Computational Intelligence and Neuroscience

4cm

4

4 cm

6.5cm

27cm

17 cm

48 cm
(a)

(b)

Figure 2: Stimulus design of 5-target BCI system. (a) The 5 stimuli boxes; (b) the control process.

AF3

AF4

F7

F8
F3

F4

FC5

FC6

T7

T8

DRL

CMS
P7

P8

O1

(a)

O2

(b)

Figure 3: EEG acquisition device. (a) Emotiv EPOC; (b) electrode position according to 10–20 EEG placement.

Cue

0

Stimulation phase

1

2

3

Trial 1 Trial 2 Trial 3 Trial 4 Trial 5
Run 1

4

5

Run 5

6

2min
break

t (s)

Run 10

Figure 4: The timing of the whole procedure.

To evaluate the overall system, the classiﬁcation accuracy
and ITR were calculated. The ITR is a well-known parameter
for BCI system evaluation [28]. For a trial with N possible
targets in which each target has the same possibility, the
classiﬁcation accuracy P that the target will be hit is the same
for each target. The higher ITR means that the BCI system
can transfer more information per unit of time. The bits of
information communicated per one minute were calculated
as follows:
60
1− P
(1)
R � log2 N + P log2 P +(1 − P)log2 􏼒
􏼓,
T
N− 1

where T represents the time window length. If the value of N
is ﬁxed, the ITR is only aﬀected by the value of T as well as by
the value of P. In this study, the number of targets is 5, and
the range of time window length is from 1 s to 5 s.
2.3. Target Recognition Algorithm
2.3.1. SSVEP Recognition Based on CCA. The CCA method is
able to calculate the underlying correlation between two
multidimensional data. Therefore, CCA extends the ordinary
correlation to two sets of random variables and has been widely

Computational Intelligence and Neuroscience

5

Pitch
axis

where s is the sampling rate. The brain dynamics plays a lowpass ﬁlter, and the high harmonic components in a square
wave may be ﬁltered. The four harmonics was used in this
work. The correlation coeﬃcients between the EEG signal
and diﬀerent reference signal is calculated by (3). As a result,
the target frequency fs is recognized as

Fb
Back
motor

ρ>0

Mb · g

Travel
axis

Lh

Ff

Front
motor

Mh · g

fs � max ρk ,

Mf · g

Lh

fk

λ>0

(4)

La

ε>0
Elevation
axis
Lw
Counterweight
Mw · g

Figure 5: The mathematical model of the 3-DOF helicopter.

used in the recognition of SSVEPs [24, 29]. In other words, the
CCA aims to ﬁnd a pair of linear transformations, which called
canonical variants, for two sets of multidimensional variable, so
as to achieve the maximum correlation between the two canonical variants. Suppose that two multidimensional random
variables X and Y (X ∈ Rh×i and Y ∈ Rj×i ). CCA ﬁnds a pair of
weight vectors wX ∈ Rh×1 and wY ∈ Rj×1 , respectively, which
maximize the correlation between linear combinations x �
wTX X and y � wTY Y. It is deﬁned as
E􏼂xyT 􏼃
max ρ(x, y) � 􏽱�������������
wX ,wY
E􏼂xxT 􏼃E􏼂yyT 􏼃
E􏼂wTX XYT wY 􏼃
�,
� 􏽱�����������������������
E􏼂wTX XXT wX 􏼃E􏼂wTY YYT wY 􏼃

(2)

where max ρ is the maximum canonical correlation. x and y
are projected onto wX and wY . Therein, XXT and YYT are
the within-sets covariance matrices, and XYT is the betweensets covariance matrix. Each CCA leads to a number of
solutions max ρ equal to the minimum between the number
of rows in X (h) and Y (j). The solutions max ρ are a measure
of the similarity between the two sets of original data.
To distinguish the m stimulation frequencies, the CCA
will be performed m times. For a certain stimulation frequency fk (k � 1, 2, . . . , m), the CCA between the multichannel EEG signal in X (h presents the number of EEG
channels, and i is the number of sampling points in each
channel) and a reference signals in Yi is calculated. Y is the
reference signal that is artiﬁcially generated with sine and
cosine waves at the stimulus frequency fk , and j is the
number of harmonics. The reference signals are set as
sin 2πfk t􏼁
⎟
⎜
⎞
⎛
⎟
⎜
⎜
⎟
⎜
cos 2πfk t􏼁 ⎟
⎟
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎟
,
Yi � ⎜
⋮
⎟
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎟
⎜
⎜
⎟
⎜
⎠
⎝ sin 2πjfk t􏼁 ⎟
cos 2πjfk t􏼁

k � 1, 2, . . . , m.

12
i
t � , ,..., ,
s s
s

(3)

2.3.2. Channel Projection-Based Target Recognition
Method with CCA. Although the powerful performance of
the CCA-based method in detecting SSVEP has been proved
by researchers [24, 26, 30]. However, the detectability of
SSVEP with diﬀerent frequencies can be inﬂuenced by the
power-law distribution of the power spectra spontaneous
electroencephalogram (EEG) signals. Thus, CCA may not
give best accuracy for SSVEP classiﬁcation, especially in
using a relatively short time window. Several studies have
tried to alleviate this problem. An unsupervised method is
reported to derive normalized canonical correlation coeﬃcients for CCA to enhance the frequency detection of
SSVEP. Zhang et al. proposed the MCCA [31] and L1MCCA [32] methods to optimize sine-cosine reference
signals by correlating the multiple dimensions of EEG
signals. Then, the common features were used as reference
signals instead of sine-cosine signals to improve recognition
accuracy. The core idea of those methods is using multiple
trials that the subject focuses attention on the same visual
stimuli to get a reference signal through the training procedure, which can reduce the inherent diﬀerences of the
subject.
Inspired by the above study, we utilized the CCA method
to ﬁnd optimal data to represent the multiple trials of EEG
data that were recorded by the single channel when the
subject gazed at the same frequency of visual stimuli. Figure 7 illustrates the ﬂowchart of the proposed CP-CCA
(channel projection-based CCA). Suppose that recorded
EEG data of multitrials in the speciﬁc stimulus frequency are
Xh,fk ∈ Rn×i , n is the number of trials, and h represents four
diﬀerent channels (O1, O2, P7, and P8). Here two vectors
wh,x ∈ Rn×1 and wh,y ∈ Rj×1 are selected to ﬁnd the maxi􏽢 h,f � wT × Xh,f and
mum correlation coeﬃcient of X
h,x
k
k
T
􏽢 f � w × Yf . The maximum correlation of one channel
Y
h,y
k
k
can be described as
T

􏽢 h,f Y
􏽢 􏼕
E􏼔 X
k fk
��������������������
�
􏽲
max ρh �
wh,x ,wh,x
T
T
􏽢
􏽢
􏽢
􏽢
E􏼔Xh,fk Xh,fk 􏼕E􏼔Yfk Yfk 􏼕
E􏼔wTh,x Xh,fk YTfk wTh,y 􏼕
􏽲
���������������������������������
�.
�
T
T
T
T
T
T
E􏽨wh,x Xh,fk Xh,fk wh,x 􏽩E􏼔wh,y Yfk Yfk wh,y 􏼕
(5)
􏽢 h,f reﬂects the frequency comThe reference signal X
k
ponent of SSVEP of diﬀerent channels. Moreover, it contains
the common character of the single channel with multitrials

6

Computational Intelligence and Neuroscience
O
Contact point
40°

10°

B

A
B

A

(a)

(b)

Figure 6: The top view of the helicopter ﬂight task. (a) Flight experimental setup; (b) location information and motion curve, the contact
point moves from position A to position B and then goes back to position A, and the moving step is 10 degrees in four directions (up, down,
left, and right).

fm

f1
O1

XO1,f1 =

xO1,f1,1
xO1,f1,2
..
.
xO1,f1,n

CCA

O2

XO2,f1 =

xO2,f1,1
xO2,f1,2
..
.
xO2,f1,n

CCA

Harmonics of
stimulus signal

Yf1 =

P7

XP7,f1 =

xP7,f1,1
xP7,f1,2
..
.
xP7,f1,n

CCA

P8

XP8,f1 =

xP8,f1,1
xP8,f1,2
..
.
xP8,f1,n

CCA

yf1,1
yf1,2
yf1,3
yf1,4

XO1,fm

CCA

XO2,fm

CCA

Harmonics of
stimulus signal

yfm,1
y

Yfm = yfm,2
fm,3

…
XP7,fm

CCA

XP8,fm

CCA

yfm,4

Test signal
O1Test
O2Test
P7Test
P8Test

ρO1,f1
ρO2,f1

ρO1,fm

XO1,f1
X

O2,f1

ρP7,f1

XP7,f1

ρP8,f1

XP8,f1

ρf1 = ρO1,f1 + ρO2,f1 + ρP7,f1 + ρP8,f1

= Xh,f1

…

…

ρO2,fm

XO1,fm
XO2,fm

ρP7,fm

XP7,fm

ρP8,fm

XP8,fm

= Xh,fm

ρfm = ρO1,fm + ρO2,fm + ρP7,fm + ρP8,fm

fs = max ρf k

Figure 7: The process of the proposed CP-CCA (channel projection-based CCA) for SSVEP target recognition. For the same target
frequency fm , the diﬀerent trials of recorded EEG data are dispersed and then reorganized according to the diﬀerent channels,
􏽢 O1,f , X
􏽢 O2,f , X
􏽢 P7,f , and X
􏽢 P8,f ) under certain stimulus
XO1,fk , XO2,fk , XP7,fk , and XP8,fk . The optimal reference signals of diﬀerent channels (X
k
k
k
k
frequency fk are obtained by the CCA between the channel-based EEG data and the sine-cosine signals Yfk . The SSVEP target frequency fs
of a new test data of single trial is recognized according to the maximum value of the sum of ρh,fk .

Computational Intelligence and Neuroscience

7
6.67Hz

for the same stimulation frequency. When optimal reference
􏽢 h,f , X
􏽢 h,f , . . . ,
signals of diﬀerent stimulus frequencies X
1
2
􏽢 h,f were obtained, the correlation coeﬃcient ρh,f between
X
m
k
the test signal and reference signal of the single channel (O1,
O2, P7, and P8) can be calculated. The new test data of a
single trial are recognized according to the maximum value
ρfk , which is the sum of ρh,fk , and can be deﬁned as
ρfk � ρO1,fk + ρO2,fk + ρp7,fk + ρp8,fk .

(6)

7.5Hz
+

–
8.75Hz

10Hz

12 Hz

In this work, the number of target stimulation frequency
m � 5. For the reference signal, its fundamental and second
frequency components are considered in this design.

3. Results
3.1. Oﬄine Experimental Results. The oﬄine experiment
aims to ﬁnd the optimal parameter for online SSVEP recognition. In this oﬄine analysis, the optimal time window
length and the number of training data are discussed.
Figure 8 shows the brain frequency power map of subject S1
of one run. The red color represents the brain activity is
markedly intense. On the contrary, the blue denotes parts of
the brain that do not show signiﬁcant activity.
Figure 9 shows the averaged detection accuracy for each
of ten subjects obtained by the PSDA, CCA, and proposed
CP-CCA with respect to time window length from 1 s to 5 s.
The accuracy was estimated by 10-fold cross validation, in
which 9 trials were used as training data, respectively, and 1
trial was used as test data. The results indicated that the
classiﬁcation accuracy was increasing with the stimulus time.
Figure 10 depicts the average accuracy of all subjects by
the three methods. These results demonstrate that the
proposed CP-CCA signiﬁcantly outperformed the PSDA
and CCA for SSVEP-based target recognition at time
window from 1 s to 5 s. The highest classiﬁcation accuracy of
the proposed CP-CCA was 90.09% for 5 s time window,
whereas CCA and PSDA methods achieve their highest
accuracy of 81.02% and 73.04%, respectively, in the case of
5 s window length.
Figure 11 shows the correlation coeﬃcients of each
channel (P7, P8, O1, and O2) and the averaged value of four
channels corresponding to diﬀerent reference signal frequencies (6.67 Hz, 7.5 Hz, 8.57 Hz, 10 Hz, and 12 Hz) derived from 10-fold cross validation by the proposed CP-CCA
at 5 s time window, when each of the ﬁve stimulus frequencies was used as the target frequency. In addition, these
results were compared with the CCA-based method in the
same experimental condition. From the results, compared to
the CCA, the proposed CP-CCA achieved a higher correlation coeﬃcient (average value of four channels) for the
target frequency.
In addition, another analysis was carried out to ﬁnd the
optimal channel montage, and the result is shown in
Figure 12. The accuracy was estimated by 10-fold crossvalidation. The experimental results indicated that the
combination of O1 and O2 has higher accuracy than the
combination of P7 and P8 in ﬁve stimulus frequencies with
diﬀerent time window length but lower than the combination of O1, O2, P7, and P8. The results also

Figure 8: The brain frequency power map of subject 1 under 5
diﬀerent stimulus frequencies.

demonstrated that, in most cases, the combination of the
ipsilateral electrodes has better results than the combination of the contralateral electrodes. The combination of
O1 and O2 makes a signiﬁcant contribution to the SSVEP
detectability. Finally, we choose four channels (P7, P8, O1,
and O2) as a combination, due to their higher classiﬁcation
accuracy.
Figure 13 shows the average classiﬁcation accuracy of all
subjects with the number of training trails (from 2 to 10)
using 5 s window length. The highest accuracy of 90.09% was
obtained when the numbers of training trials were 10. In
addition, when the number of training trial was 5, the
classiﬁcation accuracy is over 89%.
3.2. Real-Time Experimental Results. For ensuring both
detection accuracy and ITR, during the online experiment,
the selected time window is 4 s. The 0.5 s interval was given
to subjects to shift their gaze between the 3-D helicopter and
stimuli boxes. Table 1 lists the results of the online experiment of the 3-DOF helicopter control across 10 subjects. 4
training trials of the oﬄine experiment were utilized for
each of the 5 stimulus frequencies. The average accuracy
of the proposed control strategy over all subjects was
87.94 ± 5.93%, and the average of the commands was
23.60 ± 3.24 bit/min. All subjects achieved accuracy of over
80%. Moreover, subject 1 successfully completed the control
task without any mistake. The average ITR is 21.07 ± 4.42 bit/
min.

4. Discussion and Conclusion
In this work, we aimed to develop a practicable SSVEP-based
BCI system by Emotiv EPOC considering real-life feasibility.
The target identiﬁcation algorithm plays an important role
in the improvement of the performance of the SSVEP-based
BCI system since other elements such as stimulus design and
the number of electrodes should also be taken into consideration. To evaluate the eﬀectiveness of the proposed CPCCA target identiﬁcation method, we compared its

Computational Intelligence and Neuroscience
100

100

90

90

90

90

80

80

80

80

70
60

70
60

70
60

70
60

50

50

50

50

40

40

40

40

30

1

2
3
4
Time window (s)

30

5

1

2
3
4
Time window (s)

30

5

1

2
3
4
Time window (s)

30

5

PSDA

PSDA

CCA

CCA

CCA

CP-CCA

CP-CCA

CP-CCA

CP-CCA

(b)

(c)

(d)

90

90

90

80

80

80

80

60

70
60

Accuracy (%)

90

Accuracy (%)

100

Accuracy (%)

100

70

70
60

70
60

50

50

50

50

40

40

40

40

2
3
4
Time window (s)

30

5

1

2
3
4
Time window (s)

30

5

1

2
3
4
Time window (s)

5

30

1

2
3
4
Time window (s)

PSDA

PSDA

PSDA

CCA

CCA

CCA

CCA

CP-CCA

CP-CCA

CP-CCA

CP-CCA

(f )
100

90

90

80

80

70
60

60
50

40

40
1

2
3
4
Time window (s)
PSDA

5

30

1

2
3
4
Time window (s)

5

PSDA

CCA

CCA

CP-CCA

CP-CCA

(i)

(h)

70

50

30

5

PSDA

(g)

100

Accuracy (%)

Accuracy (%)

(e)

5

PSDA

100

1

2
3
4
Time window (s)

CCA

100

30

1

PSDA

(a)

Accuracy (%)

Accuracy (%)

100

Accuracy (%)

100

Accuracy (%)

Accuracy (%)

8

(j)

Figure 9: The averaged detection accuracy for each of ten subjects obtained by the PSDA, CCA, and proposed CP-CCA with respect to time
window length from 1 s to 5 s. (a) S1. (b) S2. (c) S3. (d) S4. (e) S5. (f ) S6. (g) S7. (h) S8. (i) S9. (j) S10.

Computational Intelligence and Neuroscience

9

100

90

Accuracy (%)

80

70

60

50

40

30

1

2
3
4
Time window (s)

5

PSDA
CCA
CP-CCA

0.4

0.4

0.3

0.3

0.3

0.2

0.1

Correlation coeﬃcient

0.4

Correlation coeﬃcient

Correlation coeﬃcient

Figure 10: The average accuracy of all subjects by the PSDA, CCA, and proposed CP-CCA with respect to time window length from 1 s to 5 s.

0.2

0.1

0

0.1

0
6.67 Hz 7.5 Hz 8.75Hz 10Hz 12Hz
Reference signal frequency fs = 6.67HZ

0.2

0
6.67Hz 7.5Hz 8.75Hz 10Hz 12Hz
Reference signal frequency fs = 7.5HZ

6.67Hz 7.5Hz 8.75Hz 10Hz 12Hz
Reference signal frequency fs = 8.75 HZ

P7

O2

P7

O2

P7

O2

P8

Average value

P8

Average value

P8

Average value

O1

CCA

O1

CCA

O1

CCA

(a)

(b)

Figure 11: Continued.

(c)

Computational Intelligence and Neuroscience
0.4

0.4

0.3

0.3

Correlation coeﬃcient

Correlation coeﬃcient

10

0.2

0.1

0

0.2

0.1

0

6.67Hz 7.5Hz 8.75Hz 10Hz 12Hz
Reference signal frequency fs = 10HZ

6.67Hz 7.5 Hz 8.75Hz 10Hz 12Hz
Reference signal frequency fs = 12HZ

P7

O2

P7

O2

P8

Average value

P8

Average value

O1

CCA

O1

CCA

(d)

(e)

Figure 11: The correlation coeﬃcients corresponding to diﬀerent reference signal frequencies (6.67 Hz, 7.5 Hz, 8.57 Hz, 10 Hz, and 12 Hz)
derived from 10-fold cross-validation by the CP-CCA (average value) and CCA at 5 s time window, when each of the ﬁve stimulus
frequencies was used as the target frequency fs .

100

90

Accuracy (%)

80

70

60

50

40

30

1

2

3
4
Time window (s)

O1, O2
P7, P8
P7, O1
P7, O2

5

P8, O1
P8, O2
O1, O2,P7,P8

Figure 12: Comparison of detection accuracy of the diﬀerent combination of electrodes placement with respect to time window length by
the proposed CP-CCA method.

Computational Intelligence and Neuroscience
100

90

Accuracy (%)

80

70

60

50

40

30

2

3 4 5 6 7 8 9 10
Number of training trials

Figure 13: The average classiﬁcation accuracy with diﬀerent numbers
of training trials for all subjects in terms of 5 s window length.

Table 1: Results of the online 3-DOF helicopter control
experiments.
Subject
No. of commands Accuracy (%) ITR (bit/min)
S1
18
100.00
30.96
S2
24
87.50
20.38
S3
20
95.00
25.81
S4
28
82.14
17.17
S5
24
87.50
20.38
S6
22
90.91
22.68
S7
26
84.61
18.59
S8
28
82.14
17.17
S9
28
82.14
17.17
S10
24
87.50
20.38
Mean ± STD
23.60 ± 3.24
87.94 ± 5.93 21.07 ± 4.42

performance with the traditional CCA and PSDA methods.
As shown in Figure 10, the proposed method obtained
higher classiﬁcation accuracy than CCA and PSDA for all
time windows. During this study, the single channel EEG
signals of multiple trials were recorded when the subject is
under the same stimulus frequency. The CCAs between
single-channel of multitrials EEG signals and sine-cosine
reference signals were obtained. The optimal reference signal
contains the common character of the single channel with
diﬀerent trials under the same stimulus frequency. Figure 11
provides evidence for the superior SSVEP-based recognition
accuracy over the CCA. The use of CP-CCA may solve the
limitation of interference from the spontaneous EEG activities and reduce the inherent diﬀerences of the subject.
The proposed CP-CCA requires individual training data
before the online BCI control experiment. The number of
training trials is an important parameter in target

11
reorganization. As shown in Figure 13, the classiﬁcation accuracy increased with the number of training trials. However,
for a convenient and eﬃcient online BCI system, the no
training or few training times is essential [13]. From the oﬄine
experimental results, the classiﬁcation accuracy of the 5-fold
cross validation over 89% was achieved. In addition, reminding
that an increase in window length may cause a decrease in ITR,
an increase in the time of each command, and increase in the
total time to complete a task. For ensuring both detection
accuracy and ITR, 4 s time window was selected for online
experiment. The experiment results from 10 subjects in controlling the 3-DOF helicopter showed that the averaged accuracy was 87.94 ± 5.93% with an ITR of 21.07 ± 4.42 bit/min.
The online averaged accuracy was slightly lower than the oﬄine
that using the same number of training trials. The diﬀerence
might be inﬂuenced by the experimental conditions between
the online and oﬄine modes, such as SNR of the EEG signal
light conditions in the room, subjects’ visual fatigue, and
subject’s awareness of 3-DOF helicopter control. Some studies
showed that spatial ﬁltering techniques were eﬀective to
remove EEG artifact, leading to increasing SNR and SSVEP
classiﬁcation [24, 33]. Another factor was the low resolution in
accuracy during the online experiment (100% means that the
subject continuously executes 18 right commands). In addition,
the result from the low sampling frequency and fewer useful
channels for SSVEP target recognition of Emotiv EPOC, the
classiﬁcation accuracy, and ITR of the designed system are
limited. Some studies utilized 8 or 9 channels for SSVEP target
recognition by the CCA-based method. However, in real-life
applications, a multichannel system could be an ineﬃcient
device because of its complicated setup. The convenience of the
Emotiv EPOC which increases the usability as well as reduce
the complexity of the system while maintaining the wearing
comfort over time may make up the shortcoming.
In this paper, we proposed a novel channel projectionbased CCA target identiﬁcation method for the SSVEPbased BCI system with a portable device. The oﬄine analysis
results showed that the proposed method outperformed the
CCA and PSDA methods in terms of classiﬁcation accuracy.
The online application was validated by the 3-DOF helicopter control experiment. 10 subjects achieved an average
accuracy of 87.94 ± 5.93% with an ITR of 21.07 ± 4.42 bit/
min. By using the low-cost EEG acquisition device, this
study will encourage more real-life BCI applications for
communication and control in assisting people with disabilities. An automated system is a key feature for eﬃcient
BCI control. Further studies will be performed to develop
programmable program to reduce the total number of
commands and improve the ﬂexibility and practicability of
the system for disabled.

Data Availability
The [.txt] data used to support the ﬁndings of this study are
available from the corresponding author upon request.

Conflicts of Interest
The authors declare that they have no conﬂicts of interest.

12

Computational Intelligence and Neuroscience

Acknowledgments
This research was funded by the Young and Middle-Aged
Innovation Talents Cultivation Plan of Higher Institutions in
Tianjin (grant no. 20130830) and the Natural Science
Foundation of Tianjin (grant no. 18JCYBJC87700).

[16]

References
[1] J. R. Wolpaw, N. Birbaumer, W. J. Heetderks et al., “Braincomputer interface technology: a review of the ﬁrst international meeting,” IEEE Transactions on Rehabilitation
Engineering, vol. 8, no. 2, pp. 164–173, 2000.
[2] G. Schalk, P. Brunner, L. A. Gerhardt, H. Bischof, and
J. R. Wolpaw, “Brain-computer interfaces (BCIs): detection
instead of classiﬁcation,” Journal of Neuroscience Methods,
vol. 167, no. 1, pp. 51–62, 2008.
[3] N. Naseer and K. S. Hong, “fNIRS-based brain-computer
interfaces: a review,” Frontiers in Human Neuroscience, vol. 9,
p. 3, 2015.
[4] K. E. Schroeder and C. A. Chestek, “Intracortical brainmachine interfaces advance sensorimotor neuroscience,”
Frontiers in Neuroscience, vol. 10, p. 291, 2016.
[5] F. Lotte, L. Bougrain, A. Cichocki et al., “A review of classiﬁcation algorithms for EEG-based brain–computer interfaces: a 10 year update,” Journal of Neural Engineering,
vol. 15, no. 3, Article ID 031005, 2018.
[6] N. Birbaumer, C. Weber, C. Neuper, E. Buch, K. Haapen, and
L. Cohen, “Physiological regulation of thinking: brain-computer interface (BCI) research,” Progress in Brain Research,
vol. 159, no. 1, pp. 369–391, 2006.
[7] H. Cecotti, “Spelling with non-invasive brain-computer
interfaces—current and future trends,” Journal of PhysiologyParis, vol. 105, no. 1–3, pp. 106–114, 2011.
[8] R. Carabalona, F. Grossi, A. Tessadri, P. Castiglioni,
A. Caracciolo, and I. de Munari, “Light on! real world
evaluation of a P300-based brain-computer interface (BCI)
for environment control in a smart home,” Ergonomics,
vol. 55, no. 5, pp. 552–563, 2012.
[9] Q. Liu, K. Chen, Q. Ai, and S. Xie, “Review: recent development of signal processing algorithms for SSVEP-based
brain computer interfaces,” Journal of Medical and Biological
Engineering, vol. 34, no. 4, pp. 299–309, 2014.
[10] Y.-J. Chen, S.-C. Chen, I. Zaeni, and C.-M. Wu, “Fuzzy
tracking and control algorithm for an SSVEP-based BCI
system,” Applied Sciences, vol. 6, no. 10, p. 270, 2016.
[11] N. Birbaumer, N. Ghanayim, T. Hinterberger et al., “A
spelling device for the paralysed,” Nature, vol. 398, no. 6725,
pp. 297-298, 1999.
[12] G. Pfurtscheller and F. H. Lopes da Silva, “Event-related EEG/
MEG synchronization and desynchronization: basic principles,” Clinical Neurophysiology, vol. 110, no. 11,
pp. 1842–1857, 1999.
[13] M. Nakanishi, Y. Wang, X. Chen, Y. T. Wang, X. Gao, and
T. P. Jung, “Enhancing detection of SSVEPs for a high-speed
brain speller using task-related component analysis,” IEEE
Transactions on Biomedical Engineering, vol. 65, no. 1,
pp. 104–112, 2018.
[14] X. Chen, Y. Wang, M. Nakanishi, X. Gao, T.-P. Jung, and
S. Gao, “High-speed spelling with a noninvasive braincomputer interface,” Proceedings of the National Academy of
Sciences, vol. 112, no. 44, pp. E6058–E6067, 2015.
[15] N. Chumerin, N. V. Manyakov, M. van Vliet, A. Robben,
A. Combaz, and M. Van Hulle, “Steady-state visual evoked

[17]

[18]

[19]

[20]

[21]

[22]

[23]

[24]

[25]

[26]

[27]

[28]

[29]

[30]

potential-based computer gaming on a consumer-grade EEG
device,” IEEE Transactions on Computational Intelligence and
AI in Games, vol. 5, no. 2, pp. 100–110, 2013.
K. Choi, S. Park, and C. H. Im, “Comparison of visual stimuli
for steady-state visual evoked potential-based brain-computer
interfaces in virtual reality environment in terms of classiﬁcation accuracy and visual comfort,” Computational Intelligence and Neuroscience, vol. 2019, Article ID 9680697,
7 pages, 2019.
T. H. Nguyen and W. Y. Chung, “A single-channel SSVEPbased BCI speller using deep learning,” IEEE Access, vol. 7,
pp. 1752–1763, 2019.
M. Ignas and D. A. Robertas, “Prototype SSVEP based real
time BCI gaming system,” Computational Intelligence and
Neuroscience, vol. 2016, Article ID 3861425, 15 pages, 2016.
M. Wang, R. Li, R. Zhang, G. Li, and D. Zhang, “A wearable
SSVEP-based BCI system for quadcopter control using headmounted device,” IEEE Access, vol. 6, pp. 26789–26798, 2018.
Q. Gao, X. Zhao, X. Yu, Y. Song, and Z. Wang, “Controlling of
smart home system based on brain-computer interface,”
Technology and Health Care, vol. 26, no. 5, pp. 769–783, 2018.
M. Nakanishi, Y. Wang, Y. T. Wang, Y. Mitsukura, and
T. P. Jung, “A high-speed brain speller using steady-state
visual evoked potentials,” International Journal of Neural
Systems, vol. 24, no. 6, Article ID 1450019, 2014.
H. Wang, Y. Li, J. Long, T. Yu, and Z. Gu, “An asynchronous
wheelchair control by hybrid EEG-EOG brain-computer
interface,” Cognitive Neurodynamics, vol. 8, no. 5, pp. 399–
409, 2014.
G. Hakvoort, B. Reuderink, and M. Obbink, Comparison of
PSDA and CCA Detection Methods in a SSVEP-Based BCI
System, Centre for Telematics & Information Technology
University of Twente, Enschede, Netherlands, 2011.
Z. Lin, C. Zhang, W. Wu, and X. Gao, “Frequency recognition
based on canonical correlation analysis for SSVEP-Based
BCIs,” IEEE Transactions on Biomedical Engineering, vol. 54,
no. 6, pp. 1172–1176, 2007.
Y. Zhang, J. Jin, X. Qing, B. Wang, and X. Wang, “LASSO
based stimulus frequency recognition model for SSVEP
BCIs,” Biomedical Signal Processing and Control, vol. 7, no. 2,
pp. 104–111, 2012.
G. Bin, X. Gao, Z. Yan, B. Hong, and S. Gao, “An online multichannel SSVEP-based brain–computer interface using a canonical correlation analysis method,” Journal of Neural Engineering, vol. 6, no. 4, Article ID 046002, 2009.
Y. Song, J. Liu, Q. Gao, and M. Liu, “A quadrotor helicopter
control system based on Brain-computer interface,” in Proceedings of the 2015 IEEE International Conference on
Mechatronics and Automation (ICMA), pp. 1478–1483, Beijing, China, August 2015.
J. R. Wolpaw, N. Birbaumer, D. J. McFarland, G. Pfurtscheller,
and T. M. Vaughan, “Brain-computer interfaces for communication and control,” Clinical Neurophysiology, vol. 113,
no. 6, pp. 767–791, 2002.
P. Yuan, X. Chen, Y. Wang, X. Gao, and S. Gao, “Enhancing
performances of SSVEP-based brain-computer interfaces via
exploiting inter-subject information,” Journal of Neural Engineering, vol. 12, no. 4, Article ID 046006, 2015.
V. Mondini, A. L. Mangia, L. Talevi, and A. Cappello, “Sincwindowing and multiple correlation coeﬃcients improve
SSVEP recognition based on canonical correlation analysis,”
Computational Intelligence and Neuroscience, vol. 2018, Article ID 4278782, 11 pages, 2018.

Computational Intelligence and Neuroscience
[31] Y. Zhang, G. Zhou, Q. Zhao et al., “Multiway canonical
correlation analysis for frequency components recognition in
SSVEP-Based BCIs,” in Proceddings of the 18th International
Conference on Neural Information Processing (ICONIP 2011),
pp. 287–295, Shanghai, China, 2013.
[32] Y. Zhang, G. Zhou, J. Jin, M. Wang, X. Wang, and
A. Cichocki, “L1-regularized multiway canonical correlation
analysis for SSVEP-based BCI,” IEEE Transactions on Neural
Systems and Rehabilitation Engineering, vol. 21, no. 6,
pp. 887–896, 2013.
[33] A. T. Sözer and C. B. Fidan, “Novel spatial ﬁlter for SSVEPbased BCI: a generated reference ﬁlter approach,” Computers
in Biology and Medicine, vol. 96, pp. 98–105, 2018.

13

Advances in

Multimedia
Applied
Computational
Intelligence and Soft
Computing
Hindawi
www.hindawi.com

Volume 2018

The Scientific
World Journal
Hindawi Publishing Corporation
http://www.hindawi.com
www.hindawi.com

Volume 2018
2013

Mathematical Problems
in Engineering
Hindawi
www.hindawi.com

Volume 2018

Engineering
Journal of

Hindawi
www.hindawi.com

Volume 2018

Hindawi
www.hindawi.com

Modelling &
Simulation
in Engineering
Hindawi
www.hindawi.com

Volume 2018

Advances in

Artificial
Intelligence
Hindawi
www.hindawi.com

Volume 2018

Volume 2018

Advances in
International Journal of

Reconfigurable
Computing

Hindawi
www.hindawi.com

Fuzzy
Systems

Submit your manuscripts at
www.hindawi.com

Hindawi
www.hindawi.com

Volume 2018

Volume 2018

Journal of

Hindawi
www.hindawi.com

International Journal of

Advances in

Scientific
Programming

Engineering
Mathematics

Human-Computer
Interaction
Volume 2018

Hindawi
www.hindawi.com

Computer Networks
and Communications

Volume 2018

Hindawi
www.hindawi.com

Advances in

Civil Engineering
Volume 2018

Hindawi
www.hindawi.com

Volume 2018

Hindawi
www.hindawi.com

Volume 2018

International Journal of

Biomedical Imaging

International Journal of

Robotics
Hindawi
www.hindawi.com

Journal of

Computer Games
Technology

Journal of

Volume 2018

Hindawi
www.hindawi.com

Electrical and Computer
Engineering
Volume 2018

Hindawi
www.hindawi.com

Volume 2018

Hindawi
www.hindawi.com

Volume 2018

Computational Intelligence
and Neuroscience
Hindawi
www.hindawi.com

Volume 2018

