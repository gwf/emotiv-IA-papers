Artículo de Investigación/Research Article

TecnoLógicas
ISSN-p 0123-7799
ISSN-e 2256-5337
Vol. 22, No. 46, pp 213-231
Sep-dic de 2019

Evaluación del aporte de la
covarianza de las señales
electroencefalográficas a las
interfaces cerebro-computador de
imaginación motora para pacientes
con lesiones de médula espinal
Assessing the Contribution of Covariance
Information to the Electroencephalographic
Signals of Brain–Computer Interfaces for
Spinal Cord Injury Patients
1,
Carlos Ferrin-Bolaños
Humberto Loaiza-Correa 2,
Jean Pierre-Díaz 3, Paulo Vélez-Ángel

4

Recibido: 05 de marzo de 2019
Aceptado: 19 de junio de 2019
Cómo citar / How to cite
C. Ferrin-Bolaños, H. Loaiza-Correa, J. Pierre-Díaz, P. Vélez-Ángel,
“Evaluación del aporte de la covarianza de las señales
electroencefalográficas a las interfaces cerebro-computador de
imaginación motora para pacientes con lesiones de médula espinal”.
TecnoLógicas, vol. 22, no. 46, pp. 213-231, 2019.
https://doi.org/10.22430/22565337.1392

1

2

© Instituto Tecnológico Metropolitano
Este trabajo está licenciado bajo una
Licencia Internacional Creative
Commons Atribución (CC BY-NC-SA)

3

4

M.Sc. en Ingeniería Electrónica, Grupo de Percepción y Sistemas
Inteligentes, Facultad de Ingeniería, Universidad del Valle, Cali-Colombia,
carlos.ferrin@correounivalle.edu.co
PhD. en Robótica, Grupo de Percepción y Sistemas Inteligentes, Facultad de
Ingeniería, Universidad del Valle, Cali-Colombia,
humberto.loaiza@correounivalle.edu.co
Ing. Electrónico, Grupo de Percepción y Sistemas Inteligentes, Facultad de
Ingeniería, Universidad del Valle, Cali-Colombia,
jean.diaz@correounivalle.edu.co
M.Sc. en Instrumentación Física, Grupo de Investigación Khimera, Facultad
de Ingeniería, Fundación Universitaria Católica Lumen Gentium, CaliColombia, pavelez@unicatolica.edu.co

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

Resumen
Las interfaces cerebro-computadora no invasivas basadas en EEG de imaginación
motora (miBCI) prometen restaurar efectivamente el control motor a pacientes con
discapacidades motoras, por ejemplo, aquellos con lesión de la médula espinal (LME).
Sin embargo, todavía es necesario investigar las miBCI, con fines de rehabilitación,
para este tipo de pacientes que utilizan dispositivos de adquisición de señales EEG de
bajo costo, tales como Emotiv EPOC. En este trabajo, se describe en detalle y se
comparan diez arquitecturas miBCI basadas en información de covarianza de señales
EEG, adquiridas con Emotiv EPOC, para la decodificación de intención de mano
abierta y cerrada en tres sujetos control y dos pacientes con LME cervical. Cuatro de
estas diez miBCI usan información de covarianza para construir filtros espaciales y el
resto usa la información covarianza como una representación directa de las señales
EEG, permitiendo la manipulación directa mediante geometría de Riemann. Como
resultado, se encontró que, a pesar de que todas las arquitecturas miBCI tienen una
precisión general por encima del nivel de azar, las que utilizan la covarianza como
representación directa de las señales EEG junto con clasificadores lineales, superan
las miBCI que usan la covarianza para el filtrado espacial, tanto en sujetos de control
como en pacientes con LME. Estos resultados sugieren un alto potencial de las miBCI
basadas en la geometría de Riemann para la rehabilitación de pacientes con LME,
utilizando dispositivos de adquisición de EEG de bajo costo.
Palabras clave
Interfaces cerebro-computador, imaginación motora, geometría de la información,
filtrado espacial, lesión de médula espinal.
Abstract
Non-invasive EEG-based motor imagery brain–computer interfaces (miBCIs)
promise to effectively restore the motor control of motor-impaired patients with
conditions that include Spinal Cord Injury (SCI). Nonetheless, miBCIs should be
further researched for this type of patients using low-cost EEG acquisition devices,
such as the Emotiv EPOC, for home rehabilitation purposes. In this work, we describe
in detail and compare ten miBCI architectures based on covariance information from
EEG epochs. The latter were acquired with Emotiv EPOC from three control subjects
and two SCI patients in order to decode the close and open hand intentions. Four out
of the ten miBCIs use covariance information to create spatial filters; the rest employ
covariance as a direct representation of the EEG signals, thus allowing the direct
manipulation by Riemannian geometry. We found that, although all the interfaces
present an overall accuracy above chance level, the miBCIs that use covariance as a
direct representation of the EEG signals together with linear classifiers outperform
miBCIs that use covariance for spatial filtering, both in control subjects and SCI.
These results suggest the high potential of Riemannian geometry-based miBCIs for
the rehabilitation of SCI patients with low-cost EEG acquisition devices.
Keywords
Brain-computer interfaces, Motor imagery, Information geometry, Spatial filters,
Spinal cord injury.

[214]

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, sep-dic de 2019, pp. 213-231

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

1. INTRODUCCIÓN
Los pacientes con lesiones medulares
cervicales presentan grandes retos en la
recuperación de las funciones sensitivas y
motoras, a nivel de miembros superiores
durante la fase aguda y subaguda [1], lo
que
limita
considerablemente
su
independencia en la realización de tareas
diarias [2], [3]. Aun cuando las terapias
físicas y ocupacionales son claves en el
proceso de recuperación, el paciente, en la
mayoría de los casos, se encuentra en una
situación de alta dependencia, tanto de los
terapeutas como de sus familiares en la
ejecución de tareas de motricidad fina y
gruesa. Como consecuencia de esta
dependencia, los pacientes dejan de asistir
a los encuentros en las clínicas de
rehabilitación y, en casos extremos, llegan a
perder el interés por la realización de las
sesiones terapéuticas, incluso en la
comodidad de su hogar. Por esto, en los
últimos años, un tipo particular de
tecnologías de asistencia basadas en
señales del cerebro llamadas [4] interfaces
cerebro-computador, BCI, (por sus siglas en
inglés: Brain-Computer Interface) [5], [6],
permiten comandar dispositivos externos
como exomanos, computadores o sillas de
ruedas. Esto ha llamado la atención de
expertos en rehabilitación de pacientes con
limitaciones motrices, ya que su uso por
parte del paciente puede complementar las
sesiones terapéuticas e, incluso en algunos
casos, motivar la realización de las mismas
en los que han perdido el interés. Más aun,
recientemente, el uso de esta tecnología por
pacientes con paraplejia ha demostrado sus
beneficios
clínicos
en
procesos
de
rehabilitación [7], permitiendo pasar de
una lesión completa (pérdida total de las
funciones sensitivas y motoras por debajo
de la lesión) a incompleta (pérdida parcial
de las funciones sensitivas y motoras por
debajo de la lesión) [4]. Esto ha motivado la
investigación y desarrollo en este tipo de
tecnologías
para
rehabilitación
de

miembros superiores en pacientes con
lesiones cervicales.
En la actualidad, existen diversos tipos
de BCI, dependiendo de la técnica de
adquisición, del tipo modulación cerebral
particular que se utilice y del problema de
rehabilitación propio en cada paciente. En
particular, la interfaz cerebro-computador
no invasiva electroencefalográfica, EEG,
basada en imaginación motora, miBCI (del
inglés: motor imagery Brain-Computer
Interface), es considerada una de las más
apropiadas para rehabilitación motriz de
miembros superiores [8], no solo en
pacientes con lesiones medulares, sino
también en pacientes con déficit motores
debido a otras causas, por ejemplo, en
pacientes con accidente cerebro vascular
[9]. De acuerdo con [10], esto se debe a que
mediante la imaginación motora es posible,
no solo incrementar las capacidades de
agarre y la fortaleza muscular, sino
también disminuir el tiempo de realización
del movimiento, mejorar la variabilidad en
la ejecución de la trayectoria del mismo y
corregir anormalidades en los patrones de
actividad cerebral, incrementados en
algunos casos después de la LME [11].
Las miBCI generalmente constan de
dos fases [12]-[14]. Primero, una fase de
calibración o entrenamiento, en la que se
recogen segmentos (épocas) de las señales
EEG (preferiblemente a nivel superficial)
asociadas a dos o más intenciones motoras
imaginadas, las cuales permiten entrenar
un modelo de clasificación de señales EEG.
Después, una fase de retroalimentación, en
la que se utiliza el modelo entrenado para
clasificar intenciones motoras con base en
el protocolo de entrenamiento propuesto en
la fase de calibración (ver Fig. 1). Para la
construcción
de
estos
modelos
de
clasificación se hace uso principalmente de
técnicas de procesamiento digital de
señales [15] y de reconocimiento de
patrones [16], [17] que permiten el
tratamiento
adecuado
de
la
no
estacionariedad y la baja relación señal

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, Sep-dic de 2019, pp. 213-231

[215]

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

ruido de las señales EEG superficiales [18],
[19] y la efectiva discriminación de
diferentes
tareas
mentales,
respectivamente.
En los últimos años, dos técnicas que
explotan la información de covarianza de
las señales EEG han demostrado una
destacable capacidad discriminante en un
sinnúmero de retos internacionales sobre
bancos de datos disponibles por parte de la
comunidad científica para fines de
comparación [20]-[24]. Las primeras
utilizan la información de covarianza para
la construcción de filtros supervisados
espaciales, denominadas patrones comunes
espaciales [23], [25], junto con técnicas de
clasificación clásicas como el análisis
discriminante cuadrático/lineal [26] o
máquinas de vectores de soporte [17], [27].
En la otra técnica, la información de
covarianza es tratada como patrón
característico de la señal EEG y su
tratamiento se realiza en una variedad de
Riemann [14], [21], [28]-[31]. A pesar de los
resultados sobresalientes de estos dos tipos
de técnicas en los retos internacionales, en
su mayoría con sujetos de control sin
ningún de tipo de lesión medular o daño
cerebral, este tipo de técnicas ha sido poco

evaluado, utilizando dispositivos de bajo
costo para EEG superficial, como el Emotiv
EPOC [32] en pacientes con lesiones
medulares a nivel cervical. En [33] se ha
mostrado que el Emotiv EPOC es un
dispositivo habilitado para el desarrollo, no
solo de miBCI, sino también de BCI
relacionada a otro tipo de eventos como los
auditivos [34], con capacidades similares a
las de equipos costosos para la adquisición
de EEG superficial para investigación
avanzada. Por esto, la contribución de este
estudio está dirigido a determinar
arquitecturas más simples y robustas, que
puedan ser utilizadas en equipos de bajo
costo de adquisición de señales EEG como
el Emotiv EPOC, para masificar su uso en
aplicaciones de rehabilitación orientadas a
personas con limitaciones motrices. Por lo
tanto, se plantea como hipótesis que el
desempeño de las BCI que utilizan la
información de covarianza de las señales
EEG mejora más cuando dicha información
se utiliza para representar las señales
EEG junto con modelos lineales de
clasificación, que cuando se las utiliza con
modelos no lineales o para procesos de
filtrado.

Fig. 1. Visión general de un sistema miBCI utilizando técnicas de procesamiento de señales y reconocimiento
de patrones. Fuente: autores.

[216]

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, sep-dic de 2019, pp. 213-231

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

Para desarrollar la hipótesis, en este
trabajo se diseñaron diez arquitecturas de
BCI asociadas a dos estados mentales
(imaginación de apertura y cierre de
mano), cuatro de ellas utilizaron la
información de covarianza de las señales
EEG (basados en patrones comunes
espaciales) para procesos de filtrado y las
otras seis (tres con clasificador lineal y tres
con clasificador no lineal) utilizaron la
misma información como una nueva
representación de dichas señales (basados
en geometría de Riemann). Las señales
fueron adquiridas con ayuda del Emotiv
EPOC [32], [34] en tres sujetos de control y
dos pacientes con lesiones cervicales,
mediante un protocolo de imaginación
motora guiado por marcadores fijos en el
tiempo. El desempeño de cada arquitectura
se calculó como la precisión de clasificación
correcta en un esquema de validación
cruzada, teniendo en cuenta todas las
muestras, independiente del sujeto.
Adicionalmente se mostró el desempeño de
cada una de las arquitecturas mediante el
área bajo la curva ROC (AUC) por sujeto,
con el fin de encontrar variaciones de los
resultados con la condición de los sujetos
(sano o con LME).
Por lo tanto, en la sección 2 el
documento
describe
el
protocolo
experimental,
los
fundamentos
matemáticos de los patrones comunes
espaciales de la geometría de Riemann y
los clasificadores considerados en ambos
casos, finalizando con las arquitecturas
definitivas para las miBCI. Por último, en

la sección 3, se detallan las pruebas
llevadas a cabo y se comparan las
diferentes arquitecturas para cada sujeto
de experimentación.

2. MATERIALES Y MÉTODOS
En este estudio se adquirieron
segmentos (épocas) de señales EEG
asociadas a imaginación de mano cerrada e
imaginación de mano abierta de cinco
sujetos con edades entre 22 y 56 años, dos
de ellos con lesión cervical (S1 y S2) y tres
sin ningún tipo de lesión (S3, S4, y S5) (Ver
Tabla 1.). De acuerdo con los especialistas
médicos, ninguno de los sujetos de prueba
presentó limitaciones cognitivas ni daño
cerebral que impidiera la participación de
los sujetos de experimentación. Asimismo,
los
sujetos
dieron
consentimiento
informado respecto a las pruebas
realizadas y los datos adquiridos.
Cada sujeto se ubicó frente a una
pantalla de 55 pulgadas a 1.5 m de
distancia. En la pantalla se desplegaron en
forma aleatoria flechas orientadas hacia la
derecha (indicando imaginación de mano
cerrada) y hacia la izquierda (indicando
imaginación de mano abierta). En el caso
de los sujetos con lesiones cervicales, se
utilizó la silla de ruedas propia de cada
sujeto. Para la captura de las señales EEG
se usó el Emotiv EPOC el cual consta de 14
canales (AF3, F7, F3, FC5, T7, P7, O1, O2,
P8, T8, FC6, F4, F8, AF4) con frecuencia
de muestreo de 128 Hz.

Tabla 1. Descripción de sujetos de experimentación. DL: después de la lesión.
Fuente: autores.
Tipo
Sujeto
Nivel de la lesión
Edad
Con lesión
medular
Sin lesión
medular

S1

C5-C6-C7 (ASIA B)

S2

C3-C4 (ASIA B)

S3

N/A

33 (1 año DL)
56 (20
años DL)
32

S4

N/A

22

S5

N/A

29

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, Sep-dic de 2019, pp. 213-231

[217]

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

Por cada sujeto se realizaron 20
sesiones y durante cada sesión se
ejecutaron 10 ensayos. Cada ensayo tuvo
una duración de 8 segundos y solo se
desplegó una de las flechas a la vez. El
esquema de eventos durante cada ensayo
se puede observar en la Fig. 2. Las épocas
de las señales EEG para la imaginación de
mano cerrada o abierta se extrajeron desde
los 2 s hasta los 6 s. En cada sesión se
siguió un protocolo de asepsia que consistió
en limpiar el cuero cabelludo de los sujetos
de experimentación con agua destilada y se
aseguró que los canales del Emotiv EPOC
presentaran alta calidad de contacto con
ayuda del Software Emotiv Test Bench
v.15.0.3. Las épocas de las señales EEG
extraídas se procesaron mediante un filtro
Butterworth de 5º orden pasa banda con
frecuencias de corte de 8 – 30 Hz, con el fin
de filtrar de forma plana las componentes
sensomotoras asociadas a la imaginación
de mano cerrada y abierta [35]. Se
concibieron dos tipos de interfaces cerebro
computador
que
aprovecharon
la
información de covarianza entre los
canales de las épocas EEG. El primero de
ellos utilizó esta información para la
construcción de filtros espaciales óptimos
que mejoraron la relación señal ruido, y el
otro tipo de utilizó esta misma información
como una nueva representación de las
épocas de señales EEG, la cual pudo ser

manipulada
sobre
una
variedad
Riemanniana para la construcción de
filtros y clasificadores. La descripción
matemática
de
las
dos
técnicas
mencionadas anteriormente se lleva a cabo
en las subsecciones siguientes.
2.1

Patrones comunes espaciales para
miBCI

Anteriormente se mostró que las épocas
de las señales EEG fueron filtradas
temporalmente. Ahora, dada la naturaleza
espacial de esta señal, se pueden concebir
filtros espaciales para poder realzar
características que permitan discriminar
entre los dos tipos de imaginación motora
en este tipo de señales. De hecho, los filtros
espaciales han sido ampliamente utilizados
en investigaciones en neurociencia y
neuroingeniería en todo el mundo [36]. Se
utilizan principalmente para aumentar la
relación señal ruido de la señal EEG [37].
El filtrado Laplaciano, el filtrado
basado en análisis de componentes
principales
(PCA)
o
análisis
de
componentes independientes (ICA) son
algunos filtros espaciales comúnmente
utilizados. La característica principal de
este tipo de filtros es que son no
supervisados, es decir, que no tienen en
cuenta la categorización (imaginación
derecha o izquierda) de la señal EEG.

Fig. 2. Esquema de tiempo para imaginación motora. El segmento en azul corresponde al periodo de tiempo
en el que se extrae una época de señal EEG asociado con el tipo de movimiento que debe realizarse con base en la
dirección de las flechas. Fuente: autores.

[218]

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, sep-dic de 2019, pp. 213-231

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

Por el contrario, existe un tipo especial
de filtros denominados patrones comunes
espaciales (CSP) [23], los cuales se
construyen de forma supervisada, esto es,
teniendo en cuenta la clase a la que
pertenece cada segmento de señal EEG.
Para la obtención de este filtro se parte del
problema de maximización del cociente
Rayleigh [38] asociado a las matrices
covarianza de los segmentos de señal
relacionados
con
las
imaginaciones
motoras. Sea E1 y E2 segmentos de señal
EEG de N canales y h muestras para
imaginación de movimiento de mano
cerrada (clase 1) y mano abierta (clase 2).
Las matrices de covarianza C1 y C2
asociadas a E1 y E2 respectivamente se
obtienen
mediante
la
siguiente
expresión (1):
Ci =

Ei EiT
tr(Ei EiT )

, i = 1, 2

(1)

En (1) tr(.) es el operador traza, esto es,
la suma de los elementos de la diagonal
principal de una matriz. Si Ci se calcula
con h > N (para este caso N = 14 y h = 512),
entonces la probabilidad de que Ci sea
invertible aumenta, garantizándose así que
la matriz no solo sea simétrica sino
también definida positiva. Ahora bien, si ̅̅̅
C1
y ̅̅̅
C2 son matrices promedios de covarianza
para la clase 1 y 2 respectivamente, en la
teoría de filtros espaciales es posible
construir de forma supervisada un filtro
espacial W con ayuda del cociente de
Rayleigh (2):
J(w) =

w T ̅̅̅
C1 w
,
w T ̅̅̅
C2 w

w ∈ ℝN

(2)

Los w* que maximizan este cociente se
obtienen resolviendo el siguiente problema
de optimización sin restricción (3):
w ∗ = arg max J(w)
w

de

(3)

Nótese que si w* maximiza el Cociente
Rayleigh entonces cw* también

maximiza este cociente dando el mismo
valor. Luego entonces el problema de
optimización en (3) puede ser planteado
como un problema con restricción (4):
w ∗ = arg max w T ̅̅̅
C1 w
w
T
̅̅̅
s. t. w C2 w = c

(4)

Básicamente (4) es un problema de
programación cuadrática con restricción
cuadrática, el cual puede ser resuelto de
forma iterativa, utilizando programación
secuencial cuadrática (SQP) [39] o de
forma analítica, utilizando la teoría del
multiplicador de Lagrange. Sin embargo, al
aplicar SQP de forma directa permite
encontrar un solo punto crítico, dando a lo
sumo un solo filtro espacial, es decir que la
señal se reducirá a un solo canal después
de filtrar. Por esta razón, se utiliza la
teoría del multiplicador de Lagrange para
encontrar N puntos críticos. Para esto, el
problema de maximización (4) se puede
formular
como
un
problema
de
minimización con restricción mediante (5).
w ∗ = arg min −w T ̅̅̅
C1 w
w
T
̅̅̅
s. t. w C2 w = c

(5)

La función de Lagrange asociada al
anterior problema es (6):
L(w, λ) = −w T ̅̅̅
C1 w + λ(w T ̅̅̅
C2 w − c)

(6)

Aplicando condiciones de primer orden,
se deriva (6) respecto a w y se iguala a
cero. Ver (7):
∇w L(w ∗ , λ∗ ) = 0

(7)

Dado que C1 y C2 son simétricas,
sustituyendo (6) en (7), se obtiene (8):
−2w ∗ T ̅̅̅
C1 + λ∗ (2w ∗ T ̅̅̅
C2 ) = 0

(8)

Despejando uno de los sumandos de (8)
se obtiene (9).
̅̅̅
C1 w ∗ = λ∗ ̅̅̅
C2 w ∗

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, Sep-dic de 2019, pp. 213-231

(9)
[219]

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

(9) es evidentemente un problema de
autovalores
generalizado
[40].
Los
∗
multiplicadores de Lagrange, 𝜆 , que
satisfacen (9) son en consecuencia los
autovalores generalizados. Si ̅̅̅
𝐶2 es
invertible el problema de autovalores
generalizados puede ser planteado como un
problema normal de autovalores (10):
(10)

̅̅̅2 )−1 ̅̅̅
((C
C1 )w ∗ = λ∗ w ∗

̅̅̅2 es invertible los filtros
Cuando 𝐶
espaciales pueden ser obtenidos mediante
(10). Sin embargo, si ̅̅̅
𝐶2 no es invertible es
posible que el costo máximo obtenido de (2)
sea ilimitado, por lo anterior, se impone
otra restricción sobre la norma de w al
problema de optimización inicial, ver (11):
(11)

Para este caso la Lagrangiana viene
dado por (12):
L(w, λ1 , λ2 ) = −w T ̅̅̅
C1 w + λ1 (w T ̅̅̅
C2 w − c)
+ λ2 (w T w − d)

(12)

satisfacer

−w ∗ T ̅̅̅
C1 + 2λ1∗ (w ∗ T ̅̅̅
C2 ) + λ∗2 (w ∗ T I) = 0

Tal que: γ =

λ∗2

(13)

(14)

λ∗1

Nótese que (14) parece el problema de
optimización inicial (5) pero ahora ̅̅̅
𝐶2 está
acompañado
de
un
término
de
regularización que permite que sea
invertible. Esto permite introducir el
problema de optimización de patrones
Comunes
Espaciales
Regularizados
(RCSP), el cual en forma general se
plantea de la siguiente forma (15):

[220]

En síntesis, la obtención de un filtro
𝑊 ∈ ℝ𝑁×𝑁 tipo CSP junto con sus versiones
regularizadas y no regularizadas se
compilan en Tabla 2.
El efecto final del filtro W ∈ ℝN×N
aplicado a la señal Ei es la de aumentar la
varianza para la mitad de los canales de
Ei, mientras que disminuye la misma para
el resto de canales para una clase en
particular, y viceversa en el caso de otra
clase. Por esto suele utilizarse como patrón
característico, asociado a Ei (después de
ser filtrado), la varianza logarítmica,
obtenida mediante la función <ln (◦)> (16).
(16)

Nótese que dado que WEi ∈ ℝN×h , cada
componente de ei se obtiene aplicando el
logaritmo natural a la varianza de cada
canal de WEi, lo que hace que finalmente
ei ∈ ℝN . El Algoritmo 1 (ver Tabla 3.)
describe el procedimiento para la obtención
de un vector de varianza logarítmica para
una señal EEG, Ex, filtrada espacialmente.
2.2

Reorganizando (13) se obtiene (14):
̅̅̅2 + γI) = 0;
w ∗ T ̅̅̅
C1 + 2λ1∗ w ∗ (C

(15)

ei =< ln(WEi ) >

w ∗ = arg min −w T ̅̅̅
C1 w
w
T
̅̅̅
s. t. w C2 w = c
wT w = d

Las
soluciones
deben
∇w L(w ∗ , λ1∗ , λ∗2 ) = 0, esto es (13):

w ∗ = arg min −w T ̅̅̅
C1 w
w
T (C
s. t. w ̅̅̅2 )w + γP(w) = c;
P(w) = w T Iw

Geometría de Riemann para miBCI

Las matrices de covarianza simétricas y
definidas positivas, Ci, pueden ser
utilizadas como representación de las
señales EEG, Ei. Este tipo de matrices
simétricas y definidas positivas pertenecen
a una forma particular de variedad
matemática conocida como variedad de
Riemann, C(N). En esta variedad
matemática, la distancia Riemanniana de
dos matrices, C1 y C2, viene dada por (17):

N

1⁄
2

δR (C1 , C2 ) = ‖Log(C1−1 C2 )‖F = [∑ log 2 βn ]
n=1

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, sep-dic de 2019, pp. 213-231

(17)

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal
Tabla 2. Programas no lineales para CSP regularizados y no regularizados. Fuente: autores
CSP: patrones espaciales
RCSP: patrones espaciales
comunes no regularizados
comunes regularizados
𝑇
arg min −𝑤 𝐶1 𝑤
arg min −𝑤 𝑇 𝐶1 𝑤
Programa
𝑤

Soluciones
del
programa:
filtro
W formado a
partir de:

𝑤

𝑠. 𝑡. 𝑤 𝑇 𝐶2 𝑤 = 𝑐

𝑠. 𝑡. 𝑤 𝑇 𝐶2 𝑤 + 𝛾𝑃(𝑤) = 𝑐

Con 𝑐 ∈ ℝ
N/2 autovectores asociados a los
autovalores más grandes y N/2
autovectores asociados los
autovalores más pequeños de la
matriz M = 𝐶2−1 𝐶1 .

Con 𝑐 ∈ ℝ, γ>0
N/2 autovectores asociados a los
autovalores más grandes de:
𝑀1 = (𝐶2 + 𝛾𝐼)−1 𝐶1 .
Y N/2 autovectores asociados a los
autovalores más grandes de:
𝑀2 = (𝐶1 + 𝛾𝐼)−1 𝐶2 .

Tabla 3. Descripción de algoritmo para obtención de vectores de varianza logarítmica.
Fuente: autores.
Algoritmo 1: Obtención de vectores de varianza logarítmica por época de señal EEG
filtrada espacialmente
Entrada: - Un conjunto n1 señales EEG, Ei,
para la clase 1, q1.
-Un conjunto n2 señales EEG, Ei,
para la clase 2, q2.
-Valor de regularización, γ.
-Opción Regularizado o No
regularizado.
-Señal Ex para obtener vector de
varianza logarítmica.
Salida:

- Vector varianza logarítmica: ex.

1: Obtener ̅̅̅
C1 para cada Ei asociado a q1 mediante (1).
2: Obtener ̅̅̅
C2 para cada Ei asociado a q2 mediante (1).
3: Construir matriz W con γ. Tabla 1.
4: ex = <ln(𝑊𝐸𝑥 )>. (16).
5: retornar ex

Donde 𝛽𝑛 son los autovalores de 𝐶1−1 𝐶2.
Log(C = 𝐶1−1 𝐶2 ) es el logaritmo de una
matriz, el cual se calcula, con ayuda de la
descomposición en valores singulares de C
mediante el siguiente producto de
matrices: U(diag[ln(β1), … , ln(βn)])U 𝑇 ,
donde U es la matriz de autovectores de C.
‖∙‖F es la norma de frobenious de una
matriz, la cual se obtiene como la raíz
cuadrada de la traza del producto entre la
matriz y su transpuesta.
Para utilizar esta distancia en un
problema de clasificación de señales Ei, se
obtienen matrices promedio, una para la

clase 1, ̿̿̿
C1 , y otra para la clase 2, ̿̿̿
C2 . La
discriminación de una matriz C se hace por
menor distancia a las matrices promedio
anteriores. Para encontrar estas matrices
promedio, no es posible utilizar la fórmula
de media de aritmética de matrices
convencional, utilizada en la sección
anterior, ya que las matrices de covarianza
no residen en el espacio euclídeo sino en
una variedad Riemanniana. En este
espacio la matriz promedio asociado a M1,
matrices de covarianza para la clase 1 y
M2 matrices de covarianza para la clase 2,
se obtiene resolviendo los siguientes

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, Sep-dic de 2019, pp. 213-231

[221]

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

problemas
de
respectivamente (18) y (19):

optimización

(21). Igualmente, estas operaciones se
ilustran en la Fig. 3.

M1

̿̿̿
C1 = arg min ∑ δR (C, Ci1 )
C∈C(n)

(18)

(20)

Ci = C1⁄2 Exp(C −1⁄2 Si C−1⁄2 )C 1⁄2

(21)

i=1
M2

̿̿̿
C2 = arg min ∑ δR (C, Ci2 )
C∈C(n)

Si = C 1⁄2 Log(C −1⁄2 Ci C−1⁄2 )C 1⁄2

(19)

i=1

No hay una forma explícita para
resolver el problema anterior, pero existen
formas
iterativas
para
estimarlo,
utilizando el concepto de espacio tangente.
Con ayuda del logaritmo Riemanniano
entre dos matrices, LogR (C, Ci), se
proyecta el conjunto de datos completo, Ci
(i=1…M), matrices de covarianza, en el
espacio tangente de C. En este espacio, por
cierto, de propiedades euclidianas, el
promedio puede obtenerse mediante media
aritmética. Finalmente, se reproyecta este
promedio obtenido al espacio SPD
mediante la exponencial Riemanniana
entre dos matrices, ExpR (C, Ci). Después
de algunas iteraciones, se obtiene la media
geométrica de las matrices SPD. Las
iteraciones se detienen cuando se ha
realizado un número determinado de
iteraciones o cuando la distancia de
Frobenius de la proyección tangente
promedio se hace estacionaria. Ver
Algoritmo 2 (ver Tabla 4.)
Las expresiones matemáticas para el
logaritmo y exponencial Riemanniano para
proyección y reproyección tangente,
respectivamente, se muestran en (20) y

Para la construcción de filtros y de
clasificadores en el espacio tangente, la
matrices de covarianza proyectadas, las
cuales son simétricas, Si,j = Sj,i, pueden
vectorizarse utilizando únicamente su
parte triangular superior (22), como en
[14].
La √2 se multiplica a todos los
elementos que están por fuera de la
diagonal principal de S para que ‖S‖F =
‖vect (S)‖2. La desvectorización de vect (S)
se realiza de forma contraria. Nótese
además 𝑣𝑒𝑐𝑡 (𝑆) que tiene N(N+1)/2
elementos. Esta forma de vectorización
permite la construcción de técnicas de
filtrado geodésico (GF) como el propuesto
en [29] y descrito en el Algoritmo 3 (ver
Tabla 5.). La idea básica de este algoritmo
es utilizar el análisis discriminante lineal
de fisher para la construcción de un filtro a
partir de los K vectores de fisher de las
proyecciones de las matrices de covarianza
en el espacio tangente de la media
riemanniana de un conjunto de M matrices
de covarianza. Para el caso de señales
EEG, este filtro debe obtenerse a partir de
todas las épocas tanto de imaginación
izquierda como derecha.

S(1,1)

𝑣𝑒𝑐𝑡 (S) =

[222]

√2S(1,2)
⋮
√2S(1,N)
S(2,2)
√2S(2,3)
⋮
√2S(2,N)
⋮
[ S(N,N) ]

(22)

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, sep-dic de 2019, pp. 213-231

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal
Tabla 4. Descripción de algoritmo para obtención de matriz
promedio Riemanniana. Fuente: autores.
Algoritmo 2: Promedio de matrices de covarianza
Entrada: - Un conjunto de M matrices de covarianza, Ci ∈ C(N).
Valor de tolerancia, θ.
Valor máximo de iteraciones, maxIter.
Salida:

- Matriz promedio estimada 𝐶̿ .
1
1: Inicializar C̿(0) = ∑M
i=1 Ci
M

2: Calcular S =

1
M

̿ (0)
∑M
i=1 Log R (C , Ci )

3: k = 0
4: mientras k < maxIter y θ > ‖S‖𝐹
1
̿ (k) , Ci )
5:
S = ∑M
i=1 Log R (C
M

6:
7:
8: fin
9: C̿ = C̿(k)

C̿(k+1) = ExpR (C̿ (k) , S)
k = k + 1.

10: retornar C̿

Tabla 5. Descripción de algoritmo para filtrado geodésico. Fuente: autores.
Algoritmo 3: Filtrado Geodésico (GF)
Entrada: M matrices de covarianza,
Ci ∈ C(N).
- Matriz Cx ∈ C(N) para filtrar.
- Número K de filtros fisher a utilizar.
Salida: Matriz filtrada geodésicamente
̃x .
C
1: C̅ = Algoritmo 2(Ci ∈ C(N)).
2: repetir i=1 hasta M
3: Si = Log R (C̅, Ci ).
Proyección espacio tangente.
4: S̃i = concatenar[vect(Si )].
Vectorización mediante (22).
5: fin
6: ̃
W = LDA(S̃i ).
Obtención de los vectores fisher.
N

̃R = [W
̃1 , W
̃2 , … , W
̃K ] ∈ ℝ 2 (N+1)×K.
7: W
Selección de K vectores.
8: Sx = Log R (C̅, Cx )
̃R (W
̃R T W
̃R )
9: S̃x = W

−1

̃R T vect(Sx ).
W

Filtrado.
̃x = ExpR (C̅, unvect(S̃x ))
10: C
̃x
11: retornar C

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, Sep-dic de 2019, pp. 213-231

[223]

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

Fig. 3. Espacio tangente de una matriz de covarianza C, la cual pertenece a la variedad Riemanniana
C(N). Si es la proyección de Ci en el espacio tangente de C. Fuente: autores.

2.3

Clasificadores

Los vectores de varianza logarítmica de
la sección 2.1 y las vectorizaciones de las
proyecciones en el espacio tangente de un
punto sobre la variedad de Riemann de la
sección 2.2 se asocian a cada una de las
señales EEG con su respectiva clase. Para
estos patrones es posible desarrollar
técnicas de clasificación basadas en
análisis discriminante cuadrático (QDA) o
lineal (LDA) [26]. Primero, asumiendo que
estos patrones poseen una distribución
normal, que las probabilidades a priori de
ambas clases son iguales y además que la
media y covarianza para la clase 1 y 2
(𝜇1 , ∑1 )
viene
dado
por
y
(𝜇2 , ∑2 ) respectivamente,
entonces
mediante (23) es posible discriminar de
forma cuadrática (QDA) la pertenencia de
un patrón ex a una de las clases.
Finalmente, si se asume ∑1 = ∑2 = ∑
entonces la discriminación se puede
obtener de forma lineal (LDA) mediante
(24). Ambas expresiones (23) y (24)
permiten clasificar a ex perteneciente a la

|∑2 |
1
1
y(ex ) = ln (
) − [{(ex −
|∑1 |
2
2

[224]

clase 1 si y ≥ 0 y a la clase en 2 en caso
contrario.
1
y(ex ) = (μ1 − μ2 )T ∑−1 [ex − (μ1 + μ2 )]
2

(24)

Las máquinas de vectores de soporte
son otra opción robusta para clasificar ex
mediante (25). Ns es el número de vectores
de soporte obtenidos después de optimizar
el
problema
dual asociado
a la
maximización del margen de separación
entre las clases, αi son los multiplicadores
de Lagrange no nulos obtenidos de este
mismo problema, di son las etiquetas (+1
para la clase 1 y -1 para la clase 2) de los
vectores de soporte y 𝑒𝑥𝑖 son los vectores de
soporte los cuales son un subconjunto de
los datos de entrenamiento [27]. En este
caso y ≥ +1 clasifica para la clase 1 e y ≤ -1
clasifica para la clase 2.

μ2 )T ∑−1
2 (ex − μ2 )} −

Ns

y(ex ) = ∑ αi di k(𝐞𝐱 , exi )

(25)

i=1

{(ex − μ1 )T ∑1−1 (ex − μ1 )}]

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, sep-dic de 2019, pp. 213-231

(23)

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

Por otra parte, si se conserva la
representación de las señales EEG en sus
matrices de covarianza, con ayuda de (17),
(18) y (19) se puede implementar un
clasificador riemanniano denominado de
mínima distancia a la media (MDM) el cual
se expresa en (26). En este caso no se
utiliza ex sino Cx asociado a Ex:
q = arg min {δR (C̿i , Cx )}
i∈{1,2}

(26)

2.4 Arquitecturas miBCI basadas en CSP
y geometría de Riemann
Con
ayuda
de
las
funciones
discriminantes descritas en la sección 2.3 y
las técnicas desarrolladas en las secciones
2.1 y 2.2 es posible concebir diez
arquitecturas de interfaces cerebrocomputador: cuatro basadas en CSP
(Fig. 4) y seis basadas en geometría de
Riemann (Fig. 5).
Para
la
determinación
de
los
parámetros involucrados en los diferentes
algoritmos se tomaron valores de
referencia encontrados en otros estudios.
El parámetro de regularización del
Algoritmo 1 (ver Tabla 3) γ se fijó igual
0.0001 (con base en [24]) para garantizar la
invertibilidad
de
las
matrices
de
covarianza en la obtención de los filtros
espaciales. El valor de tolerancia θ para el

Algoritmo 2 (ver Tabla 4) se fijó en 0.001
y el número máximo de iteraciones en 200,
tomando como referencia [29], [31]. En el
filtrado geodésico, Algoritmo 3 (ver Tabla
5), el número K de vectores de filtros
Fisher se fijó en N-1 siguiendo la
sugerencia del trabajo reportado en [28].
Finalmente, con base en [27], las máquinas
de vectores de soporte fueron entrenadas
con un parámetro de regularización igual
100 para penalizar fuertemente los errores
de clasificación; y para el caso de la función
gaussiana en la máquina de soporte de
base radial (Rbf) se tomó una desviación
estándar igual nc-1, donde nc es el número
de características de los patrones de
entrenamiento.
Aun cuando en las miBCI basadas en
geometría de Riemann, Fig. 5, pudo
considerarse también las técnicas de
clasificación
mediante
los
métodos
discriminantes planteados en [23] y [24],
en este estudio solo se consideró la MDM y
las máquinas de vectores de soporte de
kernel lineal y gaussiano (Rbf). En trabajos
futuros se considerará estos y otro tipo de
clasificadores, incluyendo la optimización
de hiperparámetros para la obtención de
los mejores valores de regularización que
maximicen
el
desempeño
de
las
arquitecturas propuestas.

Fig. 4. Cuatro arquitecturas de BCI basadas en CSP: CSP+LDA (1-2-3-4), CSP+QDA (1-2-3-5),
CSP+SVM Lineal (1-2-3-6) y CSP+SVM Rbf (1-2-3-7). Fuente: autores.

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, Sep-dic de 2019, pp. 213-231

[225]

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

Fig. 5. Seis arquitecturas de miBCI basadas en Geometría de Riemann: RM+MDM (1-2-5), +GF+MDM
(1-2-3-5), RM+TS+SVM Lineal (1-2-4-6), RM+TS+SVM Rbf (1-2-4-7), RM+GF+TS+SVM
Lineal (1-2-3-4-6), RM+GF+TS+SVM Rbf (1-2-3-4-7). Fuentes: autores.

Es importante mencionar que las
arquitecturas miBCI basadas en geometría
de Riemann, que hacen uso específico del
filtrado geodésico y el clasificador MDM,
solo requieren el cómputo iterativo durante
el entrenamiento. Durante la ejecución en
línea este cómputo no se requiere. En el
caso del filtrado geodésico para el cómputo
en línea, solo es suficiente con conservar la
matriz promedio C̅
y el filtro WR los
cuales se obtienen en las líneas 1 y 7 del
Algoritmo
3
(ver
Tabla
5),
respectivamente.
En
el
caso
del
clasificador MDM, solo habría que
almacenar las matrices de covarianza
promedio para las clases 1 y 2 obtenidas
con ayuda del Algoritmo 2 (ver Tabla 4).

3. PRUEBAS Y RESULTADOS
Para evaluar las miBCI basadas en
CSP y las basadas en geometría de
Riemann descritas en la sección 2, se
validó que los promedios de precisión
(clasificación correcta) general (incluyendo
todos los sujetos) estuvieran por encima del
nivel de azar. Estos promedios de precisión
fueron obtenidos en un esquema de
[226]

validación cruzada estratificada con 10
divisiones [41]. Después, con el fin de
comparar el desempeño individual de cada
una de las arquitecturas para cada uno de
los sujetos, se evaluó el área bajo la curva
ROC. El banco de datos constó de 200
épocas de EEG de las cuales 100
estuvieron asociadas a imaginación de
mano cerrada (flecha derecha) y las otras
100 a mano abierta (flecha izquierda), lo
que significa que para los 5 sujetos el total
de ensayos fue de 1000.
Las precisiones de las diferentes
arquitecturas sobre todos los ensayos se
promediaron a lo largo de las diferentes
divisiones del dataset (10 divisiones). Para
probar
si
este
desempeño
estuvo
significativamente
por
encima
del
desempeño de un clasificador que asociara
cualquier clase a las épocas [42], se estimó
el nivel de azar (chance-level, en inglés)
como el intervalo de confianza del 0.95 de
la inversa de la distribución binomial, en
función
del
número
de
muestras
disponibles (1000) y la probabilidad de las
clases (0.5), lo que llevó a un valor de 0.53.
En la Fig. 6 se observa que todos estos
valores están por encima del nivel de azar
estimado para este caso. Nótese que la
arquitectura RM+TS+SVM lineal presenta

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, sep-dic de 2019, pp. 213-231

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

la mejor precisión promedio entre todas las
arquitecturas. Para determinar cuál o
cuáles fueron las mejores miBCI por
sujeto, se comparó el desempeño de cada
una de estas utilizando el área bajo la
curva ROC, AUC [43]. En la Tabla 6 se
muestran estos valores obtenidos. Estos
mismos datos son graficados en la Fig. 7
para propósitos de comparación visual.
En primer lugar, se observa que
independiente del sujeto, los resultados de
las miBCI basadas en geometría de
Riemann presentaron en promedio un 31 %
de desempeño mayor que las basadas en
CSP. Sobresalen por su desempeño las
siguientes
miBCI:
RM+GF+MDM,
RM+TS+SVM
lineal
y
la
RM+GF+TS+SVM lineal. La superioridad
en desempeño de las arquitecturas basadas

en Riemann respecto a las basadas en CSP
se debe a: i) la estimación de las matrices
de covarianza promedio por clase en el caso
de CSP no es óptima [44], desde el punto
de vista topológico en el espacio de
matrices positivas definidas; ii) la
obtención de los autovalores y autovectores
no tiene en cuenta la dispersión entre
clases; iii) la extracción de características
mediante el operador de varianza
logarítmica se calcula mediante una
aproximación de la distancia de Riemann
entre matrices de covarianza [44]. Nótese
además que las únicas arquitecturas
basadas en geometría de Riemann que
presentan desempeños inferiores, incluso
por debajo que las basadas en CSP, son las
que utilizan SVM de kernel gaussiano
como clasificador.

Fig. 6. Precisión general de las arquitecturas miBCI sobre todas las épocas de los sujetos.
Fuente: autores.

Fig. 7. AUC para cada miBCI. Fuente: autores.

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, Sep-dic de 2019, pp. 213-231

[227]

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal
Tabla 6. Valores de AUC para cada una de las diez miBCI por sujeto. Fuente: autores.
miBCI
S1
S2
S3
S4
S5
CSP+LDA

0.60

0.60

0.83

0.83

0.66

CSP+QDA

0.66

0.66

0.90

0.90

0.82

CSP+SVM Lineal

0.62

0.60

0.82

0.82

0.64

CSP+SVM Rbf
RM+MDM

0.66
0.58

0.66
0.58

0.83
0.68

0.82
0.68

0.78
0.63

RM+GF+MDM

0.78

0.78

0.97

0.98

0.89

RM+TS+SVM
Lineal
RM+TS+SVM Rbf

0.79

0.77

0.96

0.97

0.86

0.62

0.56

0.87

0.88

0.73

RM+GF+TS+SVM
Lineal
RM+GF+TS+SVM Rbf

0.79

0.8

0.98

0.95

0.91

0.41

0.44

0.61

0.53

0.50

Y, en segundo lugar, se observa que
mientras las miBCI en los sujetos con
lesiones cervicales (S1 y S2) presentan un
desempeño regular, en los sujetos de
control se logran miBCI con desempeños
buenos
(S5:
0.91
–
miBCI:
RM+GF+TS+SVM Linear) y muy buenos
(S3, S4: 0.98 - miBCI: RM+GF+TS+SVM
Linear,
RM+GF+MDM).
El
bajo
desempeño de las arquitecturas propuesta
con respecto a los sujetos de control puede
deberse a la reorganización de la actividad
cortical sensomotora [45] que tiene lugar
en los pacientes que han sufrido lesiones
en el sistema nervioso central como es el
caso de los pacientes con lesiones
cervicales, lo que indicaría que es necesario
una reubicación de los electrodos sobre el
cuero cabelludo de los sujetos con lesiones
medulares para obtener bioseñales más
discriminantes.
Es posible que una
sintonización de los hiperparámetros (los
cuales se dejaron fijo para este estudio)
mejore el desempeño particular las miBCI
de Riemann que utilizan SVM de kernel
gaussiano.

4. CONCLUSIONES
Se diseñaron e implementaron diez
arquitecturas
miBCI
asociadas
a

[228]

imaginación de mano cerrada y abierta en
tres sujetos de control y dos sujetos con
lesiones medulares cervicales. Se analizó el
aporte
de
la
covarianza
en
la
representación y discriminación de las
señales EEG. Todas las miBCI tuvieron
porcentajes de precisión por encima del
nivel de azar.
Se encontró que, para ambos tipos de
sujetos, las miBCI basadas en geometría
de Riemann con clasificadores lineales
mostraron mayor precisión que las miBCI
basadas en CSP (tanto lineal como no
lineal). Sin embargo, presentan mejor
desempeño en los sujetos de control que en
los sujetos con lesiones medulares.
Lo anterior sugiere que el desempeño
de las miBCI que utilizan la información
de covarianza de las señales EEG
adquiridas con el Emotiv EPOC mejora
cuando dicha información se utiliza para
representar las señales EEG junto con
modelos lineales de clasificación, que
cuando se las utiliza con modelos no
lineales o cuando la información de
covarianza es utilizada en procesos de
filtrado espacial de señales.
Los resultados obtenidos permiten
entrever la posibilidad de desarrollar
miBCI con equipos de bajo costo y
algoritmos simples y robustos, utilizando
la información de covarianza y los

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, sep-dic de 2019, pp. 213-231

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal

elementos de la geometría de Riemann en
clasificadores lineales.
Se espera, a futuro, que la sintonización
de
los
híper-parámetros
de
las
arquitecturas propuestas en los sujetos con
lesiones medulares mejore el desempeño de
las miBCI basadas en geometría de
Riemann. También debe evaluarse la
capacidad de generalización de estas
miBCI con un número de épocas menores y
en aplicaciones reales de generación de
comandos a exomanos reales o virtuales,
como apoyo a procesos de rehabilitación de
miembros superiores en pacientes con
LME.

[4]

[5]

[6]

5. AGRADECIMIENTOS
[7]

A Colciencias y a la Facultad de
Ingeniería de la Universidad del Valle, en
el marco de la convocatoria 727 del 2015,
por el apoyo económico y administrativo.

6. CONFLICTO DE INTERÉS
Declaramos no tener ningún tipo de
conflicto de intereses, ninguna relación
personal, política, interés financiero ni
académico que pueda influir en nuestro
juicio.

[8]

[9]

7. REFERENCIAS
[1]

[2]

[3]

A. S. Burns et al., “Type and Timing of
Rehabilitation
Following
Acute
and
Subacute Spinal Cord Injury: A Systematic
Review,” Glob. Spine J., vol. 7, no. 3_suppl,
p. 175S–194S, Sep. 2017.
https://doi.org/10.1177/2192568217703084
J. van Tuijl, Y. Janssen-Potten, and H.
Seelen, “Evaluation of upper extremity motor
function tests in tetraplegics,” Spinal Cord,
vol. 40, no. 2, pp. 51–64, Feb. 2002.
https://doi.org/10.1038/sj.sc.3101261
Paralyzed Veterans of America Consortium
for Spinal Cord Medicine, “Preservation of
upper limb function following spinal cord

[10]

[11]

injury: a clinical practice guideline for
health-care professionals.,” J. Spinal Cord
Med., vol. 28, no. 5, pp. 434–470, Sep. 2005.
https://doi.org/10.1080/10790268.2005.11753
844
R. Rupp, S. C. Kleih, R. Leeb, J. del R.
Millan, A. Kübler, and G. R. Müller-Putz,
“Brain–Computer Interfaces and Assistive
Technology,” in Brain-Computer-Interfaces in
their ethical, social and cultural contexts,
vol. 12, Dordrecht: Springer Netherlands,
2014, pp. 7–38.
https://doi.org/10.1007/978-94-017-8996-7_2
G. Dornhege, J. del R. Millán, T.
Hinterberger, D. J. McFarland, and K.-R.
Müller, Toward Brain-Computer Interfacing,
Cambridge: MIT Press, 2007.
J. J. Shih, D. J. Krusienski, and J. R.
Wolpaw, “Brain-Computer Interfaces in
Medicine,” Mayo Clin. Proc., vol. 87, no. 3,
pp. 268–279, Mar. 2012.
https://doi.org/10.1016/j.mayocp.2011.12.008
C. D. Ferrin Bolaños and H. Loaiza Correa,
“Interfaz cerebro-computador multimodal
para procesos de neurorrehabilitación de
miembros superiores en pacientes con
lesiones de médula espinal: una revisión,”
Rev. Ing. Biomédica, vol. 12, no. 24, pp. 35–
46, Dec. 2018.
https://doi.org/10.24050/19099762.n24.2018.1
222
L. M. Alonso-Valerdi, R. A. Salido-Ruiz, and
R. A. Ramirez-Mendoza, “Motor imagery
based
brain–computer
interfaces:
An
emerging technology to rehabilitate motor
deficits,” Neuropsychologia, vol. 79 part B.,
pp. 354–363, Dec. 2015.
https://doi.org/10.1016/j.neuropsychologia.20
15.09.012
P. H. Peckham et al., “Efficacy of an
implanted neuroprosthesis for restoring
hand grasp in tetraplegia: A multicenter
study,” Arch. Phys. Med. Rehabil., vol. 82,
no. 10, pp. 1380–1388, Oct. 2001.
https://doi.org/10.1053/apmr.2001.25910
S. Mateo, F. Di Rienzo, V. Bergeron, A.
Guillot, C. Collet, and G. Rode, “Motor
imagery reinforces brain compensation of
reach-to-grasp movement after cervical
spinal cord injury,” Front. Behav. Neurosci.,
vol. 9, pp. 1–12, Sep. 2015.
https://doi.org/10.3389/fnbeh.2015.00234
M. Grangeon, P. Revol, A. Guillot, G. Rode,
and C. Collet, “Could motor imagery be
effective in upper limb rehabilitation of
individuals with spinal cord injury? A case
study,” Spinal Cord, vol. 50, no. 10, pp. 766–
771, Oct. 2012.
https://doi.org/10.1038/sc.2012.41

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, Sep-dic de 2019, pp. 213-231

[229]

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal
[12]

[13]

[14]

[15]

[16]
[17]
[18]

[19]

[20]

[21]

[22]

[230]

C. Vidaurre, C. Klauer, T. Schauer, A.
Ramos-Murguialday, and K.-R. Müller,
“EEG-based BCI for the linear control of an
upper-limb neuroprosthesis,” Med. Eng.
Phys., vol. 38, no. 11, pp. 1195–1204,
Nov. 2016.
https://doi.org/10.1016/j.medengphy.2016.06.
010
J. Castillo, “Interfaz Cerebro-Computador
Adaptativa Basada en Agentes Software
para la Discriminación de Cuatro Tareas
Mentales”, Tesis Doctoral, Facultad de
Ingeniería, Universidad del Valle, Cali, 2015.
[En línea] Disponible en:
http://hdl.handle.net/10893/10290
A. Barachant, S. Bonnet, M. Congedo, and C.
Jutten, “Classification of covariance matrices
using a Riemannian-based kernel for BCI
applications,” Neurocomputing, vol. 112,
pp. 172–178, Jul. 2013.
https://doi.org/10.1016/j.neucom.2012.12.039
J. G. Proakis and D. G. Manolakis, Digital
Signal Processing: Principles, Algorithms,
and Applications, 3rd ed. New Jersey:
Prentice-Hall, Inc., 1996.
C. Bishop, Pattern Recognition and Machine
Learning, 1st ed. New York: Springer-Verlag
New York, 2006.
C. M. Bishop, Neural networks for pattern
recognition. New York: Oxford University
Press, 1995.
E. Giraldo-Suárez, J. I. Padilla-Buriticá, and
C. G. Castellanos-Domínguez, “Dynamic
inverse problem solution using a kalman
filter smoother for neuronal activity
estimation,” TecnoLógicas, no. 27, p. 33-51,
Dec. 2011.
https://doi.org/10.22430/22565337.3
C. G. Lemus, “Análisis de reducción de ruido
en señales eeg orientado al reconocimiento
de patrones,” Tecnológicas, no. 21, pp. 67–80,
Dec. 2008.
https://doi.org/10.22430/22565337.248
S.
Mingxu,
“A
functional
electrical
stimulation (fes) control system for upper
limb rehabilitation”, PhD Thesis, School of
Computing, Science and Engineering,
University of Salford,
Salford, 2014.
[En línea] Disponible en:
http://usir.salford.ac.uk/id/eprint/32854
A. Barachant, S. Bonnet, M. Congedo, and C.
Jutten, “Multiclass brain-computer interface
classification by Riemannian geometry,”
IEEE Trans. Biomed. Eng., vol. 59, no. 4,
pp. 920–928, Apr. 2012.
https://doi.org/10.1109/TBME.2011.2172210
M. Tangermann et al., “Review of the BCI
Competition IV,” Front. Neurosci., vol. 6,
no. 55, pp. 1–31, July. 2012.
https://doi.org/10.3389/fnins.2012.00055

[23]

[24]

[25]

[26]

[27]
[28]

[29]

[30]

[31]

[32]

[33]

B. Blankertz, R. Tomioka, S. Lemm, M.
Kawanabe, and K. Muller, “Optimizing
Spatial filters for Robust EEG Single-Trial
Analysis,” IEEE Signal Process. Mag.,
vol. 25, no. 1, pp. 41–56, Dec. 2008.
https://doi.org/10.1109/MSP.2008.4408441
F. Lotte and C. Guan, “Regularizing
Common Spatial Patterns to Improve BCI
Designs:
Unified
Theory
and
New
Algorithms,” IEEE Trans. Biomed. Eng.,
vol. 58, no. 2, pp. 355–362, Feb. 2011.
https://doi.org/10.1109/TBME.2010.2082539
S. Ge, R. Wang, and D. Yu, “Classification of
Four-Class Motor Imagery Employing
Single-Channel
Electroencephalography,”
PLoS One, vol. 9, no. 6, p. e98019, Jun. 2014.
https://doi.org/10.1371/journal.pone.0098019
T. Hastie, R. Tibshirani, and J. Friedman,
The Elements of Statistical Learning, 2nd ed.
New York: Springer, 2017.
https://doi.org/10.1007/b94608
S. Haykin, Neural Networks and Learning
Machines, 3rd ed. Ontario: Pearson, Prentice
Hall, 2008.
A. Barachant, “Commande robuste d’un
effecteur par une interface cerveau-machine
EEG
asynchrone”,
Tesis
Doctoral,
Electronique et système pour la santè,
Université de Grenoble, Grenoble, 2006.
[En línea] Disponible en:
https://tel.archives-ouvertes.fr/tel-01196752
A. Barachant, S. Bonnet, M. Congedo, and C.
Jutten, “Riemannian Geometry Applied to
BCI Classification,” in 9th International
Conference Latent Variable Analysis and
Signal Separation, France: Springer, 2010,
pp. 629-636.
https://doi.org/10.1007/978-3-642-15995-4_78
M. Congedo, A. Barachant, and A. Andreev,
“A New Generation of Brain-Computer
Interface Based on Riemannian Geometry,”
arXiv Prepr., p. 33, Oct. 2013.
F. Yger, M. Berar, and F. Lotte,
“Riemannian Approaches in Brain-Computer
Interfaces: A Review,” IEEE Trans. Neural
Syst. Rehabil. Eng., vol. 25, no. 10, pp. 1753–
1762, Oct. 2017.
https://doi.org/10.1109/TNSRE.2016.2627016
K. Holewa and A. Nawrocka, “Emotiv EPOC
neuroheadset in brain - computer interface,”
in Proceedings of the 2014 15th International
Carpathian Control Conference (ICCC),
Velke Karlovice, 2014, pp. 149–152.
https://doi.org/10.1109/CarpathianCC.2014.6
843587
J.-A. Martinez-Leon, J.-M. Cano-Izquierdo,
and J. Ibarrola, “Are low cost Brain
Computer Interface headsets ready for motor
imagery applications?,” Expert Syst. Appl.,
vol. 49, pp. 136–144, May. 2016.

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, sep-dic de 2019, pp. 213-231

Evaluación del aporte de la covarianza de las señales electroencefalográficas a las interfaces cerebrocomputador de imaginación motora para pacientes con lesiones de médula espinal
[34]

[35]

[36]

[37]

[38]

[39]

https://doi.org/10.1016/j.eswa.2015.11.015
N. A. Badcock et al., “Validation of the
Emotiv EPOC EEG system for research
quality auditory event-related potentials in
children,” PeerJ, vol. 3, p. 17, Apr. 2015.
https://doi.org/10.7717/peerj.907
J. Lu, D. J. McFarland, and J. R. Wolpaw,
“Adaptive
Laplacian
filtering
for
sensorimotor rhythm-based brain–computer
interfaces,” J. Neural Eng., vol. 10, no. 1,
p. 016002, Dec. 2012.
https://doi.org/10.1088/17412560/10/1/016002
F. Lotte, “A Tutorial on EEG Signalprocessing Techniques for Mental-state
Recognition in Brain–Computer Interfaces,”
in
Guide
to
Brain-Computer
Music
Interfacing, London: Springer London, 2014,
pp. 133–161.
https://doi.org/10.1007/978-1-4471-6584-2_7
D. Wu, J.-T. King, C.-H. Chuang, C.-T. Lin,
and T.-P. Jung, “Spatial Filtering for EEGBased Regression Problems in Brain–
Computer Interface (BCI),” IEEE Trans.
Fuzzy Syst., vol. 26, no. 2, pp. 771–781, Apr.
2018.
https://doi.org/10.1109/TFUZZ.2017.2688423
S. Yu, L.-C. Tranchevent, B. De Moor, and Y.
Moreau, “Rayleigh Quotient-Type Problems
in Machine Learning,” in Kernel-based Data
Fusion for Machine Learning: Methods and
Applications in Bioinformatics and Text
Mining, Heidelberg: Springer, 2011, pp. 2737.
https://doi.org/10.1007/978-3-642-19406-1_2
D. P. Bertsekas, Nonlinear Programming,
3rd
ed.
Massachussets:
Athena

[40]

[41]

[42]

[43]

[44]

[45]

Scientific, 2016.
D. Watkins, “6. The Generalized Eigenvalue
Problem,” in The Matrix Eigenvalue Problem,
1st ed., Washington: Society for Industrial
and Applied Mathematics, 2007, pp. 233–
263.
https://doi.org/10.1137/1.9780898717808.ch6
T. Fushiki, “Estimation of prediction error by
using K-fold cross-validation,” Stat. Comput.,
vol. 21, no. 2, pp. 137–146, Apr. 2011.
https://doi.org/10.1007/s11222-009-9153-8
E. Combrisson and K. Jerbi, “Exceeding
chance level by chance: The caveat of
theoretical chance levels in brain signal
classification and statistical assessment of
decoding accuracy,” J. Neurosci. Methods,
vol. 250, pp. 126–136, Jul. 2015.
https://doi.org/10.1016/j.jneumeth.2015.01.01
0
T. Fawcett, “An introduction to ROC
analysis,” Pattern Recognit. Lett., vol. 27,
no. 8, pp. 861–874, Jun. 2006.
https://doi.org/10.1016/j.patrec.2005.10.010
A. Barachant, S. Bon, M. Congedo, and C.
Jutten, “Common Spatial Pattern revisited
by Riemannian geometry,” in 2010 IEEE
International Workshop on Multimedia
Signal Processing, Saint Malo, 2010,
pp. 472–476.
https://doi.org/10.1109/MMSP.2010.5662067
K. A. Moxon, A. Oliviero, J. Aguilar, and G.
Foffani, “Cortical reorganization after spinal
cord injury: Always for good?,” Neuroscience,
vol. 283, pp. 78–94, Dec. 2014.
https://doi.org/10.1016/j.neuroscience.2014.06.
056

TecnoLógicas, ISSN-p 0123-7799 / ISSN-e 2256-5337, Vol. 22, No. 46, Sep-dic de 2019, pp. 213-231

[231]

