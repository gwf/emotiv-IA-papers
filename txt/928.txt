Downloaded from orbit.dtu.dk on: Jul 25, 2018

An Evaluation of EEG Scanner’s Dependence on the Imaging Technique, Forward
Model Computation Method, and Array Dimensionality

Stahlhut, Carsten; Attias, Hagai Thomas ; Stopczynski, Arkadiusz; Petersen, Michael Kai; Larsen, Jakob
Eg; Hansen, Lars Kai
Published in:
2012 Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC)
Link to article, DOI:
10.1109/EMBC.2012.6346235
Publication date:
2012

Link back to DTU Orbit

Citation (APA):
Stahlhut, C., Attias, H. T., Stopczynski, A., Petersen, M. K., Larsen, J. E., & Hansen, L. K. (2012). An Evaluation
of EEG Scanner’s Dependence on the Imaging Technique, Forward Model Computation Method, and Array
Dimensionality. In 2012 Annual International Conference of the IEEE Engineering in Medicine and Biology
Society (EMBC) (pp. 1538-1541 ). IEEE. (I E E E Engineering in Medicine and Biology Society. Conference
Proceedings). DOI: 10.1109/EMBC.2012.6346235

General rights
Copyright and moral rights for the publications made accessible in the public portal are retained by the authors and/or other copyright owners
and it is a condition of accessing publications that users recognise and abide by the legal requirements associated with these rights.
• Users may download and print one copy of any publication from the public portal for the purpose of private study or research.
• You may not further distribute the material or use it for any profit-making activity or commercial gain
• You may freely distribute the URL identifying the publication in the public portal
If you believe that this document breaches copyright please contact us providing details, and we will remove access to the work immediately
and investigate your claim.

An Evaluation of EEG Scanner’s Dependence on the Imaging
Technique, Forward Model Computation Method,
and Array Dimensionality
Carsten Stahlhut1 , Hagai Thomas Attias2 , Arkadiusz Stopczynski1,
Michael Kai Petersen1 Jakob Eg Larsen1, Lars Kai Hansen1.
Abstract— EEG source reconstruction involves solving an
inverse problem that is highly ill-posed and dependent on a
generally fixed forward propagation model. In this contribution
we compare a low and high density EEG setup’s dependence on
correct forward modeling. Specifically, we examine how different forward models affect the source estimates obtained using
four inverse solvers Minimum-Norm, LORETA, MinimumVariance Adaptive Beamformer, and Sparse Bayesian Learning.

I. INTRODUCTION
Electro-encephalography (EEG) holds great promise for
functional brain imaging due to its high temporal resolution.
In comparison with functional magnetic resonance imaging
(fMRI) and positron emission tomography (PET), the slow
hemodynamic response does not affect EEG. In addition
fMRI and PET involve heavy scanner equipment and immobilization constraints that compromise the experimental
situation, while EEG can be performed under much more
natural conditions.
Today EEG based brain imaging suffers from a lack of
spatial specificity due to the complex propagation of neural
quasi-static electric fields to the array of sensors placed at
the scalp surface. Motivated by the desire to perform reliable
and precise reconstruction of the neural current density,
much effort has been devoted to development of improved
inversion methods. The current literature can be divided in
two major approaches: Equivalent current dipole (ECD) and
distributed models. In ECD methods [1] it is assumed that
the brain activity is generated by a small number of focal
sources, which restricts the source localization problem to
a challenge of determining the positions and orientations of
the ECDs. In distributed models several prior assumptions
are made in order to solve the ill-posed inverse problem.
For example l2 -norm approaches, like the weighted minimum norm method [2] and low resolution electromagnetic
tomography (LORETA) [3], assume sources to be diffuse and
highly distributed. On the other hand models based on the
l1 -norm [4], lp -norms [5], minimum variance beamformer
[6], Bayesian model averaging [7], multiple priors models
[8], and automatic relevance determination methods [9],
[10], implement more focal sources. Most of these source
*This work is supported in part by the Danish Lundbeck Foundation
through CIMBI Center for Integrated Molecular Brain Imaging.
1 DTU Informatics, Technical University of Denmark, DK-2800 Kgs.
Lyngby. C. Stahlhut : cs at imm.dtu.dk
2 Convex Imaging, San Francisco, CA 94108, USA

localization methods employ spatial-temporal priors in order
to accommodate for the focal source distribution.
While the recent EEG imaging literature mainly have
focused on the source reconstruction performance using
high density EEG equipment we here draw the attention to
quantify the performance of EEG brain imaging using few
electrodes as we are interested in mobile EEG equipment. We
have previously, demonstrated the feasibility of performing
online brain imaging on a smartphone device [11] allowing
for experiments in more naturalistic settings. We here seek
a quantification of how well the current sources can be
reconstructed when evaluating different forward models and
source reconstruction methods.
Analyzing the importance of precise forward models and
their influence on either the forward problem or the inverse problem is far from new to the EEG community. A
number of contributions have already been published e.g.
[12], [13]. A majority of the forward model investigations
performed evaluates the forward models at sensor level or
only examine a few dipoles located in different brain regions.
These contributions have been of crucial importance to the
EEG community as they have shed light on serious issues
that we need to be aware of when the source solutions
are used as the basis of conclusions in a given setup. In
[12] an examination of the influence of geometric errors
on the source estimates is performed using BEM models
constructed from MR or CT images. A quite similar approach
as the analysis above have been presented in [14]. The
study in [14] deals with geometric errors introduced by
using too simple head models (spheres) compared to more
realistic BEM models. To evaluate the effect, angles between
forward fields were examined when assuming no noise at the
sensor level. In contrast to [14] we explored forward model
uncertainties in face of noise present at the sensor level [15]
and demonstrated that indeed source confusion is dependent
on the interplay of forward field errors and the amount of
noise present in the recordings.
Other types of uncertainities affecting the forward models
are the specific tissue conductivity values and the importance of modeling specific tissues as anisotropic rather than
isotropic have been discussed in [13], with the overall
consensus that inaccurate modeling of the skull leads to
significant error contributions on the sources. In fact [13],
[16] states that a smearing effect on the forward potential
computation is introduced by the skull anisotropy. The deeper

a source is located the more it is surrounded by anisotopic
tissues. Thus, electric fields generated by deeper sources are
more affected by the anisotropy than superficial sources.
Of more recent studies [17] should be mentioned in which
a careful analysis of how the number of electrodes, geometric
errors (spheres versus FEM head models), and anisotropy
versus isotropy affect the source estimates obtained by
beamformers. To the authors knowledge this is the first
study comparing how different inverse methods solutions are
affected by different choices of forward models as well as
the resolution with respect to the number sensors.
II. METHODS
The relation between the measured EEG signal and the
brain’s current sources can be expressed as a linear instantaneous form in the sources. The forward relation can be
written as [18]
Y = AX + E,
(1)
where the measured EEG signal is denoted Y ∈ ℜNc ×Nt ,
the current sources X ∈ ℜNd ×Nt , and the noise E is assumed
additive. Number of channels, dipoles (or sources), and time
samples are denoted Nc , Nd , and Nt , respectively. The
coupling of sensors and the current sources is expressed
through the lead field matrix/forward model A ∈ ℜNc ×Nd
with the rows referred to as the lead fields for the sensors
and the columns as the forward fields for the sources. The
forward model depends on sensor positions, a so-called
’head model’ of the spatial distribution of tissue, and tissue
conductivity values. Multiple methods based on the physical
properties of the brain and Maxwell’s equations are available
for computing A.
A. Minimum Norm and LORETA
Given the linear relation in Eq. (1) and if we assume the noise to be time independent Gaussian distributed,
the observation model becomes p (Y |X ) =
QNt
−1
ΣE where ΣE is the noise spatial
t=1 N yt Axt , β
covariance matrix. We here realize the source localization
by a Bayesian formulation of the widely used minimum
norm (MN) [2] and LORETA [3] methods as they allow
fast computation of the inverse solution. With MN regarded
as a special case of the LORETA we use as prior distribution for the sources a multivariate Gaussian p (X |α ) =
Q
Nt
−1 T
L L with L being the Laplacian opt=1 N xt 0, α
erator incorporating spatial smoothness on the source level.
MN is obtained in the limit of no spatial smoothness, i.e.
replacing L = I. Source estimates are now obtained from
Bayes’ rule by computing the posterior distribution over the
N
Qt
sources, which leads to p (X |Y ) =
N ( xt | µt , Σx ) with
t=1

Σx
µt

−1

= α

−1

= α

−1

K−α

KAT Σy AKα−1

T

KA Σy yt .

(2)
(3)

T

Σ−1
y

Here we have defined K ≡ L L and
≡
α−1 AKAT + β −1 Σε . Estimation of sources and the precision parameters α and β are carried out using a standard
expectation-maximization (EM) scheme [19].

B. Beamforming
Here we use minimum-variance adaptive beamforming,
which reconstructs
the signal si of each dipole i by a spatial
P
filter, si = j Wij yj . It chooses the filter that minimizes the
noise variance in the reconstructed signal under a unit-gain
constraint. Thus, for each i, we seek

Ŵij = argminW WΣE WT ii , (ŴA)ii = 1. (4)
The resulting reconstruction is given by

AT C−1
y y i
xi =
(AT C−1
y A)ii

(5)

where Cy is the empirical data covariance. In dense EEG
systems, where the number of sensors exceeds 100, this
covariance is low-rank and must be suitably regularized.
However, in systems with a small number of sensors, such as
the one described here, regularization is usually not required.
C. Sparse Bayesian Learning (SBL)
SBL is a promising recent addition to the source analysis
toolkit. In constrast to the previous methods which result
in brain images with a rather low spatial resolution, SBL’s
images are very sparse. This sparseness is achieved by
modeling each dipole distribution by a Gaussian with its own
N

Qt
separate precision parameter αi , p (X) =
N xt |0, D−1 ,
t=1

where D = diag (α) leading to a posterior distribution
N
Qt
p (X |Y ) =
N ( xt | µt , Σx ) with
t=1

Σ−1
x
µt

=
=

AT βΣ−1
E A+D
T
Σx A βΣ−1
E yt .

(6)
(7)

The precision parameters are estimated from data by a EMlike algorithm, made efficient using a convex optimization
technique. The update rule for α is given in [9].
III. EMPIRICAL EVALUATION
We demonstrate the influence of the choices of forward
models on the source estimates depending on which inverse
method that is used. In order to validate how the inverse
methods are affected by these choices we focus on two
different EEG setups, Emotiv EPOC (16 channels) and
Biosemi Active-II system (64 channels). For each of the EEG
setups we examine three types of head models; 3-spheres
(SPM8 toolbox), BEM-CP (SPM8 toolbox) [20], BEM-OP
(OpenMEEG toolbox) [21] all using the same cortical surface
with a resolution of 5,124 vertices. In contrast to spheres
models BEM models face high numerical challenges in order
to extract the forward fields at the cortical level. A limitation
with the BEM-CP implementation is a risk of improper
handling of forward fields for vertices very close to the
inner skull. This issue is illustrated in Fig. 1 in which we
demonstrate the 2-norm of each of the 5,124 vertices forward
fields. We note that the BEM-CP has a number of vertices
having forward fields much larger than the average. In this
section we inspect how such discontinuties in the electric
field may affect the source solutions.

−8

i

sum A12

8

R EFERENCES

SPM8: 3−spheres

x 10

6
4
2
0
0

1000

2000

3000
Vertex no.
SPM8: BEMCP

4000

5000

6000

1000

2000

3000
Vertex no.
OpenMEEG BEM

4000

5000

6000

1000

2000

3000
Vertex no.

4000

5000

6000

−5

2.5

x 10

2

sum A2i

2
1.5
1
0.5
0
0
−7

i

sum A32

3

x 10

2
1
0
0

Fig. 1. The distribution of the squared 2-norm of the forward fields for
three different forward models 3-spheres, BEM-CP, and BEM-OP when
using 64-channel Biosemi layout.

Evaluation is carried out on synthetic data. We select a
small cortical area in the right temporal lope as being active
and with a half sine as temporal signature. Fig.2.a shows the
spatial distribution. As true forward propagation model we
apply the OpenMEEG BEM model with tissue conductivities
brain:skull:scalp = 0.33:0.0041:0.33S/m. Gaussian noise is
added to the clean EEG signal in the order of SNR = 10,
see Fig.2.b. We define SNR as the ratio between the power
of the clean EEG and the noise. Fig.2.c shows the source
solutions of MN, LORETA, MVAB, and SBL methods when
applied to a low resolution setup of 16 channels (Emotiv) and
high density 64-channels (Biosemi). Overall MN, LORETA,
and MVAB all leads to widespread activity with MVAB
having difficulties to capture the simulated source in the
temporal lope. MN seems to be more affected by the BEMCP’s discontinuties in the electric field for the Emotiv setup
compared to Biosemi. However, LORETA minimizes the
influence of these discontinuties by its spatial smoothness.
The source estimates of the SBL algorithm on the other hand
leads to highly sparse solutions with a few strong sources
located close to the true source region.
IV. CONCLUSIONS
We examined inaccurate forward models influence on the
source reconstruction in a low and high density EEG setup.
Source solutions obtained using MN, LORETA, and SBL
demonstrated possibility of recovering sources located in the
temporal lope at a SNR=10 reliable for most of the forward
models and with SBL being the method resulting in the
most consisting source estimates for the the different forward
models. Further studies should evaluate the performance
under lower SNRs and with multiple source regions being
active simultaneously. Moreover, forward models considering
anisotropy such as Finite Volume Model and Finite Element
Model would be interested to include in the comparison.

[1] M. Scherg, T. Bast, and P. Berg, “Multiple source analysis of interictal
spikes: Goals, requirements, and clinical value,” J. Clin. Neurophysiol.,
vol. 16, pp. 214–224, 1999.
[2] M.S. Hämäläinen and R.J. Ilmoniemi, “Interpreting magnetic fields of
the brain: minimum norm estimates,” Med. Biol. Eng. Comput., vol.
32, pp. 35–42, 1994.
[3] R.D. Pascual-Marqui, M. Michel, and D. Lehmann, “Low resolution
electromagnetic tomography: A new method for localizing electrical
activity in the brain,” Int J. Psychophys, vol. 18, pp. 49–65, 1994.
[4] M. Fuchs, M. Wagner, T. Kohler, and H.A. Wischman, “Linear and
nonlinear current density reconstructions,” J. Clin. Neurophysiol., vol.
16, no. 3, pp. 267–295, 1999.
[5] T. Auranen, A. Nummenmaa, M. Hämäläinen, I. Jääskeläinen,
J. Lampinen, A. Vehtari, and M. Sams, “Bayesian analysis of the
neuromagnetic inverse problem with ℓp -norm priors,” NeuroImage,
vol. 26, pp. 870–884, 2005.
[6] F. Darvas, D. Pantazis, E. Kucukaltun Yildrium, and R. Leahy,
“Mapping human brain function with MEG and EEG: methods and
validation,” NeuroImage, vol. 25, pp. 383–394, 2004.
[7] N.J. Trujillo-Barreto, E. Aubert-Vazquez, and P.A. Valdes-Sosa,
“Bayesian model averaging in EEG/MEG imaging,” NeuroImage, vol.
21, no. 4, pp. 1300–1319, 2004.
[8] K. Friston, L. Harrison, J. Daunizeau, S. Kiebel, C. Phillips,
N. Trujillo-Barreto, R. Henson, G. Flandin, and J. Mattout, “Multiple
sparse priors for the M/EEG inverse problem,” NeuroImage, vol. 39,
pp. 1104–1120, 2008.
[9] D. P. Wipf, J. P. Owen, H. T. Attias, K. Sekihara, and S. S. Nagarajan,
“Robust Bayesian estimation of the location, orientation, and time
course of multiple correlated neural sources using MEG,” Neuroimage,
vol. 49, no. 1, pp. 641–655, 2010.
[10] Carsten Stahlhut, Hagai T. Attias, David Wipf, Lars K. Hansen,
and Srikantan S. Nagarajan, “Sparse spatio-temporal inference of
electromagnetic brain sources,” in Machine Learning in Medical
Imaging, vol. 6357 of Lecture Notes in Computer Science, pp. 157–
164. Springer Berlin / Heidelberg, 2010.
[11] A. Stopczynski, J. Larsen, C. Stahlhut, M. Petersen, and L. Hansen,
“A smartphone interface for a wireless eeg headset with real-time 3d
reconstruction,” Affective Computing and Intelligent Interaction, pp.
317–318, 2011.
[12] G. Huiskamp, M. Vroeijenstijn, R. van Dijk, G. Wieneke, and A.C.
van Huffelen, “The need for correct realistic geometry in the inverse
EEG problem,” IEEE Trans. Biomed. Eng., vol. 46, no. 11, pp. 1281–
1287, Nowember 1999.
[13] C.H. Wolters, A. Anwander, X. Tricoche, D. Weinstein, M.A. Koch,
and R.S. MacLeod, “Influence of tissue conductivity anisotropy on
EEG/MEG field and return current computation in a realistic head
model: A simulation and visualization study using high-resolution
finite element modeling,” Neuroimage, vol. 30, no. 3, pp. 813–826,
2006.
[14] M. Fuchs, R. Drenckhahn, H. Wischmann, and M. Wagner, “An
improved boundary element method for realistic volume-conductor
modeling,” IEEE Transactions on Biomedical Engineering, vol. 45,
no. 8, pp. 980–997, 1998.
[15] Carsten Stahlhut, Functional Brain Imaging by EEG: A Window to the
Human Mind, Ph.D. thesis, Technical Univeristy of Denmark, DTU
Informatics, DK-2800 Richard Petersens Plads, Denmark, 2011.
[16] H. Hallez, B. Vanrumste, R. Grech, J. Muscat, W. De Clercq, A. Vergult, Y. D’Asseler, K.P. Camilleri, S.G. Fabri, S. Van Huffel, et al.,
“Review on solving the forward problem in EEG source analysis,” J
of NeuroEng. and Rehab, vol. 4, no. 1, pp. 46, 2007.
[17] O. Steinsträter, S. Sillekens, M. Junghoefer, M. Burger, and C.H.
Wolters, “Sensitivity of beamformer source analysis to deficiencies
in forward modeling,” Human brain mapping, vol. 31, no. 12, pp.
1907–1927, 2010.
[18] S. Baillet and L. Garnero, “A bayesian approach to introducing
anatomo-functional priors in the EEG/MEG inverse problem,” IEEE
Trans. on Biomedical Engineering, vol. 44, no. 5, pp. 374–385, 1997.
[19] C. M. Bishop, Pattern Recognition and Machine Learning, Springer,
NY 10013 (USA), 2006.
[20] C.L.M. Phillips, “Source estimation in EEG: Combining anatomical
and functional constraints,” PhD Thesis, 2000.
[21] A. Gramfort, T. Papadopoulo, E. Olivi, M. Clerc, et al., “Openmeeg:
opensource software for quasistatic bioelectromagnetics,” Biomedical
engineering online, vol. 9, no. 1, pp. 45, 2010.




































 























  















Fig. 2. a) Simulated spatial source distribution. b) Simulated sensor signal including noise. c) Reconstructed source estimates using MN, LORETA,
MVAB, and SBL on two different EEG setups, Emotiv (Nc = 16) and Biosemi (Nc = 64) and three head models: 3-shell, BEM-CP, and BEM-OP.

