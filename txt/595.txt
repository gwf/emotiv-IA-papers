THESIS

P300 WAVE DETECTION USING EMOTIV EPOC+ HEADSET: EFFECTS OF
MATRIX SIZE, FLASH DURATION, AND COLORS

Submitted by
Saleh Ibrahim Alzahrani
Graduate Degree Program in Bioengineering

In partial fulfillment of the requirements
For the Degree of Master of Science
Colorado State University
Fort Collins, Colorado
Fall 2016

Master’s Committee:
Advisor: Charles W. Anderson
Jozsef Vigh
William Gavin

Copyright by Saleh Ibrahim Alzahrani 2016
All Rights Reserved

Abstract
P300 WAVE DETECTION USING EMOTIV EPOC+ HEADSET: EFFECTS
OF MATRIX SIZE, FLASH DURATION, AND COLORS

Brain-computer interfaces (BCIs) allow interactions between human beings and computers without using voluntary muscle. Enormous research effort has been employed in the last
few decades to design convenient and user-friendly interfaces. The aim of this study is to
provide the people with severe neuromuscular disorders a new augmentative communication
technology so that they can express their wishes and communicate with others. The research
investigates the capability of Emotiv EPOC+ headset to capture and record one of the BCIs
signals called P300 that is used in several applications such as the P300 speller. The P300
speller is a BCI system used to enable severely disabled people to spell words and convey
their thoughts without any physical effort. In this thesis, the effects of matrix size, flash duration, and colors were studied. Data are collected from five healthy subjects in their home
environments. Different programs are used in this experiment such as OpenViBE platform
and MATLAB to pre-process and classify the EEG data. Moreover, the Linear Discriminate
Analysis (LDA) classification algorithm is used to classify the data into target and non-target
samples.

ii

Acknowledgements

I would like to express my gratitude and thanks to everyone who has helped me since I
began my BCI journey. The first person is my advisor Dr. Charles Anderson who gives me
his valuable time to encourage and support me to finish this work. I do not believe this work
would have been done without his suggestions and help. Also, I would like to convey thanks
to the members of my thesis committee Dr.Jozsef Vigh and Dr.William Gavin for extending
their support and time to my thesis. I am also grateful to Saudi Arabian Cultural Mission
(SACM) who funds me to buy Emotiv headset and all necessary equipment and programs
that are used in this research. Finally, I would like to thank my parents, family, and friends
for their encouragements during this work.
This thesis is typset in LATEX using a document class designed by Leif Anderson.

iii

Table of Contents
Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

ii

Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . iii
List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

vi

List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . vii
Chapter 1. Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1

1.1. What is a Brain Computer Interface ?. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3

1.2. Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

1.3. Research Questions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

7

1.4. Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

7

Chapter 2. Background and Related Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

8

2.1. Brain Structure and Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

8

2.2. BCI Structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10
2.3. EEG Waves . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12
2.4. P300 and P300 Speller . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14
2.5. Emotiv EPOC+ Headset . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17
2.6. OpenViBE Software . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 19
2.7. Related Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20
Chapter 3. Methodology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
3.1. Data Acquisition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23
3.2. Participants. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
3.3. Linear Discriminant Analysis (LDA) Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24
iv

3.4. OpenViBE Scenarios . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 26
Chapter 4. Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
4.1. The Capability of Emotiv EPOC+ headset for Detecting P300 Wave . . . . . . . . . . 32
4.2. The Most Active Channels for P300 Wave Detection . . . . . . . . . . . . . . . . . . . . . . . . . . 37
4.3. The effects of matrix size on the P300 speller performance. . . . . . . . . . . . . . . . . . . . . 38
4.4. The effect of flash duration on the P300 speller performance . . . . . . . . . . . . . . . . . . . 43
4.5. The effect of using colored matrix on the P300 amplitude . . . . . . . . . . . . . . . . . . . . . 47
4.6.

Exploring the significance of the Number of Training Sessions . . . . . . . . . . . . . . . . 49

Chapter 5. Conclusion and Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 52
Bibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55
Appendix A. Informed consent form to participate in a research project . . . . . . . . . . . . . 64

v

List of Tables
1.1

Overview of current functional brain imaging technologies [50] . . . . . . . . . . . . . . . . . . .

4

2.1

EPOC+, EPOC, and Insight headsets with their features [16]. . . . . . . . . . . . . . . . . . . . 18

4.1

EEG amplitudes at O1 and O2 averaged over 240 target letter trials and 1200
non-target trials for 6x6 and averaged over 240 target letter trials and 480
non-target trials for 3x3 matrix sizes. The flash duration is 100 ms. . . . . . . . . . . . . . . 42

4.2

A comparison of using different flash duration (100 ms, 175 ms) on the EEG
amplitudes for participants #3 and #4. The EEG amplitudes at O1 and O2
averaged over 240 target letter trials and 1200 non-target trials. The matrix size
is 6x6. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

4.3

A comparison of using different flash duration (100 ms, 175 ms) on the EEG
amplitudes for participants #3 and #4. The EEG amplitudes at O1 and O2
averaged over 240 target letter trials and 480 non-target trials. The matrix size is
3x3. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

vi

List of Figures
1.1

This figure illustrates the definition of BCI that has been given by the researchers
in Wadsworth center [41]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5

2.1

The cerebrum and its four lobes: frontal, parietal, occipital, and temporal [28]. . . .

9

2.2

The main structure of a single neuron cell which involves the cell body, dendrites,
and axon [65]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

9

2.3

General structure of the brain-computer interface [32]. . . . . . . . . . . . . . . . . . . . . . . . . . . . 12

2.4

Five typical dominant brain normal rhythms. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 13

2.5

The conventional P300 speller paradigm that was first established by Farwell and
Donchin in 1988 [21]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15

2.6

Average of 180 target epochs (in blue) and 900 non-target epochs (in red) recorded
at channel Pz [53]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

2.7

Emotiv EPOC+ headsets and its electrodes location . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

3.1

Illustration of the geometry of a linear discriminant function in 2-D [6]. . . . . . . . . . . 25

3.2

P300 speller acquisition scenario. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 27

3.3

Training the LDA classifier scenario. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29

3.4

Online scenario . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

4.1

EEG amplitude versus time at AF3, F7, F3, FC5, T7, FC6, and F4 average over
240 trials for target letters and 1200 trials for nontarget letters. Each plot is for 6
x 6 matrix and 100 ms flash duration. For each plot, x-axis represents time (ms)
and y-axis represents amplitude (µV). The time length in each plot is 600 ms. The
vertical line represents the time at 300 ms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
vii

4.2

EEG amplitude versus time at F8, AF4, T8, P7, O1, O2, and P8 average over 240
trials for target letters and 1200 trials for nontarget letters. Each plot is for 6 x 6
matrix and 100 ms flash duration. For each plot, x-axis represents time (ms) and
y-axis represents amplitude (µV). The time length in each plot is 600 ms. The
vertical line represents the time at 300 ms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

4.3

The distribution of the event-related potentials (ERPs) over the scalp of participant
#1 at different time after a target visual stimulation. . . . . . . . . . . . . . . . . . . . . . . . . . . . 37

4.4

The averaged r-squared values plot for all participates [37] . . . . . . . . . . . . . . . . . . . . . . . 38

4.5

EEG amplitudes at O1 and O2 averaged over 240 target letter trials (in blue) and
1200 non-target trials (in red) for 6x6 and averaged over 240 target letter trials
and 480 non-target trials for 3x3 matrix sizes. The flash duration is 100 ms. . . . . . . 41

4.6

The average online accuracy for all participants for matrix sizes 6x6 and 3x3 with
flash duration of 100 ms. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42

4.7

The average offline accuracy for all participants for matrix sizes 6x6 and 3x3 with
flash duration of 100 ms. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43

4.8

EEG amplitudes at O1 and O2 averaged over 240 target letter trials and 1200
non-target letter trials for 6x6 matrix size and different flash durations (100 ms
and 175 ms). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

4.9

EEG amplitudes at O1 and O2 averaged over 240 target letter trials and 1200
non-target letter trials for 3x3 matrix size and different flash durations (100 ms
and 175 ms). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45

4.10 This figure illustrates the average online and offline accuracies for participants #3
and #4. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 46
viii

4.11 P300 amplitudes for participants #1,#2, and #3 when using a conventional
(White/Gray) and colored (Green/Blue) P300-BCI speller paradigm. . . . . . . . . . . . . . 48
4.12 This figure illustrates the online accuracy for all participants in each training
session . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

ix

CHAPTER 1

Introduction
Technology dominates much of modern humanity’s existence, and the medical field is no
different. Decades ago, the intersection of different interdisciplinary fields, such as engineering, mathematics, psychology, and computer science, would have been a confused notion;
today, this intersection forms a partnership that saves countless lives every day. For more
than two decades, scientists and researchers have been developing methods to increase the
quality of life of paralyzed people and to provide them a more independent life. According
to the Christopher & Dana Reeve Foundation [25], 1.9% of the United States population is
suffering from motor disabilities as a result of neuromuscular disorders, such as amyotrophic
lateral sclerosis, brainstem stroke, cerebral palsy, and spinal cord injury and other diseases
of the peripheral nervous system. These types of diseases result in these individuals losing
conventional communication methods due to the disruption of their neuromuscular channels.
There are three ways to restore function of the muscular system [69]. The first option is to
use the remaining pathways instead of the damaged muscular channels. For instance, the
non vocally disabled can use hand movements to produce synthetic speech [18]. The second
method is to establish a detour around the breaks in the neural pathways that control muscles. For people who are suffering from spinal cord injury, electromyographic (EMG) can
be employed to restore useful movement[24]. The last method that is used for restoring the
function of the muscles is opening a non-muscular channel between the human brain and
computers to translate the brain activities into commands that can be used for control and
communication purposes; this method is well known as a brain-computer interface (BCI).

1

Brain-computer interfaces (BCIs), also known as brain-machine interfaces (BMIs) or
Mind-Machine Interfaces (MMIs), are communication and control systems that are used to
provide a direct form of communication for disabled people who have lost their ability to
communicate by using peripheral nerves and muscles. A variety of methods for monitoring
and recording brain activity have been used. These include electroencephalography (EEG),
magnetoencephalography (MEG), positron emission tomography (PET), functional magnetic
resonance imaging (fMRI), and optical imaging [69]. Table 1.1 provides an overview of
current functional brain imaging technologies [50]. Among these methods, EEG is considered
as the most attractive way to record brain signals due to its simplicity and affordability. In
1929, Hans Berger, a German neurologist, discovered electroencephalography (EEG) as well
as the alpha wave [31]. Two methods are used to record the signals from the brain: invasive
technologies, in which electrodes are implanted directly into brain tissue, and non-invasive
technologies, in which electrodes are placed on the scalp and detect neuron activity. Over the
past two decades, many studies have shown that different types of signals can be recorded
from the scalp including P300 potential, mu or beta rhythms, and cortical neuronal activity
recorded by implanted electrodes. The BCIs have been employed in many applications that
are necessary for a daily usage; for instance, locomotion applications such as controlling a
wheelchair [63], and environmental control applications such as controlling an appliance [13].
One of the most popular types of BCIs that relies on event-related potentials and the P300
signal is well known as a P300-BCI.
In this study, an affordable and low-cost consumer-grade EEG device, namely Emotiv
EPOC+, is used to investigate one of the brain-computer interfaces applications called the
P300 speller. With the P300 speller, users can convey their thoughts without using any
voluntary muscles. In other words, the P300 speller is a communication tool for those who

2

cannot convey their emotions and thoughts by using the conventional methods due to the
damage to nerve fibers that are involved in control of voluntary muscles used that might be
used in communication tasks.
1.1. What is a Brain Computer Interface ?
In the 1970s, Jacques Vidal applied the term brain-computer interface to describe any
computer-based system that obtained information about brain function [68]. Over the past
two decades, many researchers have discussed different definitions for brain-computer interfaces. The following list provides some definitions for BCIs:
• The researchers in Wadsworth center have defined the BCI as the following [41]:
”The brain-computer interface is a system which takes a biosignal measured from
a person and predicts (in real time/on a single-trial basis) some abstract aspect of
the person’s cognitive state.”
• J. J. Vidal [64]: ”The BCI system is geared to use both the spontaneous EEG and
the specific evoked responses triggered by time-dependent stimulation under various
conditions for the purpose of controlling such external apparatus as for example
prosthetic devices.”
• A.B. Schwartz [60]: ”Microelectrodes embedded chronically in the cerebral cortex
hold promise for using neural activity to control devices with enough speed and
agility to replace natural, animate movements in paralyzed individuals. Known as
cortical neural prostheses (CNPs), devices based on this technology are a subset of
neural prosthetics, a larger category that includes stimulating, as well as recording,
electrodes.”

3

Table 1.1. Overview of current functional brain imaging technologies [50]
Technique
Electroencepholograph
(EEG)

Magnetoelectrograph
(MEG)

Physical
Property
Electrical
potential

Measurement
Advantages
Mechanism
Electrodes are placed on the scalp • Portable, wearable
in order to measure the weak • High temporal resolution
electrical potentials generated by
neural activity in the brain

Magnetic
potential

Measures magnetic fields generated by the electrical activity of
the brain

4

Positron
Blood flow
Emission
Tomography
(PET)
Single
Photo Blood flow
Emission Computed Tomography (SPECT)

Detects chemical activity of injected radioactive tracers by measuring gamma ray emission

Functional Mag- Blood flow
netic Resonance
Imaging (fMRI)

Measures magnetic properties of
blood to determine the decrease
in deoxyhemoglobin to active
brain region

Works like PET except that uses
photomultiplier tubes to measure
photons generated by gamma
rays

Functional Near Blood
flow, Measures the absorption and
Infrared (fNIR) Changes
in scattering of near infrared light
cortical tissue
directed into the brain to determine changes in tissue oxygenation (slow response) as well as
changes in neuronal membranes
during neuron firing (fast event
related response)

Disadvantages

• Low spatial resolution due to
noise added when signals move
through fluid,bone, and skin
• Requires carful placement of
electrodes on scalp
• MEG enables much deeper • Bulky and expensive equipment
imaging and is much more sensi- due to necessity for superconductive that EEG, since skull is al- tivity
most completely transparent to
magnetic waves
• Bulky and expensive equipment
• Unsuitable for sustained use
due to need to inject radioactive
substances
• Slightly less expensive that • Low temporal resolution and
PET
spatial resolution than PET
• Bulky and expensive equipment
• Unsuitable for sustained use
due to need to inject radioactive
substances
• High spatial resolution (⇠ • Low temporal resolution (5–8 s)
1mm–1cm)
because inflow of blood is not an
immediate phenomenon
• Bulky and expensive equipment
due to need for superconducting
magnets
• High spatial resolution (<1cm) • Low temporal resolution (5-8
• Similarity to fMRI allows trans- s) when using slow response meafer of knowledge
surements
• Portable, wearable • Does not
require large amount of expertise
to set up
• Non-ionizing light safe for extended use

4

• J.P. Donoghue[19]: ”A major goal of a BMI (brain-machine interface) is to provide a
command signal from the cortex. This command serves as a new functional output
to control disabled body parts or physical devices, such as computers or robotic
limbs.”
• J. Wolpaw et al. [70]: ”A direct brain-computer interface is a device that provides
the brain with a new, non-muscular communication and control channel.”

Figure 1.1. This figure illustrates the definition of BCI that has been given
by the researchers in Wadsworth center [41].
The BCIs can be categorized into three types. The first type is active BCIs, in which
the user can control a device by conscious voluntary thought. For example, the user can
focus on a control thought such as imagining moving limbs and directly trying to manipulate
an application. The other type is reactive BCIs, in which the user utilizes brain processes
that happen in response to external events. One application of reactive BCIs is focusing on
a flickering light and the BCI analyzes the brain responses to this input. The last type is
passive BCIs, where the BCI essentially picks up any brain processes that the brain generates
for the purpose of studying the interaction between the human brain and the environment.

5

1.2. Motivation
Today, incredibly powerful EEG headsets are available on the market. Therefore, the
issue of choosing a suitable headset that can be used daily must be considered. Unfortunately,
few of them are feasible for daily usage due to the size, price, or difficulty of use. There
are many reasons behind choosing Emotiv EPOC+ to be utilized in this research. The first
reason is the commercial factor, since the price of the Emotiv EPOC+ headset is $200-400
for a consumer edition and $500 for a research edition, which is reasonable for all users if we
compare it with other EEG headsets’ prices. Another reason is that it is a wireless headset,
which makes it suitable for out-of-lab applications.
The majority of EEG headsets are not easy to be used since they require long setup times
and a specific way to place the electrodes in a specific position. However, the Emotiv EPOC+
headset does not require extensive time for setting up and can be successfully utilized by
any user after a few sessions of training. Another important aspect behind choosing Emotiv
EPOC+ as a recording device in this study is that some EEG headsets require numerous
training sessions to achieve high and sufficient accuracies; however, the Emotiv EPOC+
headset necessitates only 3 to 4 training sessions to achieve high accuracy, as it is explained
in Chapter 4. All these reasons are motivating to test the performance of P300 speller when
the Emotiv EPOC+ device used as an EEG detection headset.
Designing an optimal paradigm for P300 spelling is another objective that motivates
us in this study. The researchers have been investigating the effect of different variables
such as matrix size, inter-stimulus interval, position of the letters, etc. on the P300 speller
performance [3][61][36][38]. In this research, the effect of the matrix size, flash duration,
and changing of colors in the P300-BCI have been tested to study their impact on the P300
speller accuracy.

6

1.3. Research Questions
The primary purpose of this research is to design a successful online brain-computer
interface system that can be used by paralyzed people as a communication tool instead of
using a conventional communication method. As it is explained previously in Section 1.2,
Emotiv EPOC+ headset is chosen to be utilized in this study. This study attempts to answer
the following questions:
(1) How does the brain-computer interface (BCI) work?
(2) Does Emotiv EPOC+ have the capability to record P300 waves?
(3) What is the effect of matrix size, inter-stimulus interval, and colors on P300 speller
performance?
(4) Can anyone use P300 speller correctly?
(5) How many training sessions are required to achieve the highest online accuracy?
1.4. Overview
The thesis is organized as follows. Chapter 2 presents a background on the brain structure
and its function followed by the BCI structure and related works that use the Emotiv headset
in different BCI applications. Next, Chapter 3 explains the methodology of this study and
how the data are acquired from the participants. Moreover, the design and implementation
of the research are discussed in Chapter 3. Chapter 4 discusses the results that have been
obtained from five healthy subjects. Finally, the work is concluded in Chapter 5 and the
future work is also outlined in this chapter.

7

CHAPTER 2

Background and Related Work
2.1. Brain Structure and Function
The main organ of the human nervous system is the brain. The brain is divided into
three major parts, the forebrain, the midbrain and the hindbrain. The forebrain is the largest
part of the brain, most of which is made up of the cerebrum also known as telencephalon
and diencephalon. The cerebrum consists of two hemispheres: right and left hemispheres
divided by the longitudinal fissure. The left hemisphere controls the limb movements of the
right side of the body, while the right hemisphere controls the limb movements of the left
side of the body.
As Figure 2.1 illustrates, each hemisphere is composed of frontal, temporal, parietal,
and occipital lobes. The frontal lobes are located at the top part of the brain behind the
eyes and are responsible for voluntary movements and memory. The parietal lobes come
behind the frontal lobes and are responsible for many tasks such as processing the sensory
information and language processing. The temporal lobes are located on each side of the
brain. Moreover, the temporal lobes have many functions such as production of speech,
understanding language, and memory acquisition. The occipital lobes, the smallest lobes in
the brain, are located at the back of the head. In addition, the occipital lobes contain the
primary visual cortex which is responsible for processing the visual information. The central
sulcus separates the frontal lobe from the parietal lobe, and the lateral sulcus separates the
temporal lobe from the frontal and parietal lobe. The information is transferred between
the right and left hemispheres through a sheet of fibers called the corpus callosum.

8

Figure 2.1. The cerebrum and its four lobes: frontal, parietal, occipital, and
temporal [28].

Figure 2.2. The main structure of a single neuron cell which involves the
cell body, dendrites, and axon [65].

The human brain consists of billions of neurons. The neuron cells of the nervous system
can transmit information in the form of electrical or chemical signals along its axon. The
neuron cells are classified into three types based on the different functions. The first category
is the sensory neuron cells, where they pick up information from the senses and send signals
to the neural system. Motor neuron cells are the second type of the neuron cells, where
they send out the signals and information from the brain and spinal cord to the rest of the
9

body. The third type of the neurons is interneurons which are located in the central nervous
system (CNS). The interneurons connect the central nervous system with the sensory and
motor neurons. Figure 2.2 shows the anatomy of a single neuron.
The structure of the neuron cell involves the cell body, the axon, and the dendrites. The
cell body controls all the functions of the cell and produces the proteins to the axon and
dendrites. The dendrites are responsible for receiving information from other neurons at
synapses. The last part of the neuron cell is the axon, which transmits electrical or chemical
impulses from the cell body to other neurons.
The EEG waves are the continuous recording of the electrical signals the brain produced
by the firing of neurons [71]. When the dendrites of a neuron receive the neurotransmitters
from the axon of other neurons, it causes an electrical polarity change inside the neuron.
This polarity change is what the EEG is recording. It is the post-synaptic dendritic currents
from cortical pyramidal cells. The activity from one single neuron is not big enough to be
detected with the EEG device. However, there are so many pyramidal cells parallel to each
other. These cells are stimulated at the same time and produce large voltage changes which
can be detected outside the head.

2.2. BCI Structure
The brain-computer interface is a communication and control system. Therefore, it has
the main structure for any communication and control systems which are: input, output,
and processor. The general structure of BCIs is presented in Figure 2.3
A typical BCI system consists of several components. The first component is the signal
acquisition, which records neural activity from the brain. The signal acquisition component
consists of electrodes, which are placed on the scalp or inside the brain to record the brain
10

signals. The second component of the BCI system is the signal processing, which has three
stages. The first stage is the preprocessing, which involves amplification, filtering, and analog
to digital (A/D) conversion. The human brain generates very low signals, less than 100 µV,
so they need to be amplified to increase the power of the signals. In addition, in this stage, a
specific filter can be used to remove the artifacts from the signals without losing any relevant
information. The preprocessing step plays a significant role in the BCI systems because it
improves the quality of the signals by increasing the signal-to-noise ratio (SNR) and removes
the redundancy from the EEG channels.
The second stage in the signal processing is the feature extraction. The brain patterns
can be categorized into different features such as amplitudes, frequency bands, and firing
rates. Feature extraction methods extract the information from the brain signal either
in time domain, frequency domain, or time-frequency domain. Several feature extraction
techniques such as self-organizing fuzzy neural networks (SOFNNs) [17], Fourier Transform
(FT) [1], continuous/discrete wavelet transform [1], and autoregression models [35] have been
employed to construct a reliable BCI system with high speed and accuracy.
Once the signal features have been extracted, they are classified to find out which kind of
mental task the subject is performing. Several algorithms have been employed in the BCIs
field to classify the EEG signals. These might use linear methods, such as linear discriminant
function, or nonlinear methods, such as neural network. The last component of the BCIs is
the output device. The output device receives the commands from the previous stages to
perform a specific task, for example, controlling a wheelchair or moving a cursor.

11

Figure 2.3. General structure of the brain-computer interface [32].
2.3. EEG Waves
As it is stated in Section 2.2, the information can be extracted from EEG signals in the
frequency domain. The brain waves are categorized according to their frequency bands into
five waves as Figure 2.4 shows. These waves are as follows [33]:
• Delta (δ): It lies within the frequency range of 0.5 – 4 Hz. The amplitude of delta
wave is the highest comparing with the other brain waves. However, it tends to
be the slowest wave. It is usually seen in adults (in frontal lobe) and babies (in
posterior lobe). Moreover, it is associated with fatigue, deep sleeping, deep physical
relaxation, unconsciousness.
• Theta (θ): Theta wave lies within the frequency range of 4 – 7 Hz. The amplitude
of the theta waves are usually greater than 20 µV. Theta waves are associated with
attention lapses, memory consolidation, meditation.
• Alpha (α): Alpha waves were discovered by Hans Berger, a German neurologist. It
is lies within the frequency range of 8 – 13 Hz and voltage range of 30 – 50 µV.
Alpha waves can be generated by all parts of the cortex. It is associated with closing
12

the eyes and relaxation. In addition, it is recorded from sensorimotor areas in the
brain.
• Beta (β): It can be seen on both sides of the brain in a symmetrical distribution. In
addition, the frequency of the beta wave is ranged from 13 – 30 Hz and the voltage
lies between 5 – 30 µV. The beta wave is associated with active thinking, active
attention, and focus on the outside world or solving concrete problems. Moreover,
the beta waves usually are divided into β1, which is linked to increase in mental
abilities, and β2, which is linked to alertness.
• Gamma (γ): Gamma wave which lies within the frequency range of > 35 Hz and reflects the mechanism of consciousness. Also, it is shown during short term memory
activities. Moreover, it can be obtained by placing the electrodes on the somatosensory cortex.

Figure 2.4. Five typical dominant brain normal rhythms.

13

2.4. P300 and P300 Speller
The P300 wave is the most important and studied component of event-related potentials
(ERPs). The ERP is the response of the brain for an external stimulus. The P300 waves
can be acquired invasively by implanting ECoG electrodes or non-invasively by placing EEG
electrodes around the parietal, central, or occipital lobe [9][26]. Most often, P300 waves are
recorded from central or parietal lobe. However, for Emotiv headset users, the P300 waves
are recorded from the occipital lobe since Emotiv system does not provide central or parietal
electrodes [42][12]. And there are by far more P300 studies that use systems other than
Emotiv. In this research, O1 and O2 electrodes were found most useful in this study because
central and parietal electrodes are not provided by Emotiv system.
The P300 is observed in an EEG as a significant positive peak 300 ms to 500 ms after an
infrequent, but expected, stimulus has seen presented to a subject (see Figure 2.6). Figure
2.6 shows the averaged P300 response at electrode Pz , displaying a large positive peak from
about 300–500 ms. In 1988, Farwell and Donchin introduced the P300 wave and proposed the
P300 matrix speller [23]. Figure 2.5 shows the conventional P300 speller paradigm which is
represented by 6x6 matrices of alphanumeric characters (letters of the alphabet and numbers
0–9). These characters are intensified in rows and columns in a random sequence. The user
is instructed to focus his/her attention to the desired character he/she wishes to spell. To
help the user to be concentrating on the target character, the user has to count mentally each
time the row or column containing the target letter flashes. The intersection of the target
row and column that have the desired character elicits the P300 signal. The researchers have
developed P300-BCIs system other than the visual P300-BCI such as auditory and tactile
P300-BCIs [8][14].

14

One drawback of the P300 waves is the low signal-to-noise ratio (SNR). The P300 wave
is influenced by many sources of noise. For instance, the electrical signals produced by the
eye movement (EOG signals) or muscle activity (EMG signals) can contribute to the EEG
recorded from the scalp [69]. Many methods have been developed to detect the noise and
enhance the SNR such as using matched filter or temporal filter. One of the methods used
in this study to maximize the SNR is by averaging the signals for many consecutive trials.
For that reason, the classification process required many trials to be able to distinguish the
target and non-target characters.

Figure 2.5. The conventional P300 speller paradigm that was first established by Farwell and Donchin in 1988 [21].

Various signal processing techniques and machine learning algorithms were developed to
increase the reliability of the P300-BCI speller system [44][48]. To classify the target and nontarget character, different classification algorithms have been implemented successfully such
as Step Wise Linear Discriminant Analysis (SWLDA), Independent Component Analysis
(ICA), Support Vector Machine (SVM), etc. In our study, we use OpenViBE platform
15

which provides two different classification algorithms: Linear Discriminant Analysis (LDA)
and Support Vector Machines (SVMs).

Figure 2.6. Average of 180 target epochs (in blue) and 900 non-target epochs
(in red) recorded at channel Pz [53].

The LDA algorithm is used in this study to distinguish between target and non-target
samples due to its simplicity of use and it requires a very low computational time.

16

2.5. Emotiv EPOC+ Headset
Emotive EPOC+ is a wearable headset used to capture the electroencephalograph (EEG)
from the brain and send it wirelessly to a computer via a USB dongle. The Emotiv EPOC+
headset has become popular as a result of its low-cost price and features [5]. Figure 2.7
illustrates the Emotiv EPOC+ headset and its electrode positions. The Emotiv EPOC+
has 14 electrodes (AF3, AF4, F3, F4, FC5, FC6, F7, F8, T7, T8, P7, P8, O1, O2) plus two
standard reference electrodes (CMS, DRL) and gyroscope provides information about head
movements. The Emotiv EPOC+ connects to the computer wirelessly and has considerable
lithium-based battery autonomy of 12 hours. It has two different sampling rates,128 or 256
samples per sec per channel. Also, the Emotiv EPOC+ headset can detect different facial
expressions such as blink, wink, furrow, and laugh. Moreover, the Emotiv EPOC+ headset
has gyroscope which provides information about head movements.
The EMOTIV Inc. company has released three types of headsets: Emotiv EPOC+,
Emotiv EPOC, and Insight. The Emotiv Insight is a five channels portable device allows the
user to capture and understand the the brain activity in real-time. With the Emotiv Insight,
the user can optimize his/her cognitive performance and monitor mental health and fitness.
The Emotiv EPOC+ is the updated model of EPOC headset. Both headsets have 14 channels
around the head, plus 2 reference channels in CMS/DRL configuration. The EPOC+ headset
has more features than the EPOC headset. The EPOC+ headset has seven more axis inertial
motion sensors than EPOC headset and allows additional motion/positional tracking and
monitoring. In addition, the EPOC+ headset provides Bluetooth that allows the users to
connect the headset to their PC or mobile device in additional to the EPOC dongle. More
details can be found in Table 2.1. Comparing to other commercial EEG recording devices
available on the market such as Insight, NeuroSky, the Emotiv EPOC headset is the best

17

commercial EEG device in terms of usability according to a comparative study that has been
done by Stamps and Hamam [62].

(a) Emotiv EPOC+ Headset.

(b) Electrodes position

Figure 2.7. Emotiv EPOC+ headsets and its electrodes location
Table 2.1. EPOC+, EPOC, and Insight headsets with their features [16].
Feature
EPOC+
EPOC
Insight
Sensor Count
14+2 references
14+2 references
5+2 references
Frequence
0.16 – 43 Hz
0.16 – 43 Hz
0.5 – 43 Hz
Response
Connectivity Proprietary 2.4GHz Proprietary 2.4GHz Proprietary 2.4GHz
wireless, Bluetooth
wireless
wireless, Bluetooth
Resolution
14 bit or 16 bit
14 bit
14 bit or 16 bit
per channel
per channel
per channel
Sensor
Saline soaked
Saline soaked
Long life semi-dry
Technology
felt pads
felt pads
polymer
Pricing
$799
$200 - $500
$299

18

2.6. OpenViBE Software
OpenViBE is an open-source software platform written in C++ for designing and testing
BCIs in real-world and in virtual environment. The first version of the OpenViBE was
released in 2009. The main purpose of the OpenViBE platform is to design different scenarios
for brain-computer interfaces applications such as P300 speller. There are many free opensource software packages that have been utilized in BCI applications, such as BioSig [59],
BCI2000 [57], CEBL [29], etc. The OpenViBE software has several features that make it
unique among the existing softwares [55]. These features are summarized in the following
points:
• The OpenViBE software has different modules, and each module has a particular
function. For example, ”Acquisition client box” which is used to import the recorded
EEG data from the headset and then distribute it into the scenario. Other modules
can be used for signal processing and visualization. Connecting these modules in a
particular way allows the users to design and implement different scenarios to test
a specific BCI application based on their needs.
• Most of the BCI platforms are required to be run by specialists since it requires
more knowledge of the brain process or programming skills. On the contrary, the
OpenViBE platform is appropriate to be used by different types of users.
• The OpenViBE platform can be run independently from other software and hardware.
• Connection with virtual reality (VR) environment.
• Several predefined scenarios for common BCI applications have been designed in the
OpenViBE software such as BCI based on P300, BCI based on SSVEP, and BCI
based on motor activity which are ready to be used.
19

• The OpenViBE software is a free and open-source software and can be operated on
Windows and Linux.

2.7. Related Work
The Emotiv headset is designed mainly to allow the user to play video games by merely
thinking. Today, much reaserch has utilized the Emotiv headset in different BCI applications
[10][49][43]. In addition, much research has been focused on providing the disabled people
alternative ways of communication and control just by their thoughts. However, there is
limited amount of studies that used Emotiv EPOC headset to record the P300 waves from
the brain. In this section, a critical review of the research is presented that has used Emotiv
EPOC headset or recorded P300 waves by using other headsets.
Campbell et al., [10] discovered a new way to control a mobile phone without using
voluntary muscles. They used Emotiv EPOC headset to acquire P300 waves from the brain.
Nine photos of contacts from the address book are displayed on an iPhone and flashed
randomly, and the user has to focus his/her attention on the photo of the person to be
contacted. After 300 ms, a P300 wave is generated and transmitted wirelessly to the iPhone
then the phone number is automatically dialed. To evaluate the system, they tested the
wink and think modes in a variety of scenarios (e.g., sitting, walking). In the winking mode,
the user generates EEG signals different than P300 signals. The classifier performed well
on data collected for sitting-relaxed scenarios (95.58%). While the users achieved accuracy
of 92.58% when they were walking. The subjects used the same application when they are
in different situations: sitting, sitting with loud background music, and standing up. The
data were averaged over a set time interval (20 s, 50 s, 100 s). The results showd that the
accuracy increased as the time interval increased.
20

Similarly, English et al., [22] proposed a new framework named ”EyePhone” which can
help paralyzed people to control a cell-phone by their eyes. They used the Emotiv headset
to detect EOG signals so that the user can control the mobile phone. The researchers conducted experiments in various settings to evaluate the efficacy and efficiency of the developed
prototype. The users were able to control mobile phone through eye or facial movements
with accuracy between 100% and 93%.
The P300 waves have been used to control an internet browser [47]. Three individuals
with ALS and 10 healthy volunteers participated in the study. The user executed different
browser functions: navigation (forward, back, reload, and home), data form entry, address
bar entry, and scroll up and scroll down. These functional options are presented in a 8x8
matrix in BCI2000. The P300 waves were averaged across 270 trials. In this study, stepwise linear discriminant analysis (SWLDA) was performed to classify the target and nontarget samples. The ALS patients achieved an average accuracy of 73% and a subsequent
information transfer rate (ITR) of 8.6 bits/minute. The healthy participants achieved over
90% accuracy and an ITR of 14.4 bits/minute.
Münßinger et al. [49], created a new BCI application, P300-Brain Painting, that allows
paralyzed people to create expressions which is another way of communication. The signals
were acquired from Cz channel and band-pass filtered between 0.1 to 30 Hz. A 6 x 8 matrix
contains letters of the German alphabet, numerals 0–9 and some additional punctuation
marks was used. In this study, 380 trials were averaged across all subjects for targets and
4560 trials for non-targets. The patients with amyotrophic lateral sclerosis (ALS) achieved
accuracy above 89%.
Some comparative studies have been done between Emotiv headset and other EEG headset devices. Duvinage et al., [20] compared the performance of Emotiv headset in a P300 BCI

21

with the performance of a medical device, the ANT system. A 2 x 2 matrix was presented
to the user. Each row/column is flashed 12 times per trial. The results showed that the
performance of ANT system is better than the performance of Emotiv headset. Nevertheless,
the study suggested that the Emotiv headset can be used just for non-critical applications
such as communication systems and games due to its lacking of reliability.
Another study [45] compared the performance of extraction event related potentials
(ERPs) between Emotiv headset and six traditional EEG disc electrodes. The performance
of Emotiv headset is worse than the performance of the six traditional EEG disc electrodes
as the study showed. Badcock A. et al., [4] used the Emotiv headset to record auditory ERPs
from 21 adults and compared it with Neuroscan EEG system. The P300 response averaged
over around 600 stimuli. The results suggested that the Emotiv headset can be utliized as
an alternative system to record auditory ERPs.
Zach Cashero [11] did a comparison of three blind source separation (BSS) algorithms:
independent component analysis (ICA), maximum noise fraction (MNF), and principal component analysis (PCA). These techniques are useful in extracting the P300 source information
from the background noise. The main goal of Zach’s work was to compare ICA with MNF
and PCA and study the effect of adding temporal information to the original data. Two
different datasets were used in the study. Dataset A was recorded using a 64-electrode cap
and contains 2550 target trials. Dataset B was recorded using the Biosemi active electrode
system and contains 540 target trials. The results showed that using BSS techniques improved the classification accuracy. However, the results showed no difference between the
three BSS methods. The results also suggested that adding temporal information to the
original data reduces the classification accuracy.

22

CHAPTER 3

Methodology
3.1. Data Acquisition
The EEG signals were acquired using Emotiv EPOC+ headset from all 14 channels (AF3,
AF4, F3, F4, FC5, FC6, F7, F8, T7, T8, P7, P8, O1, O2). The EEG signals were recorded
and sent to the OpenViBE software wirelessly via a USB dongle. The EEG signals were
sampled at 128 Hz, therefore a sample is taken approximately every 8 ms. Sampling the
data at 128 Hz provides enough samples for the frequency ranges of the four frequency bands,
which contain the valuable ERPs information, (Nyquist rate = 128/2 = 64 Hz) [40][51][39].
The user was seated in front of a computer screen. A 6x6 or 3x3 matrix size was presented
to the user during the experiment. The user was instructed to focus his/her attention to the
letter they wished to spell. In addition, the user was asked to relax and avoid unnecessary
movements.
The Emotiv EPOC+ headset was prepared before placing the electrodes on the user’s
head. One of the advantages of the Emotiv EPOC+ headset is that the preparation time
is much less than other EEG headsets. It takes about 2 – 3 minutes comparing with other
EEG headsets which required more than 10 minutes for preparation step. A few drops of
saline liquid were applied to wet the sensors and reduce the electrodes impedance. It is
important to check the contact quality before starting the acquisition step. To check the
quality of the sensors connection, we run a software called the Emotiv Xavier SDK. The
Emotiv Xavier SDK panel has many functions one of which is to provide feedback to the
user about the contact quality for each sensor on the Emotiv headset. The Emotiv Inc.
company suggests some steps to improve the contact quality when problems are detected.

23

To improve the contact quality, the headset should be fully charged. The Lithium battery
can be fully recharged in approximately 4 hours. In addition, more drops of saline solution
should be added on each felt. Moreover, we have to make sure that the sensors are fitted
properly and they are in contact with the head.

3.2. Participants
Five healthy subjects, four males and one female, aged 25–32, participated in the study.
All subjects’ native language was Arabic, and they were familiar with the alphanumerical
displayed during the experiment. None of the subjects had previous BCI experience before
or had a history of neurological diseases such as ALS or spinal cord injury. All participants
gave informed consent prior the experiment (see Appendix).

3.3. Linear Discriminant Analysis (LDA) Algorithm
Classification is a kind of supervised learning, using training data with known input
vectors as well as corresponding target vectors. The goal in classification is to take an input
vector x and assign it to one of K discrete classes, Ck , where k = 1, 2, ..., K [6]. In our case,
we have two classes (k=2): target and non-target. In 1936, R. A. Fisher developed the linear
discriminant analysis (LDA). The LDA is a classification method used in machine learning
to find a linear combination of features that separate two or more classes of objects [66]. In
addition, the LDA has been widely applied in different BCI applications and achieved high
classification performance [7][58][27].
Assume we have the following linear discriminant function:

(1)

y(x) = wT x + w0
24

where w is called a weight vector, x is an input vector, and w0 is a bias. If y(x) ≥ 0, the input
vector x is assigned to class C1 and to C2 otherwise. Figure 3.1 illustrates the geometry of
a linear discriminant function in two dimensions.

Figure 3.1. Illustration of the geometry of a linear discriminant function in
2-D [6].

The decision boundary is defined by the relation y(x) = 0. If x is a point on the decision
surface, the normal distance from the origin to the decision surface is given by:

(2)

wT x
w0
=−
kwk
kwk

We can see from the previous equation that w0 determines the location of the decision surface.

25

3.4. OpenViBE Scenarios
Three different OpenVibe scenarios are used in this study. Each scenario contains different modules with unique functionality for each module. These scenarios are as follow:
• P300 speller acquisition scenario.
• Training LDA classifier scenario.
• Online scenario.
Before running the scenarios, we first connect the Emotiv EPOC+ with OpenViBE platform through the acquisition server which forwards the recorded EEG signals to OpenViBE
scenarios. Once the Emotiv EPOC+ connected with OpenViBE platform, the first scenario
can be implemented. The first scenario ”P300 speller acquisition” is used as a first step to
collect some training data. These data will later be used to train a spatial filter and LDA
classifier for the online scenario. Figure 3.2 shows the ”P300 speller acquisition” scenario
and its modules. At the beginning of this scenario, the ”a” key on the keyboard has to be
pressed to start the data collection and to generate and send a specific stimulation to the
P300 speller stimulator module telling it to start the flash sequence. The recorded EEG signals are received by the acquisition client module from the Emotiv EPOC+ headset. Then,
the acquisition client module forwards the EEG signals to the other modules in the scenario.
A 6x6 matrix or 3x3 matrix (depending on the condition) is presented to the user and
the target character is highlighted by a blue color so the user knows which character he/she
should focus on. Once the ”a” key has been pressed, a specific stream of stimulation is sent
to the P300 speller stimulator module to start the generation process. Through this module,
we can adjust the intensification configurations used for the P300 speller. For example, the
number of rows, columns, repetitions, and trials can be set up using P300 speller module. In
our study, the number of trials and repetitions are fixed at 12 and 10, respectively. However,

26

the number of rows and columns are changed to create different matrix size in order to
investigate the impact of different matrix sizes on the P300 speller performance.
The flash duration is another factor that has been studied in many research. In our
study, the flash duration is selected to be 100 ms and 175 ms. The ’Target Letter Generation’
module receives stimulations from the P300 speller stimulator module and generates random
target letters according to a Lua script file. The ’Identity’ module is used for connection
purposes. The P300 speller visualization module receives sequence stimulations from the

Figure 3.2. P300 speller acquisition scenario.

P300 speller stimulator module and target stimulations from Lua stimulator module. Also,
it visualizes the P300 matrix which has letters (A-Z) and numbers (0-9). The rows and
27

columns are intensified sequentially based on the sequence and target stimulations received
by the module. All the EEG data then are saved in .ov file by ”Generic stream writer” so
they can be used in the next scenarios.
Once the EEG signals have been received by the ’Acquisition client’ module, they are
passed to ’Temporal filter’ box for filtering. The EEG signals passed to a Butterworth
bandpass filter of fourth order and the low cut frequency equal to 0.1 Hz and the high cut
frequency equal to 30 Hz because it content EEG data as Section 2.3 describes . After that,
the filtered signals are sent to two different ’Stimulation based epoching’ modules, one is for
the target characters and the other one is for the non-target characters. This module selects
part of the EEG signal at a certain event. Here, there are two events: target and non-target.
When the row or column that contains target character is intensified, this box starts to save
the signal for 600 ms since the P300 wave occurs about 300 ms after the flashing of the
desired character, and the same procedure is done for the non-target characters. To increase
the SNR, the EEG signals are averaged over time. The ’Epoch average’ module is used to
average the target and non-target signals and then send it to the ’CSV file writer’ module
to save the averaged signals. Then, we use MATLAB to read the signals from the ’CSV file
writer’ module and visualize the target and non-targets waves, as in Section 4.1.
In this research, the linear discriminant analysis (LDA) classifier is employed to classify
the target samples from the non-target samples. Figure 3.3 shows the LDA classifier training
scenario. The same steps are followed at the beginning of this scenario. The EEG data are
read by the ’Generic stream reader’ module the sent to the ’Temporal filter’ module. Next,
the ’P300 Speller Visualization’ box sends target/non-target flagging to the ’Stimulation
based epoching’ modules for target and non-target selection. Each time the row or column
that contains the target character is intensified, the target selection box stores 600 ms of

28

Figure 3.3. Training the LDA classifier scenario.
the EEG signals at this event. On the other hand, the non-target selection box stores the
signals all the time except when the row or column that has the desired letter is flashed.
The averaging step comes next to increase the signal-to-noise ratio. The averaging type
used here is epoch block average which receives streamed matrix and averages across time.
In this study, we used 10 trials for both 6 x 6 and 3 x 3 matrix. In the 6 x 6 matrix,
each row and column is flashed 12 times per trial. Therefore, this box receives 240 target
epochs and 1200 non-target epochs. In the 3 x 3 matrix, epoch block average box receives
240 target epochs and 480 non-target epochs. The averaged signals then are sent to the
’Feature aggregator’ module. This module recieves a stream of matrices containing features
29

and aggregates them to feature vectors to be used for classification. In other words, it takes
a signal in the form of a matrix, then produces corresponding vectors that can be utilized
by the Classifier/Trainer boxes.
After that, the feature vectors are sent to the ’Classifier trainer’ module which is used
to train the LDA classifier. In this step, the module performs classifier training with k-fold
cross validation which gives an estimation of the classifier accuracy. The idea of the k-fold
test is to split the data into training and testing sets then the classification algorithm is
trained on the training sets and then we evaluate the algorithm on the testing sets. The
testing is repeated k times ( we selected k=20 in this study), and then the accuracies are
averaged over the different partitions. The accuracy here gives a good prediction of how the
classification algorithm will work on the online performance.
Figure 3.4 shows the last scenario implemented is the online scenario. There are 12 paths
for the 6x6 matrix (9 paths for the 3x3 matrix) in this scenario. Each path is responsible for
a row or a column processing. Each column/row has its specific P300 detection pipeline. The
pipeline consists of several boxes. First, the ’Simulation based epoching’ box receives the
filtered EEG signals and selects a segment of a signal start when for a specific row or column
contains desired character is flashed. Then each ’Stimulation based epoching’ box sends
epoched signals to the ’Epoch average’ box to average them to enhance the P300 signals.
After that, the averaged signals are converted to feature vectors and sent to the ’Classifier
processor’ box. The ’Classifier processor’ box chooses whether the selected signal is a target
or non-target signal. Finally, the ’Voting Classifier’ box chooses which of the candidate
column or row has the P300 signal and sends the result to the ’P300 speller visualization’
module to display the result for the user. If the results are not good enough, the EEG data
recorded in this scenario are sent to the second scenario to train the LDA classifier again.

30

31

Figure 3.4. Online scenario .

31

CHAPTER 4

Results and Discussion
4.1. The Capability of Emotiv EPOC+ headset for Detecting P300 Wave
The first goal of this research is to evaluate the capability of Emotiv EPOC+ headset
to detect P300 waves. Figures 4.1 and 4.2 show the recorded responses of the subjects (S1,
S2, S3, S4, S5) to the visual stimulation during the experiment. Four different experimental
conditions are tested in this study as follow:
• 6x6 matrix size with flash duration 100ms
• 6x6 matrix size with flash duration 175ms
• 3x3 matrix size with flash duration 100ms
• 3x3 matrix size with flash duration 175ms
Figures 4.1 and 4.2 illustrate the participants’ responses from all 14 channels when a 6x6
matrix size is presented with flash duration 100 ms. The other conditions above were applied,
and participants’ responses were recorded and showed approximately the same results.
Before explaining Figures 4.1 and 4.2, it is important to understand the difference between
the two subcomponents of P300 which are P3a and P3b. These ERPs can be distinguished
according to the task that elicits them, the amplitude size (P3b is greater that P3a), and the
lobe location that generates the signal [54]. The P3a is generated from the frontal-central
areas of the brain with latency between 150 ms to 300 ms. While the P3b wave is generated
from the parietal-occipital areas with latency between 250 ms to 600 ms. Accordingly,
four channels out of 14 channels of the Emotiv EPOC+ headset are believed to be the
best channels to use of those that are available on the Emotiv system : P7, P8, O1, and
O2. Further analysis has been done in this research to investigate the most active channels

32

during acquiring P300 signal to reduce the number of channels used to capture P300 signal.
The results in Section 4.2 show that O1 and O2 are the most active channels. Hence, our
focus in this research is on these two channels.
Figures 4.1 and 4.2 below are clear evidence that prove the capability of Emotiv EPOC+
headset to detect the P300 signal. Figures 4.1 and 4.2 show two different waves: target (in
blue) and non-target (in red). The target waves are the averaged signals elicited by visual
target stimulus, while the non-target waves represent the averaged signals that elicited by
the other visual stimulus during the experiment. It can be seen from Figures 4.1 and 4.2
that the target waves (in blue) are remarkably distinguishable from the non-target wave (in
red) for most subjects. Moreover, because each human has a unique brain structure, the
response of the subject to the visual stimuli is different from one to another.
It can be noticed from Figures 4.1 and 4.2 that the response of each participant is different
from channel to another. Clearly, participant #2 respond weakly to the visual stimulus,
where the amplitude signal generated from O1 channel is 1.76 µV and the latency is 390
ms. However, the amplitude signal generated from O2 channel is 1 µV and the latency
is 429.7 ms. In contrast, the response of participant #5 to the visual stimulus was the
strongest respond compared to other participants from both channels (O1 and O2), where
the amplitude signals are 4.01 µV and 4.91 µV,for O1 and O2 channels respectively. The
amplitude of the P300 signal (especially the amplitude of the target wave) reflects how the
participant responds to the target and non-target visual stimulation and determines whether
the participant can use a P300-based BCI or not. In other words, if the user produces a
higher amplitude of the target signals, then the classifier can detect the target character
which the user is intended to spell. According to [2], 10% of the users do not produce a
distinguishable amplitude peak between target and non-target waves; therefore, they are not

33

able to use the P300-based BCI even if they increase the number of training sessions or use
more advanced signal processing methods.
Several studies have investigated the effect of the subject factors (age, gender, etc.)
as well as different stimulus characteristics on the P300 amplitude. For instance, it has
been reported that longer inter-stimulus interval (ISIs) decreases the P300 amplitude and
classification accuracy for disabled users [34]. The same study showed that healthy subjects
produced higher amplitude at the P300 peak than disabled subjects (around 2 µV for the
healthy subjects and 1.5 µV for the disabled subjects). The current study examines the
effect of matrix size, flash duration, and colors on the P300 speller performance.

34

Figure 4.1. EEG amplitude versus time at AF3, F7, F3, FC5, T7, FC6,
and F4 average over 240 trials for target letters and 1200 trials for nontarget
letters. Each plot is for 6 x 6 matrix and 100 ms flash duration. For each plot,
x-axis represents time (ms) and y-axis represents amplitude (µV). The time
length in each plot is 600 ms. The vertical line represents the time at 300 ms

35

Figure 4.2. EEG amplitude versus time at F8, AF4, T8, P7, O1, O2, and P8
average over 240 trials for target letters and 1200 trials for nontarget letters.
Each plot is for 6 x 6 matrix and 100 ms flash duration. For each plot, x-axis
represents time (ms) and y-axis represents amplitude (µV). The time length
in each plot is 600 ms. The vertical line represents the time at 300 ms

36

4.2. The Most Active Channels for P300 Wave Detection
As illustrated in Figure 2.11, the Emotiv headset has 14 channels distributed over the
scalp. One of the aims of this research is to reduce the number of channels employed in the
study and use only the most effective channels. Some studies have been shown that using a
large number of channels to acquire the brain signals is a way to increase the P300 speller
accuracy [15]. However, utilizing a large number of channels increases the system cost and
setup time. Further analysis has been done by using EEGLab toolbox, which is an open
source Matlab toolbox for processing EEG signals and other biosignals such as MEG and
ECG, and the result is shown in Figure 4.3.

Figure 4.3. The distribution of the event-related potentials (ERPs) over the
scalp of participant #1 at different time after a target visual stimulation.
Figure 4.3 shows the topographic distribution of average potential at the specified latencies (300 ms, 328 ms, 430 ms, 500 ms, 560 ms, 600 ms). As it can be seen in Figure 4.3,
the most active channels (in red) are located on the back of the brain, which are O1 and
O2 channels. In other words, O1 and O2 channels contain the strongest amplitude EEG of
those provided by Emotiv, even though central and parietal are usually found to have the
strongest P300s. This result was expected before analyzing the distribution of ERPs over
37

the scalp since these two channels are located on the visual cortex, which its function is to
receive visual information from retina and process them.
Tong J. et al. [37], designed a portable dialing system and they used Emotiv headset
to record P300 signals. In their study, they computed the averaged r-squared (coefficient
of determination) values for all participants, which gives the proportion of the variance in
the dependent variable that is predictable from the independent variable. The results then
were plotted as in Figure 4.4. The red area in Figure 4.4 represents the activated area of the
brain after a P300 visual stimulation, which are O1 and O2 channels.

Figure 4.4. The averaged r-squared values plot for all participates [37]

4.3. The effects of matrix size on the P300 speller performance
There are many variables and parameters that have to be considered when designing an
effective and accurate P300-BCI system, one of them is the matrix size. As it is stated in
Section 2.4, the P300-BCI system presents the user a matrix containing characters (letters
and symbols) and the user has to pay attention to the character he/she wants to spell.
Each row and column is flashed in a random sequence. The intersection of the row and
38

column containing the desired character (the target) is elicited P300 wave. Many studies
have investigated the effect of the matrix size on the P300 performance and improved the
matrix size to get an optimal size that makes the user communicate more effectively. Our
goal in this research is to study the impact of using different matrix size (6x6 and 3x3) on
the P300 amplitude and the online and offline accuracies.
Previous studies have shown that there is a proportionality relationship between the
matrix size and the P300 amplitude. In other words, when the probability of the occurrence
of the desired character (the target) decreases, the P300 amplitude increases, and vice versa.
In a 6x6 matrix, the probability of the occurrence of the target character is 5.56% in each
trial (we have 36 characters and each character is flashed 2 times/trial, one for row and one
for column. The target character is flashed 2 times/trial, so the probability of the occurrence
of the target character is 2/36 = 5.56%). In 3x3 matrix, the probability of the occurrence
of the target character is greater. There are 9 characters, and each character is flashed 2
times/trial, so the probability of the occurrence of the target character is 2/9 = 22.22%.
Table 4.1 and Figure 4.5 present the P300 amplitude obtained from O1 and O2 channels
for all the participants where the flash duration is 100 ms. The EEG amplitudes at O1 and
O2 averaged over 240 target letter trials and 1200 non-target trials for 6x6 matrix size, and
averaged over 240 target letter trials and 480 non-target trials for 3x3 matrix size. It can
be seen that the P300 amplitudes are larger for 6x6 matrix for all the participants. These
findings are similar to other results from different studies. Brendan Z. et al. [3], did an
experiment to assess the effect of three different matrix size ( 4x4, 8x8, and 12x12) on the
P300 speller performance. The results showed that larger matrix size produced larger P300
amplitude. In another study [61], the researchers tested two different matrix size (3x3 and

39

6x6). They found that the P300 amplitude was greater for the 6x6 matrix and the accuracy
increased when the matrix size increased.
Figure 4.6 and Figure 4.7 show the averaged offline and online accuracies for all participants across six sessions when 6x6 and 3x3 matrix size presented and the flash duration is
100 ms. The offline accuracy is an offline testing to predict the performance of the LDA
classifier (k-fold). The online accuracy is the number of correctly spelled characters divided
by the total number of characters spelled (10 letters in our study). We can see that the
matrix size has no significant effect on the offline accuracy. In contrast, the effect of the
matrix size on the online accuracy is very clear. The performance of all participants is
increased when a 6x6 matrix is presented to them except for participant #2. Participant
#2 reached an averaged online accuracy of 45% when using a 6x6 matrix and 50% when
using 3x3 matrix and this result was not surprising since participant #2 was suffering from
extreme fatigue during using 3x3 matrix size, as he reported. For the 6x6 matrix version,
participants #1,#2, and #5 were able to control the speller with 90% accuracy after four
training sessions. Participant #4 was able to spell 6 letters correctly out of 10 after three
training sessions. The lowest performance was obtained by participant #3 where he could
spell 5 letters after five training sessions.

40

(a) Participant 1, 6x6

(b) Participant 1, 3x3

(c) Participant 2, 6x6

(d) Participant 2, 3x3

(e) Participant 3, 6x6

(f) Participant 3, 3x3

(g) Participant 4, 6x6

(h) Participant 4, 3x3

(i) Participant 5, 6x6

(j) Participant 5, 3x3

Figure 4.5. EEG amplitudes at O1 and O2 averaged over 240 target letter
trials (in blue) and 1200 non-target trials (in red) for 6x6 and averaged over
240 target letter trials and 480 non-target trials for 3x3 matrix sizes. The flash
duration is 100 ms.

41

Table 4.1. EEG amplitudes at O1 and O2 averaged over 240 target letter
trials and 1200 non-target trials for 6x6 and averaged over 240 target letter
trials and 480 non-target trials for 3x3 matrix sizes. The flash duration is 100
ms.
Participants O1 channel amplitude(µV) O2 channel amplitude (µV)
6x6
3 x3
6x6
3x3
1
2.28
1.96
3.25
3.23
2
1.76
0.35
1.0
0.35
3
2.54
1.60
1.85
1.31
4
2.60
1.54
3.74
1.63
5
4.01
2.13
4.91
1.72
The performance of the participants was lower for 3x3 matrix size. Participants #1 and
#2 reached an accuracy of 70% and 80%, respectively, after 4 training sessions. Participant
#4 could not spell any letter in session #5 and the highest accuracy was 20% after 3 training
sessions. Participant #1 reached 50% after just one training session.

Figure 4.6. The average online accuracy for all participants for matrix sizes
6x6 and 3x3 with flash duration of 100 ms.

42

Figure 4.7. The average offline accuracy for all participants for matrix sizes
6x6 and 3x3 with flash duration of 100 ms.
4.4. The effect of flash duration on the P300 speller performance
The effect of the flash duration was studied in this research. One of the factors that
have been investigated and tested its affect on P300 speller performance is the inter-stimulus
interval (ISI). The inter-stimulus interval (ISI) starts from the onset of the flash of one row
or column to the onset of the flash of the next row or column [23].
The ISI has two parts: flash duration and no flash duration of the row and column. The
flash duration was manipulated in this study (either 100 ms or 175 ms) while the no flash
duration was fixed at 175 ms. This manipulation was done through P300 speller stimulator
box in OpenViBE. Participants #3 and #4 were invited to undertake more training sessions
(six sessions where the matrix size is 6x6 and flash duration is 175 ms and six sessions where
the matrix size is 3x3 and flash duration is 175). Tables 4.2 and 4.3 and Figures 4.8 and 4.9
show the results.
Tables 4.2 and 4.3 present the amplitudes of the averaged EEG amplitudes at O1 and
O2 for participants #3 and #4 at different flash duration (100 ms and 175 ms). As it can
be seen, the P300 amplitudes are increased with longer ISI for both versions of the matrix
43

size (except the amplitude obtained from O1 channel for participant #4 in 6x6 matrix).
Lawrence et al. [23] reported that longer ISI produces larger P300 amplitude. Moreover,
six adults participated in a study examining the effect of the stimulus rate (target to target
interval) [46]. Four different ISI were tested (31.25 ms, 62.5 ms, 125 ms, and 250 ms). The
results showed that the P300 amplitude is increased with larger ISI.

Table 4.2. A comparison of using different flash duration (100 ms, 175 ms)
on the EEG amplitudes for participants #3 and #4. The EEG amplitudes at
O1 and O2 averaged over 240 target letter trials and 1200 non-target trials.
The matrix size is 6x6.
Participants O1 channel amplitude(µV) O2 channel amplitude (µV)
100 ms
175 ms
100 ms
175 ms
3
2.54
2.93
1.85
3.41
4
2.60
1.94
3.74
4.16

Table 4.3. A comparison of using different flash duration (100 ms, 175 ms)
on the EEG amplitudes for participants #3 and #4. The EEG amplitudes
at O1 and O2 averaged over 240 target letter trials and 480 non-target trials.
The matrix size is 3x3.
Participants O1 channel amplitude(µV) O2 channel amplitude (µV)
100 ms
175 ms
100 ms
175 ms
3
1.60
2.48
1.31
3.33
4
1.54
1.56
1.63
3.62

44

(a) Participant #3, 100 ms
duration

(b) Participant #3, 175 ms
duration

(c) Participant #4, 100 ms
duration

(d) Participant #4, 175 ms
duration

Figure 4.8. EEG amplitudes at O1 and O2 averaged over 240 target letter
trials and 1200 non-target letter trials for 6x6 matrix size and different flash
durations (100 ms and 175 ms).

(a) Participant #3, 100 ms
duration

(b) Participant #3, 175 ms
duration

(c) Participant #4, 100 ms
duration

(d) Participant #4, 175 ms
duration

Figure 4.9. EEG amplitudes at O1 and O2 averaged over 240 target letter
trials and 1200 non-target letter trials for 3x3 matrix size and different flash
durations (100 ms and 175 ms).

45

Figure 4.10 shows the average offline and online accuracies for both participants #3 and
#4. The results show that the ISI does impact the performance of the participants. In
both participants, the online performance was better for shorter ISI (A,C). In other words,
the online accuracy increased as ISI decreased. For 100 ms flash duration, participant#3
reached an average accuracy of 23.33 %, but this accuracy dropped to 16.67 % with 175 ms
flash duration. Participant #4 as well has better performance with 100 ms flash duration
(accuracy of 25%) than 175 ms flash duration (accuracy of 23.33 %). These results are similar
to the results in [46][61]. Figure 4.10 shows that the ISI has no significant impact on the

(a)

(b)

(c)

(d)

Figure 4.10. This figure illustrates the average online and offline accuracies
for participants #3 and #4.
offline accuracy (B,D). In contrast, there are other studies have found that higher accuracy
rate can be achieve with longer ISI as in [23]. As reported in [46], the reasons behind this
difference in findings between studies are unclear.

46

4.5. The effect of using colored matrix on the P300 amplitude
When the user uses the P300 speller system, it is instructed to relax and avoid unnecessary movements to reduce the noise and so increase the SNR. However, this is considered as
a difficult task since the user can not stay in a comfortable situation for a long time. Hence,
providing a suitable and quiet environment helps the user using the P300 speller more effectively. One of the factors that makes the user feel relaxed during using P300 speller system
is the color of the matrix. The colors have different wavelengths which affect our brain,
especially the visual cortex. Researchers have found that the colors that have cool shades
such as green and blue can make us feel relaxed and aid our concentration [67].
The current study investigated the impact of using colored matrix on the amplitude of
the P300 wave. We did not investigate the effect of using colored matrix on the accuracy
because it requires using the previous OpenViBE scenarios again. No one of the participants
was able to participate in more training sessions. However, participants #1,#2 and #3
were invited to use P300 speller system with colored matrix instead of a conventional P300
speller system which presents white/black matrix to the user. This experiment takes about 5
minutes. Figure 4.11 shows the P300 amplitudes for participants #1,#2, and #3 when using
a conventional (white/gray) and colored (green/blue) P300-BCI speller paradigm. According
to the results in Section 4.2, the most effective channels in the P300-BCI system are located
on the occipital lobe of the brain which are O1 and O2 channels, so we tested the effect of
the colored (green/blue) matrix on the P300 signals obtained from these two channels.
In Figure 4.11, participants #2 and #3 produced higher P300 amplitudes from O1 channel when a white/gray matrix was presented to them during the experiment. In contrast,
the P300 amplitude for participant #1 from O1 channel was higher under the green/blue
condition (colored matrix). This fluctuation in the results suggests that the effect of using

47

a colored matrix is unclear and can be different from one person to another. The results
are surprising since the O1 channel is located on the left hemisphere of the brain as Figure
2.11 (B) shows. In addition, various studies have investigated which part of the brain has
the function of colors recognition. The results show that the colors processing is associated
with the right hemisphere [56][5]. Our results in Figure 4.11 suggest that O2 channel, which
is located on the right hemisphere, involved in color processing. For all the participants,
the P300 amplitudes obtained from O2 channel are higher under the green/blue condition
than under the white/gray condition. At the end of the experiments, all the participants
reported that using a colored matrix (green/blue) was more comfortable for their eyes and
made them focus and concentrate on the desired characters more than using a conventional
matrix (white/gray).

(a) Participant 1

(b) Participant 2

(c) Participant 3

Figure 4.11. P300 amplitudes for participants #1,#2, and #3 when using a conventional (White/Gray) and colored (Green/Blue) P300-BCI speller
paradigm.

48

4.6. Exploring the significance of the Number of Training Sessions
The number of training sessions required to allow the user to use the P300-BCI system
daily with an effective and accurate performance is explored in this study. It is a difficult
task for a user to use the P300-BCI system as a communication tool with just one training
session especially if the user has not had BCI experience before. However, 100 subjects
participated in a study to test a P300-based BCI system to spell a 5-character word with
only 5 min of training. The results showed that 72% of the subjects achieved 100% accuracy
after only 5 minutes of training [30].
Figure 4.12 depicts the online accuracy for the participants during six training sessions
under four different conditions. In the 6x6 matrix and 100 ms flash duration (A), participants
#1,#2, and #5 reached 90% accuracy after four training sessions. The best performance
for participant #4 was after three training sessions (60%). The same amount of training
sessions was done by participant #3 who reached 50% accuracy. In the second condition, 3x3
matrix and 100 ms flash duration, all the participants did six consecutive training sessions.
The results of the online accuracy are shown in (B). We can see that participants #2,#4,
and #5 achieved the best performance after three training sessions (80%, 20%, 40%). For
participant #3, he reached 50% accuracy after 5 sessions of training but then the accuracy
dropped sharply to 10% in the next session. Lastly, for this condition, four training sessions
were enough for participant #1 to acheive accuracy of 70%.
To investigate the effects of the variation of the flash duration on the online accuracy,
participants #3 and #4 were invited to participate in two different conditions (6x6 matrix
and 175 ms, 3x3 matrix and 175 ms). It can be seen from (C) and (D) that each participant
reached the best performance after doing different number of training sessions. In (C),
participants #3 and #4 achieved the highest online accuracy (30% and 50%, respectively)

49

after 3–4 training sessions. Similarly in (D), participant #3 reached 20% accuracy after 4
training sessions while participant #4 needed just three training sessions to achieved 50%
accuracy.
To conclude, we can see from the results in Figure 4.10 that three to four training sessions
are sufficient to get high online accuracy depends on the user’s performance. It is the fact
that in this study none of the participants reached 100% accuracy and this might be due
to many factors such as the limitation of the number of the training sessions (six training
sessions), signal quality, or electrodes placement. Some users may need more training sessions
to adapt with P300-BCI speller system and consequently they can not use it accurately and
effectively when they do few training sessions. One of our goals in the future is to minimize
the required number of training sessions by using more advanced signal processing techniques
and more advanced classification algorithms.

50

(a) 6x6 100 ms

(b) 3x3 100 ms

(c) 6x6 175 ms

(d) 3x3 175 ms

Figure 4.12. This figure illustrates the online accuracy for all participants
in each training session

51

CHAPTER 5

Conclusion and Future Work
The aim of the BCI field is to provide the people with severe neuromuscular disorders
a new augmentative communication technology so that they can express their wishes and
communicate with others. That can be done by recording the EEG activities from the scalp
and then translate them into commands that operate a certain device allows a person to
communicate with the external world. Different EEG signals can be recorded from the scalp
include P300 signal, mu rhythm, etc. In this study, we are interested in capturing the P300
signal and use it in one of the P300-BCI application called P300 speller. In this thesis, the
P300 signals were recorded from five subjects using non-invasive commercial and affordable
EEG headset namely Emotiv EPOC+. The capability of the Emotiv EPOC+ of detecting
the P300 signals was studied in this research.
Five research questions were addressed in this research mentioned in Section 1.3. The first
point is about the structure of the brain and how it works. Section 2.1 covered information
about the brain structure and the electrical signals in nervous system. The second question
was about the feasibility of the Emotiv EPOC+ to capture the P300 waves. The results in
Section 4.1 provide evidence of capability of the Emotiv EPOC+ to detect the P300 signals
from two channels, O1 and O2. Investigating the effect of different factors (matrix size, flash
duration, colors) on the P300 amplitude and accuracy is another important point that was
addressed in question #3. The results show that when the matrix size or flash duration
increases, the P300 amplitude increases. The effect of using the colored matrix was very
clear on the O2 channel since it is located on the right hemisphere which is responsible for
color processing. The next question was about the capability of the user to use the P300

52

speller correctly. The results show that some users reached accuracy above 70% after a
certain number of training sessions. The last question in this research was about the number
of training sessions required to use the P300 speller with a high accuracy. To answer this
question, each participant did six consecutive training sessions for each condition. The results
suggest that three to four of training sessions are enough to reach highest online accuracy.
The results in this research show that when the ISI increases, the P300 classification accuracy
decreases. However, when the ISI increases, the P300 amplitude increases.
The future works are summarized in the following points:
• The performance of the P300 speller can be evaluated by measuring the accuracy or
the information transfer rate (ITR). In our thesis, we measured the accuracy of the
participants for different conditions. However, the ITR have not been calculated in
this study. One of our goal in the future is to calculate the ITR and to find a way
to increase it so we can get better performance. In 1980, Pierce defined a formula
to calculate the ITR as follows [52]:

(3)

B = log2 N + P log2 P + (1 − P )log2 (

1−P
)
N −1

where B id the ITR in bit rate, N is the number of possible targets, and P is the
probability that the target character will be selected.
• The BCIs applications mainly targeted paralyzed people to help them in their daily
life. One of the limitations of this study was to find disabled people to participate
in the experiment. In our research, all the participants are healthy and no one has
any neuromuscular disorders. In the future, we are looking to involve participants
with neuromuscular disorders in the study to get more reliable results.

53

• Another limitation of this study was to find a large number of subjects to participate
in the research. In this study, the EEG data were collected from five participants.
Increasing the number of participants is one of our goals in the future to get more
accurate and reliable results.
• In this thesis, the linear discriminant analysis (LDA) classifier was used to classify
the target and non-target samples. There are many other powerful machine learning
algorithms available and they can be used for the classification purpose. However,
the OpenViBE software provides just two classification algorithms which are LDA
and support vector machines (SVMs). Therefore, we can use the SVMs classifier
and compare the results with the LDA classifier. Furthermore, we can use software
other than OpenViBE such as Biosig or CEBL.

54

Bibliography
[1] Amjed S Al-Fahoum and Ausilah A Al-Fraihat. Methods of EEG signal features extraction using linear analysis in frequency and time-frequency domains. ISRN neuroscience,
2014, 2014.
[2] Brendan Z Allison and Christa Neuper. Could anyone use a BCI? In Brain-computer
interfaces, pages 35–54. Springer, 2010.
[3] Brendan Z Allison and Jaime A Pineda. ERPs evoked by different matrix sizes: implications for a brain computer interface (BCI) system. IEEE transactions on neural
systems and rehabilitation engineering, 11(2):110–113, 2003.
[4] Nicholas A Badcock, Kathryn A Preece, Bianca de Wit, Katharine Glenn, Nora Fieder,
Johnson Thie, and Genevieve McArthur. Validation of the Emotiv Epoc EEG system
for research quality auditory event-related potentials in children. PeerJ, 3:e907, 2015.
[5] Kylie J Barnett. Colour knowledge: The role of the right hemisphere in colour processing
and object colour knowledge. Laterality, 13(5):456–467, 2008.
[6] Christopher M Bishop et al. Pattern recognition and machine learning, vol. 1springer.
New York, (4):12, 2006.
[7] Vladimir Bostanov. Bci competition 2003-data sets ib and iib: feature extraction from
event-related brain potentials with the continuous wavelet transform and the t-value
scalogram. IEEE Transactions on Biomedical engineering, 51(6):1057–1061, 2004.
[8] Anne-Marie Brouwer and Jan BF Van Erp. A tactile P300 brain-computer interface.
Frontiers in neuroscience, 4:19, 2010.
[9] Peter Brunner, Anthony L Ritaccio, Joseph F Emrich, Horst Bischof, and Gerwin
Schalk. Rapid communication with a P300 matrix speller using electrocorticographic
signals (ECoG). Frontiers in neuroscience, 5:5, 2011.
55

[10] Andrew Campbell, Tanzeem Choudhury, Shaohan Hu, Hong Lu, Matthew K Mukerjee,
Mashfiqui Rabbi, and Rajeev DS Raizada. Neurophone: brain-mobile phone interface
using a wireless eeg headset. In Proceedings of the second ACM SIGCOMM workshop
on Networking, systems, and applications on mobile handhelds, pages 3–8. ACM, 2010.
[11] Zachary Cashero. Comparison of EEG preprocessing methods to improve the classification of P300 trials. Master’s thesis, Colorado State University, 2011.
[12] Hubert Cecotti, Bertrand Rivet, Marco Congedo, Christian Jutten, Olivier Bertrand,
Emmanuel Maby, and Jeremie Mattout. A robust sensor-selection method for P300
brain–computer interfaces. Journal of neural engineering, 8(1):016001, 2011.
[13] Febo Cincotti, Donatella Mattia, Fabio Aloise, Simona Bufalari, Gerwin Schalk,
Giuseppe Oriolo, Andrea Cherubini, Maria Grazia Marciani, and Fabio Babiloni. Noninvasive brain–computer interface system: towards its application as assistive technology. Brain research bulletin, 75(6):796–803, 2008.
[14] Pietro Cipresso, Laura Carelli, Federica Solca, Daniela Meazzi, Paolo Meriggi, Barbara
Poletti, Dorothée Lulé, Albert C Ludolph, Vincenzo Silani, and Giuseppe Riva. The use
of p300-based bcis in amyotrophic lateral sclerosis: from augmentative and alternative
communication to cognitive assessment. Brain and behavior, 2(4):479–498, 2012.
[15] KA Colwell, DB Ryan, CS Throckmorton, EW Sellers, and LM Collins. Channel selection methods for the P300 speller. Journal of neuroscience methods, 232:6–15, 2014.
[16] Emotiv company.

Comparison chart.

Available at https://www.emotiv.com/

comparison/ (2016/01/03).
[17] Damien Coyle, Girijesh Prasad, and Thomas M McGinnity. Extracting features for
a brain-computer interface by self-organising fuzzy neural network-based time series
56

prediction. In Engineering in Medicine and Biology Society, 2004. IEMBS’04. 26th
Annual International Conference of the IEEE, volume 2, pages 4371–4374. IEEE, 2004.
[18] RI Damper, JW Burnett, PW Gray, LP Straus, and Rachel A Symes. Hand-held
text-to-speech device for the non-vocal disabled. Journal of biomedical engineering,
9(4):332–340, 1987.
[19] John P Donoghue. Connecting cortex to machines: recent advances in brain interfaces.
Nature neuroscience, 5:1085–1088, 2002.
[20] Matthieu Duvinage, Thierry Castermans, Mathieu Petieau, Thomas Hoellinger, Guy
Cheron, and Thierry Dutoit. Performance of the Emotiv Epoc headset for P300-based
applications. Biomedical engineering online, 12(1):1, 2013.
[21] H Ekanayake. P300 and emotiv epoc: Does emotiv epoc capture real eeg (2010), 2010.
[22] Erik English, Alfredo Hung, Evan Kesten, David Latulipe, and Zhanpeng Jin. Eyephone:
A mobile EOG-based human-computer interface for assistive healthcare. In Neural
Engineering (NER), 2013 6th International IEEE/EMBS Conference on, pages 105–
108. IEEE, 2013.
[23] Lawrence Ashley Farwell and Emanuel Donchin. Talking off the top of your head: toward
a mental prosthesis utilizing event-related brain potentials. Electroencephalography and
clinical Neurophysiology, 70(6):510–523, 1988.
[24] KA Ferguson, G Polando, R Kobetic, Ronald J Triolo, and EB Marsolais. Walking with
a hybrid orthosis system. Spinal cord, 37(11):800–804, 1999.
[25] Christopher & Dana Reeve Foundation.

Prevalence of paralysis in the united

states. Available at https://www.christopherreeve.org/living-with-paralysis/
stats-about-paralysis (2016/02/25).
57

[26] Vaibhav Gandhi. Brain-computer Interfacing for Assistive Robotics: Electroencephalograms, Recurrent Quantum Neural Networks, and User-centric Graphical Interfaces.
Academic Press, 2014.
[27] Deon Garrett, David A Peterson, Charles W Anderson, and Michael H Thaut. Comparison of linear, nonlinear, and feature selection methods for eeg signal classification. IEEE
Transactions on neural systems and rehabilitation engineering, 11(2):141–144, 2003.
[28] Bernhard Graimann, Brendan Z Allison, and Gert Pfurtscheller. Brain-computer interfaces: Revolutionizing human-computer interaction. Springer Science & Business Media,
2010.
[29] Colorado State University BCI Group. Cebl3 software. Available at http://www.cs.
colostate.edu/eeg/main/software/cebl3l (2016/08/19).
[30] Christoph Guger, Shahab Daban, Eric Sellers, Clemens Holzner, Gunther Krausz,
Roberta Carabalona, Furio Gramatica, and Guenter Edlinger. How many people are
able to control a P300-based brain–computer interface (BCI)? Neuroscience letters,
462(1):94–98, 2009.
[31] Lindsay F Haas. Hans berger (1873–1941), richard caton (1842–1926), and electroencephalography. Journal of Neurology, Neurosurgery & Psychiatry, 74(1):9–9, 2003.
[32] Aboul Ella Hassanien and Ahm Ad T Aher Az Ar. Brain-Computer Interfaces. Springer,
2015.
[33] Bin He, Shangkai Gao, Han Yuan, and Jonathan R Wolpaw. Brain–computer interfaces.
In Neural Engineering, pages 87–151. Springer, 2013.
[34] Ulrich Hoffmann, Jean-Marc Vesin, Touradj Ebrahimi, and Karin Diserens. An efficient
P300-based brain–computer interface for disabled subjects. Journal of Neuroscience
methods, 167(1):115–125, 2008.
58

[35] Nai-Jen Huan and Ramaswamy Palaniappan. Neural network classification of autoregressive features from electroencephalogram signals for brain–computer interface design.
Journal of neural engineering, 1(3):142, 2004.
[36] Shiro Ikegami, Kouji Takano, Makoto Wada, Naokatsu Saeki, and Kenji Kansaku. Effect
of the green/blue flicker matrix for P300-based brain–computer interface: an EEG–fMRI
study. Frontiers in neurology, 3:113, 2012.
[37] Tong Jijun, Zhang Peng, Xiao Ran, and Ding Lei. The portable P300 dialing system
based on tablet and Emotiv Epoc headset. In 2015 37th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), pages 566–569.
IEEE, 2015.
[38] Jing Jin, Eric W Sellers, Sijie Zhou, Yu Zhang, Xingyu Wang, and Andrzej Cichocki.
A p300 brain–computer interface based on a modification of the mismatch negativity
paradigm. International journal of neural systems, 25(03):1550011, 2015.
[39] Ivo Käthner, Selina C Wriessnegger, Gernot R Müller-Putz, Andrea Kübler, and Sebastian Halder. Effects of mental workload and fatigue on the p300, alpha and theta
band power during operation of an ERP (P300) brain–computer interface. Biological
psychology, 102:118–129, 2014.
[40] SC Kleih, F Nijboer, S Halder, and A Kübler. Motivation modulates the p300 amplitude
during brain–computer interface use. Clinical Neurophysiology, 121(7):1023–1031, 2010.
[41] Christian A. Kothe. Lecture 1: Introduction to Modern Brain–Computer Interface Design,. Swartz Center for Computational Neuroscience, University of California, San
Diego, 2012.
59

[42] Dean J Krusienski, Eric W Sellers, Dennis J McFarland, Theresa M Vaughan, and
Jonathan R Wolpaw. Toward enhanced P300 speller performance. Journal of neuroscience methods, 167(1):15–21, 2008.
[43] Yue Liu, Xiao Jiang, Teng Cao, Feng Wan, Peng Un Mak, Pui-In Mak, and Mang I
Vai. Implementation of ssvep based bci with emotiv epoc. In 2012 IEEE International
Conference on Virtual Environments Human-Computer Interfaces and Measurement
Systems (VECIMS) Proceedings, pages 34–37. IEEE, 2012.
[44] Fabien Lotte, Marco Congedo, Anatole Lécuyer, Fabrice Lamarche, and Bruno Arnaldi.
A review of classification algorithms for eeg-based brain–computer interfaces. Journal
of neural engineering, 4(2):R1, 2007.
[45] Louis Mayaud, Marco Congedo, Aurélien Van Laghenhove, D Orlikowski, M Figère,
E Azabou, and F Cheliout-Heraut. A comparison of recording modalities of P300 eventrelated potentials (ERP) for brain-computer interface (BCI) paradigm. Neurophysiologie
Clinique/Clinical Neurophysiology, 43(4):217–227, 2013.
[46] Dennis J McFarland, William A Sarnacki, George Townsend, Theresa Vaughan, and
Jonathan R Wolpaw. The P300-based brain–computer interface (BCI): effects of stimulus rate. Clinical neurophysiology, 122(4):731–737, 2011.
[47] Emily M Mugler, Carolin A Ruf, Sebastian Halder, Michael Bensch, and Andrea Kubler.
Design and implementation of a P300-based brain-computer interface for controlling an
internet browser. IEEE Transactions on Neural Systems and Rehabilitation Engineering,
18(6):599–609, 2010.
[48] Klaus-Robert Müller, Michael Tangermann, Guido Dornhege, Matthias Krauledat,
Gabriel Curio, and Benjamin Blankertz. Machine learning for real-time single-trial
60

eeg-analysis: from brain–computer interfacing to mental state monitoring. Journal of
neuroscience methods, 167(1):82–90, 2008.
[49] Jana I Münßinger, Sebastian Halder, Sonja C Kleih, Adrian Furdea, Valerio Raco, Adi
Hösle, and Andrea Kubler. Brain painting: first evaluation of a new brain–computer
interface application with als-patients and healthy volunteers. Frontiers in neuroscience,
4:182, 2010.
[50] Anton Nijholt, Desney Tan, Brendan Allison, Jose del R Milan, and Bernhard Graimann.
Brain-computer interfaces for hci and games. In CHI’08 extended abstracts on Human
factors in computing systems, pages 3925–3928. ACM, 2008.
[51] Hélène Otzenberger, Daniel Gounot, and JR Foucher. Optimisation of a post-processing
method to remove the pulse artifact from eeg data recorded during fmri: an application
to p300 recordings during e-fmri. Neuroscience research, 57(2):230–239, 2007.
[52] John R Pierce. An introduction to information theory: symbols, signals and noise.
Courier Corporation, 2012.
[53] Gabriel Pires, Urbano Nunes, and Miguel Castelo-Branco. Statistical spatial filtering for
a p300-based bci: tests in able-bodied, and patients with cerebral palsy and amyotrophic
lateral sclerosis. Journal of neuroscience methods, 195(2):270–281, 2011.
[54] Matthew B Pontifex, Charles H Hillman, and John Polich. Age, physical fitness, and
attention: P3a and P3b. Psychophysiology, 46(2):379–387, 2009.
[55] Yann Renard, Fabien Lotte, Guillaume Gibert, Marco Congedo, Emmanuel Maby, Vincent Delannoy, Olivier Bertrand, and Anatole Lécuyer. Openvibe: An open-source
software platform to design, test, and use brain–computer interfaces in real and virtual
environments. Presence, 19(1):35–53, 2010.
61

[56] Hitoshi Sasaki, Akiko Morimoto, Akira Nishio, and Sumie Matsuura. Right hemisphere
specialization for color detection. Brain and cognition, 64(3):282–289, 2007.
[57] Gerwin Schalk, Dennis J McFarland, Thilo Hinterberger, Niels Birbaumer, and
Jonathan R Wolpaw. BCI2000: a general-purpose brain-computer interface (BCI) system. IEEE Transactions on biomedical engineering, 51(6):1034–1043, 2004.
[58] Reinhold Scherer, GR Muller, Christa Neuper, Bernhard Graimann, and Gert
Pfurtscheller. An asynchronously controlled eeg-based virtual keyboard: improvement
of the spelling rate. IEEE Transactions on Biomedical Engineering, 51(6):979–984, 2004.
[59] Alois Schlögl and Clemens Brunner. Biosig: a free and open source software library for
BCI research. Computer, 41(10):44–50, 2008.
[60] Andrew B Schwartz. Cortical neural prosthetics. Annu. Rev. Neurosci., 27:487–507,
2004.
[61] Eric W Sellers, Dean J Krusienski, Dennis J McFarland, Theresa M Vaughan, and
Jonathan R Wolpaw. A P300 event-related potential brain–computer interface (BCI):
the effects of matrix size and inter stimulus interval on performance. Biological psychology, 73(3):242–252, 2006.
[62] Kenyon Stamps and Yskandar Hamam. Towards inexpensive BCI control for wheelchair
navigation in the enabled environment–a hardware survey. In International Conference
on Brain Informatics, pages 336–345. Springer, 2010.
[63] Kazuo Tanaka, Kazuyuki Matsunaga, and Hua O Wang. Electroencephalogram-based
control of an electric wheelchair. IEEE transactions on robotics, 21(4):762–766, 2005.
[64] Jacques J Vidal. Toward direct brain-computer communication. Annual review of
Biophysics and Bioengineering, 2(1):157–180, 1973.
62

[65] Nano werk. Nanotechnology helps building a highway for nerve fibers. Available at
http://www.nanowerk.com/spotlight/spotid=10597.php (2016/09/20).
[66] Wikipedia. Linear discriminant analysis. Available at https://en.wikipedia.org/
wiki/Linear_discriminant_analysis (2016/10/20).
[67] wiseGEEK clear answer for common questions. What are the most relaxing colors?
Available at http://www.wisegeek.org/what-are-the-most-relaxing-colors.htm
(2016/03/11).
[68] Jonathan Wolpaw and Elizabeth Winter Wolpaw. Brain-computer interfaces: principles
and practice. OUP USA, 2012.
[69] Jonathan R Wolpaw, Niels Birbaumer, Dennis J McFarland, Gert Pfurtscheller, and
Theresa M Vaughan. Brain–computer interfaces for communication and control. Clinical
neurophysiology, 113(6):767–791, 2002.
[70] Jonathan R Wolpaw and Dennis J McFarland. Control of a two-dimensional movement
signal by a noninvasive brain-computer interface in humans. Proceedings of the National
Academy of Sciences of the United States of America, 101(51):17849–17854, 2004.
[71] Eric A Zillmer, Mary V Spiers, and William Culbertson. Principles of neuropsychology.
Nelson Education, 2007.

63

APPENDIX A

Informed consent form to participate in a research
project

64

65

66

