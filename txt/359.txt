Makara J. Technol. 20/1 (2016), 38-44
doi: 10.7454/mst.v20i1.3054

Analysis of Arm Movement Prediction by Using the Electroencephalography
Signal
Reza Darmakusuma1*, Ary Setijadi Prihatmanto1, Adi Indrayanto1, Tati Latifah Mengko1,
Lidwina Ayu Andarini2, and Achmad Furqon Idrus1
1. Department of Electrical Engineering, School of Electrical Engineering and Informatics, Institut Teknologi Bandung,
Bandung 40132, Indonesia
2. Computational Biology Laboratory, Nara Institute of Science and Technology, 8916-5 Takayama, Ikoma,
Nara Prefecture 630-0192, Japan
*

e-mail: reza.darmakusuma@gmail.com

Abstract
Various technological approaches have been developed in order to help those people who are unfortunate enough to be
afflicted with different types of paralysis which limit them in performing their daily life activities independently. One of
the proposed technologies is the Brain-Computer Interface (BCI). The BCI system uses electroencephalography (EEG)
which is generated by the subject’s mental activity as input, and converts it into commands. Some previous experiments
have shown the capability of the BCI system to predict the movement intention before the actual movement is onset.
Thus research has predicted the movement by discriminating between data in the “rest” condition, where there is no
movement intention, with “pre-movement” condition, where movement intention is detected before actual movement
occurs. This experiment, however, was done to analyze the system for which machine learning was applied to data
obtained in a continuous time interval, between 3 seconds before the movement was detected until 1 second after the
actual movement was onset. This experiment shows that the system can discriminate the “pre-movement” condition and
“rest” condition by using the EEG signal in 7-30 Hz where the Mu and Beta rhythm can be discovered with an average
True Positive Rate (TPR) value of 0.64 ± 0.11 and an average False Positive Rate (FPR) of 0.17 ± 0.08. This
experiment also shows that by using EEG signals obtained nearing the movement onset, the system has higher TPR or a
detection rate in predicting the movement intention.

Abstrak
Analisis Prediksi Gerakan Tangan menggunakan Sinyal Elektroensefalografi. Berbagai pendekatan teknologi telah
dikembangkan untuk membantu mereka yang menderita kelumpuhan dalam melakukan aktivitas kesehariannya secara
mandiri. Salah satu teknologi tersebut adalah Brain-Computer Interface (BCI). Sistem BCI menggunakan elektroensefalografi (EEG) yang dihasilkan dari aktivitas mental seorang subjek sebagai masukan, dan mengubahnya menjadi
perintah. Beberapa percobaan sebelumnya telah menunjukkan kemampuan sistem BCI untuk memprediksi gerakan sebelum
gerakan tubuh aktual terjadi. Penelitian tersebut memprediksi gerakan yang akan terjadi dengan membedakan data pada
kondisi rest, di mana tidak ada intensi gerakan, dengan kondisi pre-movement, di mana terdapat intensi gerakan sebelum
gerakan aktual terjadi. Penelitian ini dilakukan untuk melakukan analisis sistem yang dihasilkan dari pembelajaran,
yang kemudian diterapkan pada data dengan interval waktu kontinu, antara 3 detik sebelum gerakan terdeteksi sampai 1
detik setelah gerakan sebenarnya terjadi. Hasil percobaan menunjukkan bahwa sistem dapat membedakan kondisi premovement dan kondisi rest dengan menggunakan sinyal EEG pada frekuensi 7-30 Hz di mana letak Mu dan ritme Beta
dengan nilai rerata true positive rate (TPR) sebesar 0.64 ± 0.11 dan rerata nilai false positive rate (FPR) sebesar 0.17 ±
0.08. Hasil percobaan juga mampu menunjukkan bahwa penggunaan sinyal EEG yang dekat dengan terjadinya gerakan,
membuat sistem dapat mendeteksi intensi gerakan dengan nilai TPR atau tingkat deteksi gerakan semakin tinggi.
Keywords: brain-computer interface, electroencephalography, FPR, pre-movement intention, TPR

does this regulatory function by sending millions of
electrical signals, through the nervous system, to the
targeted part of our body both consciously and unconsciously. This occurs continuously and the result can

1. Introduction
Our brain has a vital function of coordinating and
regulating various systems and organs in our body [1]. It
38

April 2016 | Vol. 20 | No. 1

Analysis of Arm Movement Prediction by Using the Electro 39

be seen in our daily activity, such as when we are
walking or grabbing using our limbs. However, not all
coordination of the brain can be delivered to other organs
or limbs optimally. In various cases, transmission through
the nerve might be distorted or even be outright disrupted
due to damage in certain parts of the nerve system. This
disruption can be caused either by diseases or accidents.
This condition is commonly perceived as paralysis.
Those with this condition will have one or more body
part which cannot be moved according to their will.
Many researchers have presented various technological
approaches to help those people who are unfortunate
enough to be afflicted by paralysis in overcoming their
limitation and performing their daily life activities
independently. One of the proposed technologies is the
Brain-Computer Interface (BCI). The BCI system uses
electroencephalograph (EEG or a brainwave signal) as an
input, which is generated by the subject’s mental activity
and it is converted into commands [2]. By associating
these commands with a series of actions to be done by
an assistive system, the subject (or in this case, the patient)
can be leveraged by mechanical and electrical assistance
to perform communications and activities independently.
Figure 1 illustrates a common configuration of a basic
BCI system.
If we take a deeper look towards the driving force
behind the BCI system, which is the EEG signal, we
will notice that there exist several different types of
brain waves; the Alpha rhythm, Beta rhythm, Theta
rhythm, and Delta rhythm. The Alpha rhythm is a brain
wave with a frequency ranging between 8-13 Hz [3],
while the Beta rhythm has a frequency range of 13-30
Hz [3]. In addition to those waves, researchers also
found a rhythm which is closely related to the voluntary
movement, which they dubbed as the Mu wave [4].
The Mu rhythm is defined as a brain wave having a
frequency ranging between 8 and 13 Hz and could be
measured at the motoric and sensory cortex area. Mu
rhythm can be measured in the sensory-motoric cortex
area, while a subject is not accessing the motoric or
sensory nerves, or in other words while the subject is
idle [4]. Some experiments have shown that Mu and
Beta rhythms attenuate when the subject accesses the
motoric or sensory nerves [4]. This phenomenon is
called Event Related Desynchronization (ERD) [4].

Figure 1. Basic BCI System

Makara J. Technol.

After the movement is completed and the subject no
longer performs activities associated with sensory or
motor nerves, the amplitude of the Mu and Beta rhythm
bounce back. The increasing phenomenon of Mu and Beta
rhythm amplitude is called Event Related Synchronization
(ERS).
The ERD phenomenon has been used as features in several
experiments associated with movement. Experiments
conducted by Lew et al. [5] and Maoz et al. [6] have
proven that when using an invasive EEG, the signal will
decrease in amplitude before the movement is onset.
Moreover, Pirez et al. [7], Lew et al. [5] and Planellas et
al. [8] have shown that non-invasive EEG signal can be
used to detect pre-movement before the movement is
onset, also by detecting the ERD phenomenon. All of
the above experiments were conducted using the selfpaced (asynchronous) method, where the subject was
given the liberty to move his arm at his own pace within
a specific time interval. An experiment conducted by Pirez
et al. [7] has shown that by using Readiness Potential
[10] and ERD as features (where is the subject?) could
make the system have accuracy of up to 96% for
predicting the left or right finger movement before the
actual movement is onset. Lew et al. [5] used the ERD
phenomenon in the time domain as features, while
Planellas et al. [8] used the same phenomenon in the
frequency domain to extract its features based on power
spectral by using Fast Fourier Transform (FFT). Both
Lew et al. [5] and Planellas et al. [8] show that BCI can be
used to predict the pre-movement by using movement
intention from the EEG signal with average accuracy up
to ±99%, for invasive measurement, and ±71%, for noninvasive measurement.
Another result which was also shown in the experiment
conducted by Lew et al. [5] and Planellas et al. [8] is the
ability of the system to detect the pre-movement intention
during “rest” condition. Ideally, for safety reason, the
movement intention during “rest” should not be utilized;
however, the result of their experiment shows that the
system was able to detect movement intentions during
“rest” from 10% to 30%.
Lew et al. [5] tested the system in detecting continuous
data 1 second before an auditory cue appears until 2
seconds after the cue appears. From their experiment, it
can be shown that the prediction of movement intention
at “rest” condition is below the random level. As it has
been proven that by using the ERD phenomenon in time
domain [5], classification can be done between the
movement intention condition interval or “rest” condition
interval; hence, this experiment aims to evaluate the arm
movement prediction by using the same phenomenon in
the frequency domain with the Burg’s autoregressive
(AR) method and Support Vector Machine (SVM) before
actual movement onset. This experiment also evaluates
the implementation of system pattern recognition in
April 2016 | Vol. 20 | No. 1

40 Darmakusuma, et al.

continuous time, from 3 seconds before the movement
onset until 1 second after the movement onset by using
a non-invasive EEG, in order to see the dynamics of
system’s decision (detection rate) in predicting the arm
movement.

2. Experiment
This experiment was done using the self-paced method
[5-8]. We illustrate the block diagram of this system
which is used in the experiment in Figure 2.
Data from three healthy male subjects with an average of
(30.3±2.5) years of age were obtained. The experiment
was done to acquire EEG signals from each subject in 3
runs (sessions). Each run contains 50 epochs. Figure 3
illustrates the timing diagram for each epoch in the
experiment. Each subject is allowed to move his arm
only during “arm movement” interval. The system will
display a “+” symbol to indicate that each subject is in
the “rest” interval and a “.” symbol to indicate that the
subject in “arm movement” interval. Each subject is
requested to move his arm voluntary as fast as he can
during the “arm movement” interval and to do nothing
during the “rest” interval.

Two active applications had to be used in order to
obtain the EEG signals. TestBench [9] was used by the
system to acquire the EEG signal. The system also gives
visual feedback to the subject through another application
called Visual Stimulation Application (VSA). The VSA
gives the subject visual cues to indicate the time interval
(“idle”, “rest”, and “arm movement”) in order to facilitate
the self-paced experiment methodology. The system
detects actual arm movement using a button located
under the palm (normally-open-switch configuration).
The button sends the movement’s acknowledgement to
VSA via a mouse click event. This button is built by using
a mouse platform. The system sends all the metrics
(“idle”, “rest”, “arm movement” interval, and actual arm
movement acknowledgement) from VSA to TestBench
via virtual serial (RS-232) protocol at 115200 bit/second
(bps), with 8-bit of data, 1 start bit, 1 stop bit, and using
no handshake.

Emotiv [9] is used to obtain the EEG signal with a
sampling frequency of 128Hz. It has a resolution of 14bits with the Least Significant Bit (LSB) having a
voltage of 0.51 microvolt.
Emotiv collects 14 channels of the EEG signal on AF3,
AF4, F3, F4, FC5, FC6, F7, F8, T7, T8, P7, P8, O1, and
O2. Since the movement correlates with neuron at
sensory-motoric area [4], the electrodes on position
AF3, AF4, F3, F4, FC5, FC6, F7, F8, T7, and T8 move
near the sensory motoric area.

Figure 2. Block Diagram of Experiment the System

Visualization

+

Figure 3. Time Diagram of Data Selection. RT Indicates the Arm Movement Onset

Makara J. Technol.

April 2016 | Vol. 20 | No. 1

Analysis of Arm Movement Prediction by Using the Electro 41

Data selection. In general, all of the data are divided
into 2 classes or conditions, “rest” and “pre-movement”.
The “rest” condition is the condition where there is no
movement intention. On the other hand, the “premovement” condition is a condition where a subject has
movement intention.
Data during the “rest” interval are taken one second after
the “rest” mark appears. This consideration is taken to
avoid the response of the EEG signal that arises when
the subject sees the visual stimuli which appear on the
screen [5,8]. The “rest” condition is processed using a 1
second (128 samples) window which is taken from the
data between 1 to 3 seconds after the “rest” mark appears.
By shifting the data every 125 milliseconds (875 milliseconds overlap), for the “rest” class, we will have 8
pieces of data per second for each channel (16 pieces
data per epoch).
Previous research conducted by Shibasaki and Harlett
[10], Lew et al. [5], and Planelles et al. [8] shows that
movement intention can be detected up to 2 seconds
before the movement is onset. The data of “pre-movement’
which were taken for this class are the data from 1.5
seconds before the subject movement was detected by
the system until the movement was detected by the system.
Similar with the “rest” condition, the “pre-movement”
class data were taken with a 1 second length window.
The class “pre-movement” is obtained by shifting every
125 milliseconds, which starts from 1.5 seconds before
the movement is detected giving 5 pieces of data of
“pre-movement” class per epoch.
Aside from the “rest” and “pre-movement’ class, this
experiment also captures the “continuous” class which

is taken from 4 seconds before until 1 second after the
movement onset. These data were then used for a
probability density analysis on the pre-movement which
is predicted using a model system which is generated
from pattern recognition drawn from “rest” and “premovement” class. This “continuous” data selection is
illustrated by Figure 4.
EEG signal processing. This experiment leverages the
capability of the Common Average Reference (CAR) as
a spatial filter in order to estimate and increase Signal to
Noise Ratio (SNR) of the EEG signals from all channels.
CAR equation is shown in Eq. (1) where Xi is an
estimate of the EEG signal on channel i, xi is the
measured EEG signal on channel i, N is the number of
channel used in the calculation, and xj is the measured
EEG signal on channel j.
1
N

Xi (t ) = xi (t ) −

N

∑ x (t )

(1)

j

j =1

Butterworth Band Pass Filter (BPF) with a passband
range of 7-30 Hz was used as a temporal filter. The
frequency range was chosen because the Mu rhythm and
the Beta rhythm were said to be located in the
mentioned frequency range [8]. This range also will
reduce the artefacts in the EEG signals caused by visual
stimulation response from the displayed cue marks.
P( f ) =

σ 2T
p

(2)

2

1 + ∑ ai e− j 2πfT
i =1

Visualization

+

Figure 4. Continuous Data Selection. RT Indicates the Arm Movement Onset

Makara J. Technol.

April 2016 | Vol. 20 | No. 1

42 Darmakusuma, et al.

The pattern recognition system uses Power Spectral
Density (PSD) features which are calculated using a 6th
order Autoregressive (AR) Burg filter [11] as features.
This method was chosen because it is suitable to be used
for small data samples, giving a high resolution, and clear
spectral values [11]. The equation for calculating the
PSD of the EEG signal is shown in Eq. (2). The system
uses the Coefficient of Determination (r2) for channel
and frequency selection of features [4], while Support
Vector Machine (SVM) with Radial Basis Function
(RBF) as kernel is used as the pattern recognition method.
Analysis and performance. The performance of this
experiment is evaluated by using two metrics, True
Positive Rate (TPR) and False Positive Rate (FPR). The
TPR value indicates the system performance in correctly
identifying movement intention; it is quantified by
calculating the number of “pre-movement” occurrence
correctly classified as “pre-movement” by the system,
compared to the actual number of the intentions of “premovement” performed by the subject, as shown in Eq. (3).
Meanwhile, the FPR value indicates the number of
misclassification done by the system; it is quantified by
comparing the number of “rest” condition occurrences
which were wrongly classified as “pre-movement”
condition with the actual number of “rest" condition
occurrence during the experiment, as shown in Eq. (4).
Since the data from each class are limited, to calculate
the TPR and FPR we first did a 3 fold cross-validation
to the data, and we assume that the result of the cross
validation is equal to 1 fold [8].
TPR =

∑ pre − movement det ected
all
∑ pre − movement in test data

FPR = ∑

rest det ected as pre − movement
∑ all rest in test data

(3)

(4)

3. Results and Discussion

Channel and frequency were used as features to
discriminate between the “pre-movement” condition and
the “rest” condition. They were selected by using the
Coefficient of Determination (r2). Figure 6 illustrates
the value of r2 from channels AF3, AF4, F3, F4, FC5,
FC6, F7, F8, T7, and T8 which move near the sensory
motoric area. We can see that the value has the highest
value at channel F8 and frequency 22-24Hz. Based on
the value, we use PSD Alpha and Beta from channel F8.
Table 2 shows the result of the system in detecting the
“rest” and “pre-movement” condition by using SVM with
the Radial Basis Function (RBF) kernel.
From the results shown in Table 2, we can see that the
system can correctly predict the “pre-movement” condition
with the TPR value 0.64 ± 0.11. On the other hand, the
misclassification of the “rest” condition to the “premovement” condition is 0.17 ± 0.08. This experiment
produces an FPR of ±17% which is slightly lower from
the FPR result shown by the experiment conducted by
Planellas et al. [8] which was at ±30%. Based on this
result, we should consider seriously the implementation
of the BCI systems in real application.
Since Table 2 shows the system’s prediction only from
two different time intervals (“rest” and “pre-movement”),
a “continous” time interval was also tried. This implementation will decribe the “pre-movement” intention
prediction phenomenon in continuous time interval from
3 seconds before until 1 second after movement is onset.
Figure 7 illustrates the result of the prediction system in
the “continuous” time interval.
In Figure 7, the system predicts the movement intention
every 125 ms. We can see that the system gives higher
prediction of the movement intention when the data
used are the data which are close in time to the actual
movement onset. This prediction phenomenon in the
continuous time interval is very interesting since the
prediction of movement intention at 3 seconds before
Table 1. Total Epoch in Each Run

The experiment did not use all epoch which was acquired
from the measurement. This decision is made because
there were times when the subject did not move during
“movement” intervals. Table 1 shows the total epoch in
each run from each subject. This experiment also reduces
the EEG channels from 14 to 8 channels that are near the
sensory-motoric area (F3, F4, FC5, FC6, F7, F8, T7, T8).
The example of power spectral density of EEG signal in
“pre-movement” and “rest” condition by using the AR
method can be seen in Figure 5. Although Planellas et
al. [8] state that ERD phenomenon occurring in the Mu
rhythm and Beta rhythm is not easy to find, this
experiment has shown that the ERD phenomenon occurs
mainly at the Beta rhythm.
Makara J. Technol.

No
1
2
3

Subject
A
B
C

Run 1
50
49
50

Run 2
50
49
49

Run 3
50
46
48

Table 2. System Performance Metric Measured during
the Experiment
No
1
2
3

Subject
A
B
C
Mean

TPR
0.65 ± 0.09
0.64 ± 0.15
0.64 ± 0.08
0.64 ± 0.11

FPR
0.14 ± 0.04
0.18 ± 0.16
0.19 ± 0.03
0.17 ± 0.08

April 2016 | Vol. 20 | No. 1

Analysis of Arm Movement Prediction by Using the Electro 43

(a)

Figure 7. System’s Decision Rate from 3 Seconds before
Actual Movement Onset until 1 Second after
Actual Movement Onset

(b)

actual movement onset until 1.5 seconds before actual
movement onset has a detection rate of around 0.2. If
we assume that the mentioned time interval is the “rest”
condition, it can be assumed to be the FPR. By comparing
the FPR value from the “rest” condition in the “rest”
interval and the FPR value from the “rest” condition in
the continous interval, we conclude that the difference of
false prediction of the two conditions is not significant
(p > 0.05).

4. Conclusions

(c)
Figure 5. PSD of the “Rest” Condition (Solid) Compared
to the “Pre-Movement” Condition (Dash) from
Subject B at Channel F8 (a) Run 1 (b) Run 2 (c)
Run 3

This experiment evaluates the movement prediction
phenomenon at the continuous time interval by using the
non-invasive EEG signal with AR and SVM methods.
From this result, the false prediction of movement
intention in the continuous time interval compared to
false prediction of movement intention in the “rest”
interval is not significant (p > 0.05). On the other hand,
this experiment shows that the system has higher
accuracy (TPR) for predicting pre-movement intention
when the system is using the signal which is close in
time to the actual movement onset. Further experiment
with a longer period in continuous time needs to be
conducted in order to see the reliability of the BCI
system in continuous time. We also consider the high
and dense brain activity during continuous long time
interval observation, which might give significant
findings to enhance the application of the EEG signal in
assistive technology, especially in the BCI system.

References
Frequency (Hz)

Figure 6. Coefficient of Determination (r2) of 8 Channels
from Subject B (Using Data Run 1 and Run 2)

Makara J. Technol.

[1] E. Widmainer, H. Raff, K. Strang, Vander's Human
Physiology: The Mechanisms of Body Function,
8th ed., McGraw-Hill, UK, 2001, p.6.
April 2016 | Vol. 20 | No. 1

44 Darmakusuma, et al.

[2] G. Garcia, Thesis, Direct Brain-Computer
Communication Trough Scalp Recorded EEG Signal,
Faculté des sciences et techniques de l'ingénieur,
Institut de traitement des signaux, Lausanne,
Switzerland, 2004.
[3] D.C. Hammond, An Introduction to Neurofeedback,
J Neurotheraphy, University of Utah School of
Medicine, 2005.
[4] G. Schalk, J. Mellinger, User Tutorial: Introduction
to The Mu Rhythm, http://www.bci2000.org, 2008.
[5] E. Lew, R. Chavarriaga H. Zhang, M. Seeck, J.R
Millan, Proceedings of 34th Annual International
Conference of EMBS, IEEE, San Diego, California,
USA, 2012, p.3280.
[6] U. Maoz, S. Ye, I.B. Ross, A.N. Mamelak, C. Koch,
Proceedings of The 26th Annual Conference on
Neural Information Processing Systems (NIPS),
Lake Tahoe, Nevada, USA, 2013, p.872.

Makara J. Technol.

[7] G. Pirez, U. Nunes, M. Castelo-Branco, Proceedings
of the IEEE 10th International Conference on
Rehabilitation Robotics, Noordwijk, Netherlands,
2007, p.569.
[8] D. Planelles, E. Hortal, A. Costa, A. Ubeda, E.
Ianez, J.M. Azorin, J Sensors, 14/10 (2014) 18172.
[9] Anon., Emotiv EPOC and TestBench Specifications,
www.emotiv.com, 2014.
[10] H. Shibasaki, M. Hallett, J Clin Neurophysiol. 117
(2006) 2341.
[11] N.J. Huan, R. Palaniappan, Brain Computer
Interface Design using Mental Task Classification,
http://csee.essex.ac.uk/staff/palaniappan/Brain%20
Computer%20InterfaceDesign%20Using%20Ment
al%20Task%20Classification.pdf.

April 2016 | Vol. 20 | No. 1

