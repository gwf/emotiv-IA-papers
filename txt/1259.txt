Neuropsychiatric Disease and Treatment

Dovepress
open access to scientific and medical research

Original Research

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

Open Access Full Text Article

Automatic epilepsy detection using fractal
dimensions segmentation and GP‚ÄìSVM
classification
This article was published in the following Dove Press journal:
Neuropsychiatric Disease and Treatment

Jakub Jirka 1
Michal Prauzek 1
Ondrej Krejcar 2
Kamil Kuca 2,3
Department of Cybernetics and
Biomedical Engineering, Faculty
of Electrical Engineering and
Computer Science, VSB ‚Äì Technical
University of Ostrava, Ostrava
Poruba, Czech Republic; 2Center for
Basic and Applied Research, Faculty
of Informatics and Management,
University of Hradec Kralove, Hradec
Kralove, Czech Republic; 3Biomedical
Research Center, University Hospital
Hradec Kralove, Hradec Kralove,
Czech Republic
1

Objective: The most important part of signal processing for classification is feature extraction
as a mapping from original input electroencephalographic (EEG) data space to new features
space with the biggest class separability value. Features are not only the most important, but
also the most difficult task from the classification process as they define input data and classification quality. An ideal set of features would make the classification problem trivial. This
article presents novel methods of feature extraction processing and automatic epilepsy seizure
classification combining machine learning methods with genetic evolution algorithms.
Methods: Classification is performed on EEG data that represent electric brain activity. At
first, the signal is preprocessed with digital filtration and adaptive segmentation using fractal
dimensions as the only segmentation measure. In the next step, a novel method using genetic
programming (GP) combined with support vector machine (SVM) confusion matrix as fitness
function weight is used to extract feature vectors compressed into lower dimension space and
classify the final result into ictal or interictal epochs.
Results: The final application of GP‚ÄìSVM method improves the discriminatory performance of
a classifier by reducing feature dimensionality at the same time. Members of the GP tree structure
represent the features themselves and their number is automatically decided by the compression
function introduced in this paper. This novel method improves the overall performance of the
SVM classification by dramatically reducing the size of input feature vector.
Conclusion: According to results, the accuracy of this algorithm is very high and comparable, or
even superior to other automatic detection algorithms. In combination with the great efficiency,
this algorithm can be used in real-time epilepsy detection applications. From the results of the
algorithm‚Äôs classification, we can observe high sensitivity, specificity results, except for the
Generalized Tonic Clonic Seizure (GTCS). As the next step, the optimization of the compression stage and final SVM evaluation stage is in place. More data need to be obtained on GTCS
to improve the overall classification score for GTCS.
Keywords: genetic programming, adaptive segmentation, SVM, fractal dimensions, EEG

Introduction
Correspondence: Kamil Kuca
Center for Basic and Applied Research,
Faculty of Informatics and Management,
University of Hradec Kralove,
Rokitanskeho 62, Hradec Kralove, 50003,
Czech Republic
Tel +420 60 328 9166
Email kamil.kuca@fnhk.cz

2439

submit your manuscript | www.dovepress.com

Neuropsychiatric Disease and Treatment 2018:14 2439‚Äì2449

Dovepress

¬© 2018 Jirka et al. This work is published and licensed by Dove Medical Press Limited. The full terms of this license are available at https://www.dovepress.com/terms.php
and incorporate the Creative Commons Attribution ‚Äì Non Commercial (unported, v3.0) License (http://creativecommons.org/licenses/by-nc/3.0/). By accessing the work you
hereby accept the Terms. Non-commercial uses of the work are permitted without any further permission from Dove Medical Press Limited, provided the work is properly attributed. For permission
for commercial use of this work, please see paragraphs 4.2 and 5 of our Terms (https://www.dovepress.com/terms.php).

http://dx.doi.org/10.2147/NDT.S167841

Powered by TCPDF (www.tcpdf.org)

Epilepsy is a form of neurological disorder manifested by seizures, which are not
linked to direct causes such as head injury or drug abuse. Epilepsy seizure is caused
by a sudden electrical discharge in the brain, which may be a result of exogenous
stimuli in case of reflex seizures or endogenous stimuli caused by chemical imbalance.
About 1%‚Äì2% of the world population suffers from epilepsy.1 Also, 25%‚Äì30% of this
group cannot be treated surgically or by drugs.2 These people suffer from so-called
‚Äúrefractory epilepsy‚Äù, and devices and methods for automatic epilepsy detection are

Dovepress

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

Jirka et al

of great importance to them and for their quality of life.3 The
most severe consequence of the epilepsy disease is sudden
unexpected death in epilepsy.3
Electroencephalography (EEG) signal processing for final
ictal, interictal activity is divided into the following steps:
1. Low pass signal filtration
2. Adaptive segmentation based on fractal dimension
3. Feature extraction and compression based on genetic
programming (GP)‚Äìsupport vector machine (SVM)
algorithm
4. Final stage SVM classification.
The most important part of signal processing for classification is feature extraction. Feature extraction is mapping
from original input EEG data space to new features space
with the biggest class separability value. Separation problem cannot be properly solved unless provided with proper
features and their relationship consideration. Scientists also
came to agreement that features are not only most important
but also a most difficult task from the classification process.
An ideal set of features would make the classification problem trivial.
In this paper, we introduce a novel method for EEG signal
classification based on the methods of GP in combination with
SVM confusion matrix, as the GP fitness function weighs for
the tree structure individual quality, which represents the
feature itself. Number of features is determined automatically
by the novel function for the best feature selection. This part
of an algorithm covers feature extraction and compression
with the best feature selection in one stage. Reduced feature
vector dimensionality also improves the performance of final
SVM classification. This novel method is tested and proven
to be more successful and effective for automatic epilepsy
detection than most of the currently presented methods.
Approximately 1/100 of people suffer from a seizure attack
once in their lifetime. The occurrence of an epileptic seizure is
unpredictable and its cause is understood very little. The EEG
signal which is used to present and test this novel algorithm
is a signal obtained from the number of (usually 128, 34, 32,
19, 14) electrodes placed on a scalp. This signal contains the
sum of electric activity produced by millions of neurons. This
signal contains not only a lot of valuable information but also
great amount of noise and useless information. Detection of
ictal activity is very important in diagnosis and therapy.4
Visual analysis of the long-term EEG recording by the
neurologist is very time consuming, and development of an
automatic epilepsy detection algorithm had been analyzed
in a number of studies.

2440

Powered by TCPDF (www.tcpdf.org)

submit your manuscript | www.dovepress.com

Dovepress

Materials and methods
Automated epilepsy detection
Since the beginning of automated epilepsy detection, this
field had developed in two main directions:
1. Interictal spike detection or epilepsy spike detection and
2. Epileptic seizure analysis.
This paper presents method from the group of automated
spike detection based on methods of GP combined with SVM
confusion matrix.

GP
GP method was developed for finding the approximate or
exact problem solution by Koza.5 GP method is based on
an individual evolution in the population tree, where every
individual represents certain solution to the problem. GP
method looks for the best solution using Darwin‚Äôs evolution
theory, where the original line of individuals (generation) is
changed and selected by means of mutation, crossover, and
natural selection.
Methods of GP were already used to improve k-nearest
neighbors classification method performance, where a decision
tree was declared for every feature, which was the function of
the feature itself.6 Methods based on GP were also used in image
processing to classify specific images.7 Another application
found its place in the new feature vector extraction that improved
the overall performance of the kNN classification method.8 GPbased methods were also used in optimal feature vector search
that improved the classification algorithm efficiency.9
The method introduced in this article creates new synthetic set of features instead of searching for the best feature
set as in the abovementioned articles.

Problem definition
The method introduced here is being developed as a part of
the complex system for environmental reflex seizure stimuli
localization using a series of sensor fusion and complex analysis methods. This complex system is a part of the dissertation
thesis ‚ÄúBiometrical data processing and analysis ‚Äì exogenous
epilepsy seizure source localization and classification‚Äù.10,11
Main motivation of this thesis and its part described in this
paper is to improve the quality of life of people suffering
from seizures and initiate development in areas of automatic
exogenous stimuli detection and localization which had been
overlooked by both scientists and doctors, and current research
state in this field is far beyond its current possibilities.
There is a clear link between environmental stimulants
and reflex seizures as described by researchers, but there is

Neuropsychiatric Disease and Treatment 2018:14

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

Dovepress

also an expressed unsatisfactory state of current research in
this area.12,13 The developed algorithm criteria were efficient in
terms of low computational cost and high classification accuracy. All the above-described issues were important to improve
the current research state in the area of automatic seizure detection in environmental stimuli localization application.
Current automatic seizure detection approaches are trading computational cost for high accuracy.14 Highly accurate
methods come with high computational cost, and highly
efficient methods used, for instance, in Brain Computer Interface come with results of lower accuracy.15 This study uses
linear machine learning method, SVM, in combination with
GP to introduce an efficient method with high classification
accuracy in automatic epilepsy detection.
Details of specific signal preprocessing, basic feature
set extraction, and implementation of this newly purposed
GP‚ÄìSVM algorithm are described in the ‚ÄúAutomatic EEG
signal segmentation using fractal dimension measure‚Äù and
‚ÄúAutomatic epilepsy classification GP‚ÄìSVM method‚Äù sections. Tests on sample of specifically selected 42 test subjects
and final evaluation of this algorithm are described in the
‚ÄúTesting‚Äù and ‚ÄúResults and discussion‚Äù sections, respectively.
The final conclusion and future work are described in the
‚ÄúConclusion‚Äù and ‚ÄúFuture work‚Äù sections, respectively.

Automatic EEG signal segmentation
using fractal dimension measure
Before the EEG signal can be analyzed, it needs to be separated into time fragments called epochs. Because this algorithm is analyzing and searching for epileptic (ictal) activity,
it is effective to use such measure for adaptive segmentation
algorithm, which performs the best in separating ictal and
interictal signal.

State of the art
The frequency and amplitude of EEG signal are highly variable.
This is given by the nature of the biological signal source itself.
The final EEG signal contains, besides useful information,
lots of biological noise (electrocardiography [ECG], electromyography, electrooculography) and artificial environmental
noise (electromagnetic disturbances). For further processing,
it is necessary to separate the signal into time segments called
epochs. There are two types of segmentations: constant with
the constant time fragment length and adaptive with variable
time fragment length changing according to the nature of the
signal. Constant segmentation is not described any further as
results of this old technique are not satisfactory.

Neuropsychiatric Disease and Treatment 2018:14

Automatic epilepsy detection

Adaptive segmentation looks for transient states in the
signal. Signal transition in the case of epileptic EEG data is
transition from interictal to ictal state.
Adaptive segmentation algorithm was first presented in
1986 by Silin and Skrylev using two sliding Fast Fourier
transform (FFT) windows. The algorithm was based on difference in the sliding window values. New segment is detected if
the difference crosses a certain threshold. This basic method
was not very effective, thanks to the non-stationary nature of
the EEG signal. This algorithm was later on updated by Varri
who used differences in signal amplitude summations in two
sliding windows.15 This algorithm became the basic algorithm
for all other adaptive segmentations. There is a whole series of
adaptive segmentation algorithms, namely, linear prediction
method, autocorrelation method, FFT, fuzzy c-means, and
fractal dimensions. Linear prediction and autocorrelation methods do not support multichannel segmentation that is required.
FFT and two-window method is not suitable for highly nonstationary epileptic signal, and fuzzy c-means method has a
high computational cost. Adaptive segmentation based on
fractal dimensions uses only this feature to separate the signal
into segments and its calculation is fast and effective.
Fractal dimension is a statistical index of signal complexity given by signal detail change to size change.16 In EEG
signal processing, the fractal dimension feature expresses
signal‚Äôs non-stationary value.
Signal‚Äôs fractal dimension is calculated using Katz‚Äôs
algorithm. When the fractal dimension value thus EEG signal
complexity crosses a certain threshold (0.4) calculated from
series of heuristically performed experiments the new signal
segment is detected.17
The fractal dimension is calculated using Equation 1,
L
where n = , L ‚Ä¶ is the total length of the curve calculated
d
as an Euclidian distance between samples and d ‚Ä¶ is the
curve diameter defined as the maximum distance of the first
sample with any other signal sample

D=

log10 ( L)
log10 ( d )

=

log( n)
Ô£´ dÔ£∂
log( n) log Ô£¨ Ô£∑
Ô£≠ LÔ£∏

The adaptive segmentation value is then calculated
according to Varri using the following equation:15
G j = D j +1 ‚àí D j

(2)

submit your manuscript | www.dovepress.com

Dovepress

Powered by TCPDF (www.tcpdf.org)

(1)

2441

Dovepress

Jirka et al
((*





8 W  ¬ó9



¬±
¬±















((*¬±)')9





)')9 W





¬±



















7LPH VHFRQGV
*¬±DGDSWLYHVHJPHQWDWLRQIXQFWLRQ





























7LPH VHFRQGV
Figure 1 Result of automatic segmentation using fractal dimension on occipital area electrode signal from a patient with Jeavons syndrome.
Notes: A myoclonic epileptic seizure is detected and marked in the incipient segment. The upper graph represents the original EEG signal, the middle graph represents FDFV,
and the lower one represents adaptive segmentation function. X-axis represents time in seconds. ‚ÄúU (t)‚Äù represents O1 occipital electrode O1 voltage data. ‚ÄúG‚Äù represents
adaptive segmentation function as defined by Vari for the occpital electrode O1 voltage data.
Abbreviations: EEG, electroencephalography; FDFV, fractal dimension feature vector.

The illustrative result of adaptive segmentation algorithm
on data recorded from a patient with Jeavons syndrome is presented in Figure 1. The epilepsy segment is correctly detected
just before the fifth second of the signal. The segment for further
calculations has a 5-second overlap from the previous signal.

5DZ((*VLJQDO

Automatic epilepsy classification
GP‚ÄìSVM method
Automatic feature extraction and
compression
This paper presents automatic feature extraction and compression by creating new synthetic features of smaller
dimensionality. Initial set of basic feature vectors is created
by discrete wavelet transformation (DWT). The classification process using GP‚ÄìSVM techniques (see Figure 2) can
be summed up in the following steps:
1. Basic feature set extraction using DWT.
2. Synthetic feature set creation compressing original feature
set and optimizing basic feature set.
3. Final classification using new feature set and SVM
method.
2442

Powered by TCPDF (www.tcpdf.org)





7LPH VHFRQGV

* W

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

¬±
¬±

submit your manuscript | www.dovepress.com

Dovepress

%DVLFIHDWXUHVHW
':7

*3
([WUDFWLRQDQG
FUHDWLRQRI
V\QWKHWLF
IHDWXUHVXVLQJ
*3

&ODVVLILHG((*VLJQDO
LFWDOLQWHULFWDO

690
FODVVLILFDWRU

&ODVVLILFDWLRQ

Figure 2 Schematic flow chart for set extraction and further processing
(compression, classification using GP+SVM).
Abbreviations: DWT, discrete wavelet transformation; EEG, electroenceph¬≠
alography; GP, genetic programming; SVM, support vector machine.

Neuropsychiatric Disease and Treatment 2018:14

Dovepress

Automatic epilepsy detection

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

Basic feature set

M

The first step described in the ‚ÄúAutomatic feature extraction and compression‚Äù section is the basic feature set
extraction using DWT. This transformation is used due to
the fact that the EEG signal has a non-stationary character. Discrete form of wavelet transform uses quadrature
mirrored set of finite impulse response filters where the
low-pass filter‚Äôs output represents input signal approximation and high-pass filter‚Äôs output represents input signal
detail components.
Every decomposed signal using DWT represents
specific time frequency spectrum. A set of six features is
extracted for every such decomposed information. These
features are selected from area of time, statistical analysis, and information theory to extract the most important
characteristics of the EEG signal. These features are
as follows:
‚Ä¢ Signal average value, which is represented by the signal‚Äôs
amplitude average value (Equation 3).
N

1
N

‚àëx

i

i =1

(3)


‚Ä¢ SD, which is the square root of the signal variance, where
¬µ represents the mean value of a signal (Equation 4).
1 N
‚àë ( X ‚àí ¬µ)
N ‚àí 1 i =1 i

(4)


‚Ä¢ Signal energy represents the average value of the signal
energy (Equation 5).
1
N

N

‚àëx
i =1

2
i

(5)


‚Ä¢ Signal curve length is also used in the fractal dimensionbased segmentation and defines the length of the signal
curve given by the sum of the horizontal line segments
and is given by Equation 6.
N

‚àëx
i =1

i +1

‚àí xi

(6)


‚Ä¢ Signal curve skewness is used as a quantification indicator
for signal asymmetry distribution and is given by Equation 7, where ¬µ and œÉ are the mean value and deviation
of a signal, respectively.
1
N

4

Ô£´ xi ‚àí ¬µ Ô£∂
Ô£¨
Ô£∑ ‚àí3
‚àë
œÉ Ô£∏
i =1 Ô£≠

N

Neuropsychiatric Disease and Treatment 2018:14

(7)

h[i ] = ‚àë p[ j ] log p[ j ]
j =1

p[l ] =

(8)


y[l ]

‚àë

(9)

M

y[k ]
k =1



Synthetic feature extraction and
compression
The second stage of the presented algorithm is using combined methods of GP and machine learning SVM method.
Every individual in a genetic tree represents a new set of
features, which is created by nonlinear transformation of the
previous individual. These new features are put into SVM
classifier that expresses the features of individual quality via
its error function Œæ, which is a part of the confusion matrix
expressing the quality of classification using 10-fold crossvalidation testing.18
In standard GP-based methods, one individual in a genetic
tree expresses one result and in the end of the tree evolution,
only one feature vector (result) is obtained. In this paper, we
present a method that includes the F function in every genetic
population tree which expresses the new feature vector. The
F function has only one argument and one output which is a
copy of the function input. The output value of function F is
taken as one of the final synthetic feature vectors. Number
of feature vectors and, thus, the compression level is defined
by the number of F functions.
An example of such an F function is given in Figure 3.
This population tree is fed with an input of ten values x1 ... x10
and given two F functions (nodes) that form the new feature
expressed as a combination of the population descendants.
This algorithm uses the result of the F functions and not
the result of the whole population tree evolution. The best
descendant is given by the best basic arithmetic operation
combination which is found by the maximum fitness value
or minimum SVM error function value given by confusion
matrix. Two new feature vectors will be created as shown
in the picture: the first feature vector will be expressed as
multiplication of input basic features x5x9 and the second
feature vector will be expressed as summation of x3+x8.

SVM confusion matrix and GP fitness
function
Most important part of the algorithm is the population
member fitness evaluation. The value of this function is
given by the misclassification value of the SVM classifier
given by the confusion matrix obtained by the 10-fold crossvalidation. The process of the fitness function evaluation
submit your manuscript | www.dovepress.com

Dovepress

Powered by TCPDF (www.tcpdf.org)

2443

Dovepress

Jirka et al

2. Evaluation of the population tree, best member selection,
and new features extraction.
3. Trained SVM classifier classifies the validation data.
Important value in this step is the value of the misclassified labels given by the confusion matrix. Œæi = Nv - Ns,
where Nv represents the total number of validation samples
and Ns gives the number of correctly classified samples.
4. Steps 1‚Äì4 are repeated for every population member in
search for the ones with the maximum fitness function
value (minimum Œæi value).



¬±

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

)

√Æ

/RJ

)

;



;

;

;

Data

;

Figure 3 Population tree of suggested algorithm with two F functions (nodes) that
make up new flagged vectors that are expressed by the offspring.
Note: In the illustrated example, two new flag vectors are created, the first being
expressed as the sum of x5√óx9 and the second as x3+x8.

and best descendant search is shown in the block scheme
in Figure 4.
Classification process can be summed up into the following steps:
1. Training input data are randomly separated into two
groups: training (40%) and validation data (60%).

The final conclusion and performance comparison table was
obtained by testing the algorithm on 42 subjects in clinical
and home environment setup.
EEG data were collected using devices from Alien Technik and Emotiv Epoc headset.
The work was approved by the Ethics Committee of
Hospital Ostrava-Poruba. For our purposes, anonymized
neurology data were obtained from the hospital, therefore,
informed consent was waived by the ethics committee. Dataset was collected from 42 patients (27 male, 15 female) in
27 months (Feb 2012‚ÄìJune 2014). The patients were aged
4‚Äì62 years (mean: 23.83, SD: 17.43, median: 21.5). The
study group included 21 children under age 18. Thirty-two
patients were referred from the hospital neurological clinic,
eight from Trigon association, and two were referred from

*3


)

¬±

%DVLF':7
IHDWXUHV

;

;

/RJ

)

;



;

1HZIHDWXUHV

690FODVVLILHU
(UURUIXQFWLRQH[SUHVVLQJ
PLVODEHOHGVDPSOHV
2XWSXWRIWKHFRQVIXVLRQ
PDWUL[

;

)LWQHVVIXQFWLRQ
YDOXH
Figure 4 GP‚ÄìSVM block scheme.
Abbreviations: DWT, discrete wavelet transformation; GP, genetic programming; SVM, support vector machine.

2444

Powered by TCPDF (www.tcpdf.org)

submit your manuscript | www.dovepress.com

Dovepress

Neuropsychiatric Disease and Treatment 2018:14

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

Dovepress

Automatic epilepsy detection

the GP. Thirty-six patients (85% of the group) were previously suffering from tonic‚Äìclonic episodes, of which 10
(24% of the group) were unwitnessed and not medically
assessed and 26 patients (62% of the group) were medically
diagnosed or EEG recordings were labeled to contain tonic‚Äì
clonic seizure.

Clinical diagnosis
This section and Table 1 describe the clinical diagnosis of partial, generalized, and unclassified epilepsy types of patients.
These data are based solely on the neurologist‚Äôs evaluation
provided either by the patient himself or by the neurologist
upon patient‚Äôs agreement. A total of 12 patients (29%) were
classified with generalized epilepsy, 23 (54%) with partial
epilepsy, and 7 patients (17%) were unclassified.

Testing
This section presents the results of the classification algorithm described in previous sections. Data were obtained
in children from the neurological department of university
Hospital Ostrava-Poruba and clients of Trigon association
that provides support for people with social disabilities.
The patient whose results are shown in this section was
diagnosed with photosensitive epilepsy, more specifically
Jeavons syndrome.19 Data from this patient were fully classified and described by the neurologist. EEG signal record was
fully labeled by the neurologist as well. These data contained

Table 1 Clinically diagnosed epilepsy types of patients
Seizure type
Generalized epilepsy
Total
Myoclonus
GTCS with myoclonus
Photo-induced GTCS with myoclonus
Photo-induced GTCS with no other symptoms
Absence
Partial epilepsy
Total
Simplex partial seizure
Complex partial seizure
GTCS with simplex partial seizure
Secondary generalized partial seizure
Unclassified
Total
GTCS
Febrile seizures
Unclassified
Abbreviation: GTCS, generalized tonic clonic seizure.

Neuropsychiatric Disease and Treatment 2018:14

Number of
patients
12
2
5
3
1
1
23
3
5
14
1
7
3
2
2

absence seizure, eyelid myoclonic seizures, tonic‚Äìclonic
seizures, and myoclonic seizure.

Extraction of the basic feature vector
The basic features set is created by input signal decomposition using four-level DWT. Daubechies wavelet is used as
the mother wavelet. Number of levels and type of mother
wavelet were determined to be the best possible to discover
most details and separate the EEG signal most appropriately
according to its spectral composition.19 Wavelet filter bank
frequency bands are specified for the sampling frequency of
128 Hz in Table 2.
Figure 5 shows the four-level wavelet decomposed signals for seizure-free signal. Figure 6 shows the EEG signal
decomposition with myoclonic seizure.
Basic set of six features is calculated for every decomposed frequency sub-band according to features described in
the ‚ÄúBasic feature set‚Äù section. Table 3 describes the input
feature vector mapping with respect to decomposed sub-band
and calculated feature.

Feature vector combination
Figure 7 shows results of SVM training phase defining
hyperplane separating classified and non-classified samples
using exponential radial basis function as defined in 10.
Training samples of the population tree descendants combining the input features x9+x10 are clearly distinguishable
from the population member genetically combining the input
features x17+x18, and thus, these two members are suitable
for the new features.
These two members were found using fitness function value obtained from the confusion matrix, which is
the output of the SVM classifier expressing classification
quality.
An example of such confusion matrix can be observed in
Figure 8. Elements of this matrix are used to express the quality of the classifier output. Diagonal elements represent the
number of points correctly classified (predicted label = target
true label) and off-diagonal elements express mislabeled

Table 2 Frequency bands for four-level DWT decomposition
Signal label

Frequency band (Hz)

Decomposition level

w1
w2
w3
w4
a1

32‚Äì64
16‚Äì32
8‚Äì16
4‚Äì8
0‚Äì4

1
2
3
4
4

Abbreviation: DWT, discrete wavelet transformation.

submit your manuscript | www.dovepress.com

Dovepress

Powered by TCPDF (www.tcpdf.org)

2445

Dovepress

((*
VLJQDO

Jirka et al


¬±



































































































¬±


Z



¬±


Z



¬±


Z



¬±


Z



¬±


7LPH VHFRQGV

((*VLJQDO




¬±
¬±
¬±

Z






¬±
¬±
¬±
¬±






¬±
¬±
¬±
¬±

Z

Z




¬±
¬±
¬±
¬±

D

Figure 5 Four-level DWT decomposition for interictal EEG.
Abbreviations: DWT, discrete wavelet transformation; EEG, electroencephalography.






¬±
¬±
¬±
¬±

Z

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

D








¬±
¬±
¬±
¬±













































































































7LPH VHFRQGV
Figure 6 Four-level DWT decomposition for ictal EEG.
Abbreviations: DWT, discrete wavelet transformation; EEG, electroencephalography.

2446

Powered by TCPDF (www.tcpdf.org)

submit your manuscript | www.dovepress.com

Dovepress

Neuropsychiatric Disease and Treatment 2018:14

Dovepress

Automatic epilepsy detection

Table 3 Basic set feature vector mapping


16‚Äì32

8‚Äì16

4‚Äì8

0‚Äì4

x1
x2
x3
x4
x5
x6

x7
x8
x9
x10
x11
x12

x13
x14
x15
x16
x17
x18

x19
x20
x21
x22
x23
x24

x25
x26
x27
x28
x29
x30










7UXHODEHO

32‚Äì64










samples. The higher the diagonal values mean, the better is
the result of the classifier.






Results and discussion
Algorithm described in the ‚ÄúAutomatic epilepsy classification GP‚ÄìSVM method‚Äù section was tested on the dataset
obtained from 42 subjects with 1‚Äì3 tests on each subject
measured primarily over the night. Origin of the dataset is
closely described in the ‚ÄúData‚Äù section.
Algorithm results were evaluated using the following:
1. 10-fold cross validation technique X10.
2. Statistical success rate evaluation of sensitivity XE (classification success,0; 1.), specificity XS (measure of the
test ability to express the correct results ‚Äì test quality),
positive predictive value (PPV) ‚Äì correctly detected
events from all detected events, and negative predictive
value (NPV) ‚Äì falsely detected events from all detected
events.



6LJQDOHQHUJ\FXUYHOHQJWK

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

Frequency band (Hz)
Average value
SD
Energy
Curve length
Skewness
Entropy



&RQIXVLRQPDWUL[






3UHGLFWHGODEHO



Figure 8 Confusion matrix for dataset shown in Figure 7.
Notes: Diagonal elements represent the number of points correctly classified
(predicted label = target true label) and off-diagonal elements express mislabeled
samples. The higher the diagonal values mean, the better is the result of the
classifier.

10-fold cross validation technique can be summarized
into the following steps:
1. Break data into ten sets of size n/10.
2. Train on nine datasets and test on one.
3. Repeat ten times and take the mean accuracy.
Table 4 summarizes the results of tests on a total of 77
EEG signal recordings using GP‚ÄìSVM automatic epilepsy
classification algorithm. Results are separated into groups
defined by ictal and interictal class and seizure type labeled
by the neurologist.

Basic feature set efficiency comparison
with compressed feature set

















(QWURS\IHDWXUHVNHZQHVV
Figure 7 Training stage of population tree samples separation. Population tree
descendants combining the input features x9+x10 are clearly distinguishable from the
population member genetically combining the input features x17+x18.
Notes: These two members (found using fitness function value) are suitable for the
new features. Both the functions represented at X and Y axes are dimensionless.

Neuropsychiatric Disease and Treatment 2018:14

The following test results display increased performance in
epilepsy classification using basic feature set and compressed
feature set with compression level 5 for a photosensitive
patient. Table 5 displays the compressed basic vectors for
occipital electrode O1. Table 6 presents results of the test
comparing the performance results with PPV and NPV. A
total of 356 events were recorded in the testing session.

Conclusion
This paper presents a novel method for automatic epilepsy
detection using a combination of GP and SVM as a GP
fitness function value and second stage stacking style

submit your manuscript | www.dovepress.com

Dovepress

Powered by TCPDF (www.tcpdf.org)

2447

Dovepress

2448

Powered by TCPDF (www.tcpdf.org)

0.96¬±0.03
0.98¬±0.02
0.84¬±0.1
0.82¬±0.08
0.96¬±0.08
0.97¬±0.06
0.97¬±0.02
0.98¬±0.04
Abbreviations: GTCS, Generalized Tonic Clonic Seizure; NPV, negative predictive value; PPV, positive predictive value.

0.7¬±0.1
0.9¬±0.05
0.7¬±0.2
0.6¬±0.08
0.7¬±0.1
0.8¬±0.05
0.9¬±0.03
0.8¬±0.05

submit your manuscript | www.dovepress.com

Dovepress

Table 5 Compressed feature vector with compression level 5

0.2¬±0.1
0.31¬±0.05
0.23¬±0.2
0.33¬±0.08
0.08¬±0.1
0.3¬±0.05
0.2¬±0.03
0.4¬±0.05

PPV¬±œÉ

0.98¬±0.02
0.95¬±0.03
0.83¬±0.02
0.79¬±0.03
0.96¬±0.08
0.97¬±0.06
0.98¬±0.01
0.98¬±0.04
0.98¬±0.1
0.97¬±0.03
0.95¬±0.5
0.93¬±0.06
0.97¬±0.03
0.96¬±0.04
0.99¬±0.03
0.98¬±0.04
Ictal (myoclonic)
Interictal (myoclonic)
Ictal (GTCS)
Interictal (GTCS)
Ictal (tonic)
Interictal (tonic)
Ictal (atonic ‚Äì mal absens)
Interictal (atonic ‚Äì mal absens)

XS¬±œÉ
XE¬±œÉ
Epileptic seizure type classification

Table 4 Classification accuracy

NPV¬±œÉ

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

X10¬±œÉ

Jirka et al

Fn

Compressed
feature vector

F1
F2
F3
F4
F5

(x1 + x2)x3
x1 + x9 + x3
x15x23 + log x15
x13 - x5 + log x3
x15x6 - (x8 + x15)

classification for final ictal/interictal class. This novel
method improves the overall performance of the SVM
classification by dramatically reducing the size of input
feature vector. According to the results, the accuracy of
this algorithm is very high and comparable, and even
superior to other automatic detection algorithms. 14 In
combination with the great efficiency, this algorithm can
be used in real-time epilepsy detection applications. Test
results of the algorithm can be seen in the ‚ÄúResults and
discussion‚Äù section.
The results of the algorithm‚Äôs classification are of high
sensitivity and specificity, except for the Generalized Tonic
Clonic Seizure (GTCS). This bad performance might be the
result of the small number of testing subjects with this specific
seizure and also strong artifacts (moving, EMG) interfering
with the original EEG signal. This had caused low PPV and
X10 for this type of seizure.

Future work
This algorithm is currently being deployed and implemented
on mobile device for real-time multimodal epilepsy detection
using EEG emotive headset with a combination of acoustic,
visual, and mechanic (accelerometer) modalities that support
epilepsy detection. As the next step, the optimization of the
compression stage and the final SVM evaluation stage is in
place. More data need to be obtained on GTCS to improve
the overall classification score for GTCS.
All the results and calculations described in this article
had been performed using python and scikit libraries. Currently, this algorithm is being implemented on android
phone device in Java to provide fully mobile support for
the mobile non-clinical environment automatic epilepsy
detection system.

Acknowledgments
This work was supported in part by the Center for Applied
Cybernetics 3, Technology Agency of Czech Republic
under project TE01020197, the Grant Agency of Excellence,

Neuropsychiatric Disease and Treatment 2018:14

Dovepress

Automatic epilepsy detection

Table 6 Compressed and basic feature vectors-based classification performance comparison
XE¬±œÉ

XS¬±œÉ

PPV¬±œÉ

NPV¬±œÉ

Basic features

0.873¬±0.051

0.876¬±0.113

0.437¬±0.235

0.2¬±0.1

Compressed features (Fn=5)

0.915¬±0.195

0.051¬±0.051

0.898¬±0.023

0.31¬±0.05

Neuropsychiatric Disease and Treatment downloaded from https://www.dovepress.com/ by 207.241.231.83 on 28-Apr-2019
For personal use only.

Abbreviations: NPV, negative predictive value; PPV, positive predictive value.

University of Hradec Kralove, Faculty of Informatics and
Management, and the University Hospital Hradec Kralove ‚Äì
Long-term Development Plan. This work was also supported
by the European Regional Development Fund in the Research
Centre of Advanced Mechatronic Systems project, project
number CZ.02.1.01/0.0/0.0/16_019/0000867.

Disclosure
The authors report no conflicts of interest in this work.

References

1. Kandel ER, Schwartz JH, Jessell TM. Principles of Neural Science. New
York: McGraw-Hill, Health Professions Division; 2000.
2. Chapman D, Panelli R, Hanna J, Jes T. Sudden Unexpected Death in
Epilepsy: Continuing the Global Conversation. Epilepsy Australia:
Epilepsy Bereaved: SUDEP Aware; 2011.
3. Steventon A, Bardsley M, Billings J, et al; Whole System Demonstrator
Evaluation Team. Effect of telehealth on use of secondary care and mortality: findings from the Whole System Demonstrator cluster randomised
trial. BMJ. 2012;344:e3874.
4. Subasi A. Automatic recognition of alertness level from EEG by using
neural network and wavelet coefficients. Expert Syst Appl. 2005;28(4):
701‚Äì711.
5. Koza JR. Genetic Programming: On the Programming of Computers by
Means of Natural Selection. London and Cambridge, MA: MIT Press;
1992.
6. Raymer ML, Punch WF, Goodman ED, Kuhn LA. Genetic Programming
for Improved Data Mining: Application to the Biochemistry of Protein
Interactions, in Proceedings of the First Annual Conference on Genetic
Programming: Stanford, CA: MIT Press; 1996:375‚Äì380.

7. Tackett WA. Genetic Programming for Feature Discovery and Image
Discrimination: Urbana, IL: ICGA; 1993:303‚Äì311.
8. Bot MC. Gen Program. Feature extraction for the k-nearest neighbor classifier with genetic programming. Gen Program. 2001;2038:256‚Äì267.
9. Sabeti M, Katebi S, Boostani R. Entropy and complexity measures for
EEG signal classification of schizophrenic and control participants.
Artif Intell Med. 2009;47(3):263‚Äì274.
10. Jirka J. Biometrical Data Processing and Analysis ‚Äì Exogenous Epilepsy
Seizure Source Localization and Classification [dissertation thesis].
Ostrava: VSB TU Ostrava; 2014.
11. Ferlazzo E, Zifkin BG, Andermann E, Andermann F. Cortical triggers
in generalized reflex seizures and epilepsies. Brain. 2005;128(Pt 4):
700‚Äì710.
12. Avanzini G. Musicogenic seizures. Ann N Y Acad Sci. 2003;999:95‚Äì102.
13. Tzallas AT, Tsipouras MG, Tsalikakis DG, et al. Automated epileptic
seizure detection methods: a review study. In: Epilepsy ‚Äì Histological,
Electroencephalographic and Psychological Aspects. Rijeka: In Tech;
2012:2027‚Äì2036.
14. Lotte F, Congedo M, L√©cuyer A, Lamarche F, Arnaldi B. A review of
classification algorithms for EEG-based brain. J Neural Eng. 2007;4(2):
R1‚ÄìR13.
15. Varri A. Digital Processing of the EEG in Epilepsy [licentiate thesis].
Tampere, Finland: Tampere University of Technology; 1988.
16. Krajca V, Petr√°nek S, Pat√°kov√° I, V√§rri A. Automatic identification
of significant graphoelements in multichannel EEG recordings by
adaptive segmentation and fuzzy clustering. Int J Biomed Comput.
1991;28(1‚Äì2):71‚Äì89.
17. Hsu CW, Chang CC, Lin CJ. A practical guide to support vector classification; 2003. Available from: ntur.lib.ntu.edu.tw/bitstream/246246
/20060927122852476378/1/freiburg.pdf. Accessed March 1, 2018.
18. Harding GF, Jeavons PM. Photosensitive Epilepsy. London: MacKeith
Press; 1994.
19. Subasi A. Automatic detection of epileptic seizure using dynamic fuzzy
neural networks. Expert Syst Appl. 2006;31(2):320‚Äì328.

Dovepress

Neuropsychiatric Disease and Treatment

Publish your work in this journal
Neuropsychiatric Disease and Treatment is an international, peerreviewed journal of clinical therapeutics and pharmacology focusing
on concise rapid reporting of clinical or pre-clinical studies on a
range of neuropsychiatric and neurological disorders. This journal
is indexed on PubMed Central, the ‚ÄòPsycINFO‚Äô database and CAS,

and is the official journal of The International Neuropsychiatric
¬≠Association (INA). The manuscript management system is completely
online and includes a very quick and fair peer-review system, which
is all easy to use. Visit http://www.dovepress.com/testimonials.php to
read real quotes from published authors.

Submit your manuscript here: http://www.dovepress.com/neuropsychiatric-disease-and-treatment-journal

Neuropsychiatric Disease and Treatment 2018:14

submit your manuscript | www.dovepress.com

Dovepress

Powered by TCPDF (www.tcpdf.org)

2449

