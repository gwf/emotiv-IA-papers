Hindawi Publishing Corporation
BioMed Research International
Volume 2016, Article ID 9359868, 9 pages
http://dx.doi.org/10.1155/2016/9359868

Research Article
Brain-Computer Interface for Control of Wheelchair
Using Fuzzy Neural Networks
Rahib H. Abiyev,1 Nurullah Akkaya,1 Ersin Aytac,2 Irfan GÃ¼nsel,2 and Ahmet Ã‡aLman1
1

Department of Computer Engineering, Applied Artificial Intelligence Research Centre, Near East University, Lefkosa,
Northern Cyprus, Mersin 10, Turkey
2
Applied Artificial Intelligence Research Centre, Robotics Research Lab, Near East University, Lefkosa, Northern Cyprus,
Mersin 10, Turkey
Correspondence should be addressed to Rahib H. Abiyev; rahib.abiyev@neu.edu.tr
Received 5 March 2016; Revised 30 July 2016; Accepted 21 August 2016
Academic Editor: Juan M. Corchado
Copyright Â© 2016 Rahib H. Abiyev et al. This is an open access article distributed under the Creative Commons Attribution
License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly
cited.
The design of brain-computer interface for the wheelchair for physically disabled people is presented. The design of the proposed
system is based on receiving, processing, and classification of the electroencephalographic (EEG) signals and then performing
the control of the wheelchair. The number of experimental measurements of brain activity has been done using human control
commands of the wheelchair. Based on the mental activity of the user and the control commands of the wheelchair, the design of
classification system based on fuzzy neural networks (FNN) is considered. The design of FNN based algorithm is used for brainactuated control. The training data is used to design the system and then test data is applied to measure the performance of the
control system. The control of the wheelchair is performed under real conditions using direction and speed control commands
of the wheelchair. The approach used in the paper allows reducing the probability of misclassification and improving the control
accuracy of the wheelchair.

1. Introduction
Human brain control of wheelchairs for physically disabled
people has attracted great attention due to their convenience
and relatively low cost, high mobility, and quick setup. The
measurement of human brain signals and converting them
into control signals require the development of an interface
between the brain and the computer. A brain-computer
interface (BCI) system provides communication between
computer and mind of pupils. This interface can be based on
brain activity during muscular movements or the changes of
the rhythms of brain signals [1]. These brain activities can be
detected using electroencephalographic (EEG) signals. BCI
transforms the EEG signals produced by brain activity into
control signals which can be later used for controlling the
wheelchair without using any physical controls. Since the
brain signals are very weak, we need to apply amplifiers and
some spatial and spectral filters to the EEG signals in order
to extract the features of these signals. The detected EEG

signals are based on the change of frequencies and change
of amplitudes. For example, during voluntary thoughts,
the frequencies of signals change, and during movement,
synchronisation/desynchronisation of brain activity which
involves ğœ‡ rhythm amplitude change happens. This relevant
characteristic makes rhythm based BCI suitable to be used.
Recently, some research works have been done to develop
many applications of BCI for wheelchairs. The main function
of BCI is to convert and transmit human intentions into
appropriate motion commands for the wheelchairs, robots,
devices, and so forth. BCI allows improving the quality of
life of disabled patients and letting them interact with their
environment. Reference [2] presents the application of BCI
and control of wheelchair in an experimental situation. The
research considers the driving of a simulated wheelchair in a
virtual environment before using BCI in a real situation. The
virtual reality (VR) decreases the number of dangerous situations by using training and testing applications. Reference
[3] describes a BCI system which controls the wheelchair that

2
moves in only one direction: move forward. In [4, 5], BCI is
designed for control of wheelchair using three possible commands: turn left, turn right, and move forward. In [6], BCI
is designed using EEG signal captured by eight electrodes.
Wavelet transform was used for feature extraction and the
radial basis networks were used to classify the predefined
movements. In [7], controller based on the brain-emotionallearning algorithm is used to control the omnidirectional
robot. Reference [8] presents the design of an asynchronous
BCI based control system for humanoid robot navigation
using an EEG. Reference [9] considers a noninvasive EEGbased brain-computer interface system to achieve stable control of a low speed unmanned aerial vehicle for indoor target
searching. References [10â€“15] consider the design of braincontrolled wheelchair. The construction of viable brainactuated wheelchair that combines BCI with a commercial
wheelchair, via a control layer, is considered. Combining
the BCI with shared control architecture [11] allows for
dynamically producing intuitive and smooth trajectories. The
processes of feature extraction and classification are very
important in BCI design and they have a great effect on the
performance of the BCI system. Set of research works has
been done for improvement of the feature extraction and
classification algorithms [12â€“19]. References [16, 17] consider
feature extraction algorithms for BCI. Reference [17] uses
adaptive common spatial patterns for feature extraction.
Different clustering algorithms based on support vector
machines, linear discriminant analysis, and neural networks
are applied for classification of brain signals. Reference [18]
uses features, optimised in the sense of statistically significant and potentially discriminative coherences at a specific
frequency, and applies linear discriminant analysis (LDA) for
classification purpose. SVM [19] and LDA [20] are used for
classification purpose of brain signals.
Recently, several soft computing techniques are used for
recognition of brain activity [21â€“23]. Reference [21] uses fuzzy
logic and [22] uses neural networks with fuzzy particle swarm
optimisation for BCI design. In [23], continuous wavelet
transform is used to extract highly representative features and
then an Adaptive Neuron-Fuzzy Inference System (ANFIS)
is applied for classification. The systems based on fuzzy
logic can make classifications using vague, imprecise, noisy,
or missing input information. On given problem, human
perception process can be efficiently modelled using fuzzy
logic.
As shown, feature extraction and classification play an
important role in the design of brain-based control for
obtaining high classification accuracy. In the BCI design, high
classification rate is very important. Otherwise, the presence
of errors can cause initiation of a wrong command that can
lead to dangerous situations. Therefore, achieving low error
rates keeps the users safe. Different clustering algorithms
based on support vector machines, linear discriminant analysis, and neural networks are applied for classification of brain
signals [18]. Fuzzy classification represents knowledge more
naturally to the way of human thinking and is more robust
in tolerating imprecision, conflict, and missing information.
In this paper, the fuzzy neural network structure is proposed
for the design of BCI in order to achieve efficient brain-based

BioMed Research International

Signal
acquisition

Signal
preprocessing

Feature
extraction

Classification

Wheelchair
motors

Control
actions

Figure 1: The BCI based control of the wheelchair.

control of wheelchair. In the literature, different neural and
fuzzy networks are proposed for solving various problems
[23â€“29]. In [23â€“26], FNN structure is designed for control of
dynamic plants. In [27â€“29], neurofuzzy inference systems are
designed for classification and control purposes. The systems
designed in these papers are used for special purposes. In
the neurofuzzy structures, the rules are constructed using
all possible combinations of inputs and cluster centres. The
problems that are characterised by multiple inputs and
multiple outputs will have a huge number of fuzzy rules.
The constructions of such systems are not efficient and these
systems have a huge number of parameters. In this paper, the
number of rules is selected using the clustering results which
is equal to the number of cluster centres. In this paper, in
order to improve the performance of classification system,
a multi-input and multioutput fuzzy neural system (FNS)
based on TSK rules is proposed for classification of the ECG
signals.
The paper is organised as follows. Section 2 presents the
architecture of BCI system based on FNN. Signal processing
and feature extraction stages have been described. Section 3
presents classification algorithm based on FNN. Section 4
presents parameter updates rule used for FNN. The fuzzy
ğ‘ means classification and gradient descent algorithms are
applied for updating parameters of FNN. Section 5 gives
experimental results obtained for FNN based BCI system.
Section 6 presents conclusions of the paper.

2. BCI System Architecture
Figure 1 depicts BCI based control of the wheelchair. BCI
system consists of an Emotiv headset connected to a computer. Emotive sensors supply information to the computer.
The computer runs the signal processing and classification
algorithms and is connected to a microcontroller that controls the movement of the wheelchair. The wheelchair can
move in four directions. The speed of the wheelchair is taken
as constant and the wheelchair can be switched on and off in
the case of necessity. Taking into account the abovementioned
functionality, the BCI system uses the following commands:

BioMed Research International

3

AF10

AF9
Fpz

Fp1

Fp2

AF7

AF8

F9

AF3

F10

AF4

AFz

81

88
82

83

F7
F5
89

FT9
FT7

90
FC5

97

FC3

106

A1

TP9

CPz

CP1

C4

C2
109

108

107
CP3

CP5

TP7

Cz

C1

104

103

102

110

T8

C6
111

CP2

FT10
FT8

FC6

FC4

FC2
101

100

99

96

95

94

93
FCz

FC1

F8
F6

F4

F2

Fz
92

C3

C5
105

F1
91

98

T7

T9

F3

87

86

85

84

CP4

T10

112
A2

CP6
TP8

P5
P7
121

116

115

114

113

P1

P3

117

118
P2

Pz

119

TP10

120

P4
P6

123

122

124

PO3

P9

125
POz

126

127

P8
128

PO4

P10

PO7

PO8
O1

Oz

O2
PO10

PO9
09

Iz

010

Figure 2: Emotivâ€™s sensor layout compared to standard 72 sensorsâ€™ layout. The distribution of EEG electrodes. Fourteen channels are marked
for data acquisition.

move forward, move backward, turn left, turn right, and turn
on and turn off the switch.
A BCI based control system is usually composed of five
main units: signal acquisition unit, signal preprocessing unit,
feature extraction unit, classification unit, and action unit
that controls motors of the wheelchair. The main units of
the decision system are represented in Figure 1. In signal
acquisition block, the EEG signals are captured using the
Emotiv headset. Emotiv EPOC is an EEG headset which
supplies 14-channel EEG data (Figure 2) and 2 gyros for 2dimensional controls. Its features are adequate for a useful
BCI (resolution and bandwidth). Our system uses upper
face gestures for actuation commands; since most Emotiv
sensors are located in the frontal cortex, they are the most
reliable signals to detect. The EEG input signals are sent
to the signal preprocessing unit for filtering and scaling
and sent to the feature extraction block. In this block, the
basic features are extracted and sent to the classification
system. The classification block processes the input signals
and outputs the control instructions. Later, these control
instructions are sent to the motors of the wheelchair.

The EEG signals measured by Emotiv headset are first
processed by signal preprocessing and feature extraction
blocks. Signal preprocessing block filters the noises and scales
the signals in a certain interval. These signals are very long
and need certain time for processing. Therefore, the feature
extraction technique is applied in order to decrease the signal
size and extract more important features for classification.
In the paper, we used fast Fourier transform (FFT) for
extraction of the features of the input EEG signals. Figure 3
presents the operations used in the feature extraction stage.
The input signal received from the headset is divided into
windows having 2 sec time interval with 50% overlap. The use
of overlapping windows allows us to increase the accuracy
of the classification. Each two-second window corresponds
to 256 samples of data. Each second headset returns 128
data samples. The obtained signals from the channels, stored
as windows, are then sent to normalisation block. Each
channel is normalised in order to centre each channel on
zero by calculating the mean value of each channel for the
window and then subtracting it from each of the data points
in the channel. After normalisation, Hamming window is

4

BioMed Research International
The output of classification system is used to control the
wheelchair. Even though during training system reports 100%
success rate in real-world conditions, it does misclassify, a
state machine is used to further increase safety and reduce
misclassification. As an example, the system will not transition from forward motion to backward motion without
stopping in neutral. The output of the state machine drives the
microcontroller which controls the motors on the wheelchair.
The number of classes is equal to the number of control
actions.

Input data

Split data into windows
having 2 sec time interval

Normalise each window

Applying FFT to the window
data

3. FNN Based Classification
Combine all channels

Reduce the number of
features

Figure 3: Signal preprocessing and feature extraction.

applied to each channel in the window. EEG signals do not
generally repeat exactly, over any given time interval, but
the math of the Fourier transform assumes that the signal
is periodic over the time interval. This mismatch leads to
errors in the transform called spectral leakage. Hamming
window is used to mitigate this problem. Then, fast Fourier
transform (FFT) is applied to each channel in the window
to find out the frequency components of the signal. Each
frequency component is used as a feature, which results in
64 Ã— 14 features. In order to increase the performance of
the classification, the features are ranked by evaluating the
worth of a frequency by measuring the information gain with
respect to the class. The expected information gain is the
change in information entropy (ğ») from a prior state to a state
that takes some information as given.
Information gain selects a subset of the original representation attributes according to Information Theory quality
metric. This method computes the value of the metric for each
attribute and ranks the attributes. Then, it simply decides a
threshold in the metric and keeps the attributes with a value
over it.
After frequency representation, all channels in the window are combined into a single unit so as to apply classification on all channels at once. The filtering operation is applied
in order to select important features of the brain signals.
These features are used for classification purpose.
Besides the above-described approach, we can use also
another approach for signal processing. In the second
approach, the acquired brain signal after windowing, normalisation, and combining operations is used for classification
purpose:
InfoGain (Class, Frequency)
= ğ» (Class) âˆ’ ğ» (Class | Frequency) .

(1)

In the paper, we use frequency representation of signals
for classification. These signals are processed and classified.

The features extracted from the EEG signals are used for
classification and determining control action. In this paper,
we propose a novel approach which is based on FNN for the
classification of brain signals. The extracted features are input
signals of the FNN based classifier. The classifier based on
the extracted features classifies the signals into the following
six classes: move forward, move backward, turn left, turn
right, and turn on and turn off the switch. The design of
FNN includes the development of the fuzzy rules that have
IF-THEN form. This is implemented by dint of optimal
definition of the premise and consequent parts of fuzzy IFTHEN rules for the classification system through training of
fuzzy neural networks. In the paper, the Takagi-Sugeno-Kang
(TSK) types of IF-THEN rules that have a fuzzy antecedent
and crisp consequent parts are used. The TSK-type fuzzy
system approximates nonlinear system with linear systems
and has the following form:
If

ğ‘¥1 is ğ´ 1ğ‘— and ğ‘¥2 is ğ´ 2ğ‘— and . . . and ğ‘¥ğ‘š is ğ´ ğ‘šğ‘—
ğ‘š

Then ğ‘¦ğ‘— is âˆ‘ ğ‘ğ‘–ğ‘— ğ‘¥ğ‘– + ğ‘ğ‘— .

(2)

ğ‘–=1

Here, ğ‘¥ğ‘– and ğ‘¦ğ‘— are input and output signals of the system,
respectively, ğ‘– = 1, . . . , ğ‘š is the number of input signals, and
ğ‘— = 1, . . . , ğ‘Ÿ is the number of rules. ğ´ ğ‘–ğ‘— are input fuzzy sets; ğ‘ğ‘—
and ğ‘ğ‘–ğ‘— are coefficients.
The structure of fuzzy neural networks used for the
classification of EEG signal is based on TSK-type fuzzy rules
and is given in Figure 4. The FNN consists of six layers. The
first layer is used to distribute the ğ‘¥ğ‘– (ğ‘– = 1, . . . , ğ‘š) input
signals. The second layer includes membership functions.
Here, each node represents one linguistic term. Here, for
each input signal entering the system, the membership degree
where input value belongs to a fuzzy set is calculated. In the
paper, the Gaussian membership function is used to describe
linguistic terms.
2

2

ğœ‡1ğ‘— (ğ‘¥ğ‘– ) = ğ‘’âˆ’(ğ‘¥ğ‘– âˆ’ğ‘ğ‘–ğ‘— ) /ğœğ‘–ğ‘— , ğ‘– = 1, . . . , ğ‘š, ğ‘— = 1, . . . , ğ‘Ÿ,

(3)

where ğ‘ğ‘–ğ‘— and ğœğ‘–ğ‘— are centre and width of the Gaussian
membership functions, respectively. ğœ‡1ğ‘— (ğ‘¥ğ‘– ) is membership
function of the ğ‘–th input variable for the jth term. m is a
number of input signals; r is a number of fuzzy rules (hidden
neurons in the third layer).
The third layer is a rule layer. Here, the number of nodes is
equal to the number of rules. Here, ğ‘…1 , ğ‘…2 , . . . , ğ‘…ğ‘Ÿ represents

BioMed Research International

ğœ‡11 (x1 )
x1

y1

ğœ‡1 (x )

R1

..
.

5

/
y2

R2

/
ğœ‡2 (x )

x2

xm

..
.
..
.

u1
u2

..
.

..
.

âˆ‘

..
.
ğœ‡1r (xm )

Layer 1 Layer 2

Rn

un

yr

/

Layer 4 Layer 5

Layer 6

ğœ‡r (x)

Layer 3

Figure 4: FNN based identifier.

the rules. The output signals of this layer are calculated using
t-norm min (AND) operation:
ğœ‡ğ‘— (ğ‘¥) = âˆ ğœ‡1ğ‘— (ğ‘¥ğ‘– ) ,

ğ‘– = 1, . . . , ğ‘š, ğ‘— = 1, . . . , ğ‘Ÿ,

ğ‘–

(4)

where âˆ is the min operation.
These ğœ‡ğ‘— (ğ‘¥) signals are input signals for the fifth layer. The
fourth layer is a consequent layer. It includes ğ‘› linear systems.
Here, the values of rules output are determined as
ğ‘š

ğ‘¦ğ‘— = âˆ‘ğ‘¥ğ‘– ğ‘¤ğ‘–ğ‘— + ğ‘ğ‘— .

(5)

ğ‘–=1

In the next fifth layer, the output signals of the third layer
are multiplied by the output signals of the fourth layer. The
output of ğ‘—th node is calculated as
ğ‘¦1ğ‘— = ğœ‡ğ‘— (ğ‘¥) â‹… ğ‘¦ğ‘— .

(6)

In the sixth layer, the output signals of FNN are determined as
ğ‘¢ğ‘˜ =

âˆ‘ğ‘Ÿğ‘—=1 ğ‘¤ğ‘—ğ‘˜ ğ‘¦1ğ‘—
âˆ‘ğ‘Ÿğ‘—=1 ğœ‡ğ‘— (ğ‘¥)

.

(7)

Here, ğ‘¢ğ‘˜ are the output signals of FNN (ğ‘˜ = 1, . . . , ğ‘›). After
calculating the output signal, the training of the network
starts.
The design of FNN (Figure 4) includes determination
of the unknown parameters that are the parameters of the
antecedents ğ‘ğ‘–ğ‘— and ğœğ‘–ğ‘— (ğ‘– = 1, . . . , ğ‘š, ğ‘— = 1, . . . , ğ‘Ÿ) and the
consequents ğ‘¤ğ‘—ğ‘˜ , ğ‘ğ‘–ğ‘— , ğ‘ğ‘— (ğ‘– = 1, . . . , ğ‘š, ğ‘— = 1, . . . , ğ‘Ÿ, ğ‘˜ =
1, . . . , ğ‘›) parts of the fuzzy IF-THEN rules (2). In the next
section, the training of the parameters of FNN is presented.

behaviour in those regions. In the design of FNN model,
the basic problem is the determination of the unknown
parameters of antecedent and consequent parts. Recently, a
set of different approaches has been applied for designing
fuzzy IF-THEN rules. These are clustering [30â€“35], gradient
algorithms [24â€“27, 34â€“36], the least-squares method (LSM)
[27, 33], and genetic algorithms [27, 34].
In this paper, the fuzzy clustering and gradient descent
algorithms are applied for determining the parameters of
FNN. The basic parameters of the antecedent part are the
centres and widths of the membership functions. Learning
of FNN starts with the update of parameters of antecedent
part of IF-THEN rules, that is, the parameters of the second
layer of FNN (Figure 4). For this purpose, FCM is applied
in order to partition input space and construct antecedent
part of fuzzy IF-THEN rules. In the result of partitioning the
cluster centres are determined. These centres correspond to
the centres of the membership functions used in the input
layer of FNN. Using the distances between the cluster centres,
the widths of the membership functions are determined.
After finding the parameters of the antecedentâ€™s parts,
the design of the consequent part of the fuzzy rules starts.
For this purpose, the gradient descent algorithm is applied
for the parameter update of the consequent part, that is, the
parameters of the fourth layer of FNN. In learning of FNN,
10-fold cross validation is applied for separation of the data
into training and testing set.
The initial values of the parameters of consequent parts
are generated randomly. The training of the parameters has
been carried out using errors calculated on the output of
the network. For generality, we have given the learning
procedure of all parameters of FNN using gradient descent
algorithm with adaptive learning rate. The adaptive learning
rate used guarantees the convergence and speeds up the
learning process. In addition, the momentum is also used to
speed up the learning processes.
The error in the output of the network is calculated as
2
1 ğ‘›
âˆ‘ (ğ‘¢ğ‘˜ğ‘‘ âˆ’ ğ‘¢ğ‘˜ ) .
2 ğ‘˜=1

ğ¸=

(8)

Here, ğ‘› is the number of output signals of the network;
ğ‘¢ğ‘˜ğ‘‘ and ğ‘¢ğ‘˜ are desired and current output values of the network (ğ‘˜ = 1, . . . , ğ‘›), respectively. The parameters ğ‘¤ğ‘—ğ‘˜ , ğ‘ğ‘–ğ‘— , ğ‘ğ‘—
(ğ‘– = 1, . . . , ğ‘š, ğ‘— = 1, . . . , ğ‘Ÿ, ğ‘˜ = 1, . . . , ğ‘›) in consequent part
of network and the parameters of membership functions ğ‘ğ‘–ğ‘—
and ğœğ‘–ğ‘— (ğ‘– = 1, . . . , ğ‘š, ğ‘— = 1, . . . , ğ‘Ÿ) in the premise part of
FNN structure are adjusted as
ğ‘¤ğ‘—ğ‘˜ (ğ‘¡ + 1) = ğ‘¤ğ‘—ğ‘˜ (ğ‘¡) âˆ’ ğ›¾

ğœ•ğ¸
ğœ•ğ‘¤ğ‘—ğ‘˜

+ ğœ† (ğ‘¤ğ‘—ğ‘˜ (ğ‘¡) âˆ’ ğ‘¤ğ‘—ğ‘˜ (ğ‘¡ âˆ’ 1)) ;

4. Parameter Updates

ğ‘ğ‘–ğ‘— (ğ‘¡ + 1) = ğ‘ğ‘–ğ‘— (ğ‘¡) âˆ’ ğ›¾

In the fuzzy IF-THEN rules (2), the antecedent part represents the input space by dividing the space into a set of
fuzzy regions and the consequent part describes the system

ğ‘ğ‘— (ğ‘¡ + 1) = ğ‘ğ‘— (ğ‘¡) âˆ’ ğ›¾

ğœ•ğ¸
+ ğœ† (ğ‘ğ‘–ğ‘— (ğ‘¡) âˆ’ ğ‘ğ‘–ğ‘— (ğ‘¡ âˆ’ 1)) ;
ğœ•ğ‘ğ‘–ğ‘—

ğœ•ğ¸
+ ğœ† (ğ‘ğ‘— (ğ‘¡) âˆ’ ğ‘ğ‘— (ğ‘¡ âˆ’ 1)) ;
ğœ•ğ‘ğ‘—

(9)

6

BioMed Research International
10000

9500

9500

9000

9000

8500

8500

8000

8000

0

50

100

150

200

250

300

350

400

7500

0

50

100

150

(a)

200

250

300

350

400

(b)

Figure 5: EEG signals for five channels: (a) neutral pose and (b) positive gesture pose.

ğ‘ğ‘–ğ‘— (ğ‘¡ + 1) = ğ‘ğ‘–ğ‘— (ğ‘¡) âˆ’ ğ›¾

ğœ•ğ¸
+ ğœ† (ğ‘ğ‘–ğ‘— (ğ‘¡) âˆ’ ğ‘ğ‘–ğ‘— (ğ‘¡ âˆ’ 1)) ;
ğœ•ğ‘ğ‘–ğ‘—

ğœğ‘–ğ‘— (ğ‘¡ + 1) = ğœğ‘–ğ‘— (ğ‘¡) âˆ’ ğ›¾

ğœ•ğ¸
+ ğœ† (ğœğ‘–ğ‘— (ğ‘¡) âˆ’ ğœğ‘–ğ‘— (ğ‘¡ âˆ’ 1)) ;
ğœ•ğœğ‘–ğ‘—

Here, ğ‘– = 1, . . . , ğ‘š, ğ‘— = 1, . . . , ğ‘Ÿ, ğ‘˜ = 1, . . . , ğ‘›.

(10)

ğ‘– = 1, . . . , ğ‘š; ğ‘— = 1, . . . , ğ‘Ÿ; ğ‘˜ = 1, . . . , ğ‘›,

ğœ•ğ¸
= ğ‘¢ğ‘˜ (ğ‘¡) âˆ’ ğ‘¢ğ‘˜ğ‘‘ (ğ‘¡) ;
ğœ•ğ‘¢ğ‘˜
ğœ•ğ‘¢ğ‘˜ ğ‘¦ğ‘— âˆ’ ğ‘¢ğ‘˜
=
;
ğœ•ğœ‡ğ‘— âˆ‘ğ‘›ğ‘—=1 ğœ‡ğ‘—
ğœ•ğœ‡ğ‘— (ğ‘¥ğ‘– )

where m is the number of input signals of the network (input
neurons) and ğ‘Ÿ is the number of fuzzy rules (hidden neurons).
ğ›¾ is the learning rate; ğœ† is the momentum.
The derivatives in (9) are computed as

ğœ•ğ¸ ğœ•ğ‘¢ğ‘˜
ğœ•ğ¸
=
=
ğœ•ğ‘¤ğ‘—ğ‘˜ ğœ•ğ‘¢ğ‘˜ ğœ•ğ‘¤ğ‘—ğ‘˜

(ğ‘¢ğ‘˜ (ğ‘¡) âˆ’ ğ‘¢ğ‘˜ğ‘‘ (ğ‘¡))
âˆ‘ğ‘›ğ‘—=1 ğœ‡ğ‘—

â‹… ğ‘¦1ğ‘—

,

âˆ‘ğ‘˜ (ğ‘¢ğ‘˜ (ğ‘¡) âˆ’ ğ‘¢ğ‘˜ğ‘‘ (ğ‘¡)) â‹… ğ‘¤ğ‘˜ğ‘— ğœ‡ğ‘— ğ‘¥ğ‘–
âˆ‘ğ‘›ğ‘—=1 ğœ‡ğ‘—

âˆ‘ğ‘˜ (ğ‘¢ğ‘˜ (ğ‘¡) âˆ’ ğ‘¢ğ‘˜ğ‘‘ (ğ‘¡)) â‹… ğ‘¤ğ‘˜ğ‘— ğœ‡ğ‘—
âˆ‘ğ‘›ğ‘—=1 ğœ‡ğ‘—

ğœ•ğœğ‘–ğ‘—

ğœğ‘–ğ‘—2

(13)
;

2

= ğœ‡ğ‘— (ğ‘¥ğ‘– )

2 (ğ‘¥ğ‘– âˆ’ ğ‘ğ‘–ğ‘— )
ğœğ‘–ğ‘—3

.

5. Experiments and Results

,
(11)

ğœ•ğ¸
ğœ•ğ¸ ğœ•ğ‘¢ğ‘˜ ğœ•ğ‘¦1ğ‘— ğœ•ğ‘¦ğ‘—
=
ğœ•ğ‘ğ‘— ğœ•ğ‘¢ğ‘˜ ğœ•ğ‘¦1ğ‘— ğœ•ğ‘¦ğ‘— ğœ•ğ‘ğ‘—
=

ğœ•ğœ‡ğ‘— (ğ‘¥ğ‘– )

2 (ğ‘¥ğ‘– âˆ’ ğ‘ğ‘–ğ‘— )

Using (11)â€“(13), the derivatives in (9) and (10) are calculated and the correction of the parameters of FNN is carried
out.

ğœ•ğ¸
ğœ•ğ¸ ğœ•ğ‘¢ğ‘˜ ğœ•ğ‘¦1ğ‘— ğœ•ğ‘¦ğ‘—
=
ğœ•ğ‘ğ‘–ğ‘— ğœ•ğ‘¢ğ‘˜ ğœ•ğ‘¦1ğ‘— ğœ•ğ‘¦ğ‘— ğœ•ğ‘ğ‘–ğ‘—
=

ğœ•ğ‘ğ‘–ğ‘—

= ğœ‡ğ‘— (ğ‘¥ğ‘– )

,

here ğ‘– = 1, . . . , ğ‘š, ğ‘— = 1, . . . , ğ‘Ÿ, ğ‘˜ = 1, . . . , ğ‘›.
In (10), the derivatives are determined as
ğœ•ğ¸
ğœ•ğ¸ ğœ•ğ‘¢ğ‘˜ ğœ•ğœ‡ğ‘—
=âˆ‘
,
ğœ•ğ‘ğ‘–ğ‘—
ğœ•ğ‘¢ğ‘˜ ğœ•ğœ‡ğ‘— ğœ•ğ‘ğ‘–ğ‘—
ğ‘˜
ğœ•ğ¸
ğœ•ğ¸ ğœ•ğ‘¢ğ‘˜ ğœ•ğœ‡ğ‘—
=âˆ‘
.
ğœ•ğœğ‘–ğ‘—
ğœ•ğ‘¢
ğ‘˜ ğœ•ğœ‡ğ‘— ğœ•ğœğ‘–ğ‘—
ğ‘˜

(12)

The BCI system is simulated and used in real life applications.
The EEG signals are measured with signal acquisition unit,
the Emotiv EPOC headset. In the experiments, we have
utilised 14 channels for measuring EEG signals. The measured
EEG signals have different rhythms within the frequency
band. The experiments show that measuring brain signals
is difficult so we have tested our system using brain muscle
signals. As an example, the signals obtained from 5 sample
channels are shown in Figure 5. Figure 5(a) depicts a neutral
pose, patient relaxing and not doing anything. Figure 5(b)
depicts a positive gesture. As shown in the figures, the
EEG signals with positive gesture pose are changing more
frequently than a neutral pose. In the paper, the FFT is
applied to extract important features of the signal. After the
preprocessing stage, given in Section 2, the important features
of these signals are extracted and used for classification
purpose. The number of extracted features was determined
as 100. These signals are inputs for FNN system. Outputs of
FNN model are clusters. The following clusters are used in the
experiment: move forward, move backward, turn left, turn
right, and turn on and turn off the switch. For each cluster,
the system recorded 10 seconds of data.
In this paper, the classification of the EEG signals is
performed using FNN model. For this purpose, the FNN
structure with hundred input and six output neurons is
generated. In the papers [27, 29], the neurofuzzy systems have

BioMed Research International

7
Table 1: Classification results.

Number of rules
5
6
9
16

Correctly classified instances
92%
100%
100%
100%

Incorrectly classified instances
3
0
0
0

Training RMSE
0.465492
0.223264
0.152714
0.047268

Evaluation RMSE
0.464918
0.241625
0.153688
0.048324

Test RMSE
0.476516
0.257986
0.153874
0.048262

Table 2: Comparison of classification results.

Linear logistic regression model
SVM (polynomial kernel)
SVM (RBF kernel)
SVM (PUK kernel)
MLP (NN) (5 hidden neurons)
MLP (NN) (6 hidden neurons)
NaÄ±Ìˆve Bayesian
Random Tree
Random Forest
FNN (6 hidden neurons)

Correctly
classified
instances

Incorrectly classified instances

Mean absolute error

Root mean squared error

96%
100%
74%
96%
88%
100%
94%
74%
98%
100%

4%
0
26%
4%
12%
0
6%
26%
2%
0

0.0214
0.24
0.2568
0.2424
0.0724
0.048
0.024
0.104
0.1215
1.823

0.1265
0.3162
0.3404
0.32
0.1586
0.0958
0.1549
0.3225
0.179
0.257986

been efficiently applied for different classification problems. If
we use these structures for 100 inputs and 2 cluster centres,
2100 rules should be generated. The rules are constructed
using all possible combinations of inputs and cluster centres.
This is a very large number. In this paper, the number of rules
is selected according to the clustering results, equal to cluster
centres.
Fuzzy ğ‘ means classification is used in order to design
the premise parts of (2) and to determine the parameters
of Gaussian membership functions used in the second layer
of FNN. In experiments, different cluster numbers, 5, 6, 9,
and 16, are used to design FNN structure. These experiments
have been done in order to increase the performance of
classification system. At first, FCM clustering is used for
the input space with 6 clusters for each input. Six fuzzy
rules are designed using a different combination of these
clusters for 100 inputs. After clustering input space gradient
descent algorithm is applied for learning of consequent parts
of the fuzzy rules, that is, parameters of the 4th layer of
FNN. In learning of FNN, 10-fold cross validation is used for
separation of the data into training and testing set.
The initial values of the parameters of FNN are randomly
generated in the interval [âˆ’1, 1] and, using the gradient
algorithm derived above, they are updated for the given
input-output training pairs. As a performance criterion,
RMSE is used. Figure 6 depicts the evolution of the RMSE
values over 1000 epochs.
For training of the FNN, 1000 epochs are used. As a
result of training, the values of the parameters of the FNN
system were determined. Once the FNN has been successfully
trained, it is then used for the classification of the EEG signals.
During learning, the value of RMSE was obtained as 0.223264

0.8
0.7
0.6
0.5
RMSE

Method

0.4
0.3
0.2
0.1
0

0

200

400
600
Epoch number

800

1000

Figure 6: Training of FNN.

for training data and 0.241625 for evaluation. After learning,
for the test data, the value of RMSE was obtained as 0.257986
with 100% accuracy of classification. Figure 6 depicts RMSE
values obtained during training. The design of FNN model is
performed using a different number of rules. Table 1 includes
results of simulations with 5, 6, 9, and 16 rules, respectively.
As shown, accuracy of FNN classification model is 100%.
For comparison purpose, we test the system using different classification techniques. As a result of the classification,
the following results are obtained (Table 2). In the table, the
classification results of FNN model are compared against

8
linear logistic regression model [36], SVM with various
kernels, multilayer perceptron (MLP) with various hidden
layers, NaÄ±Ìˆve Bayes classifier [37], Random Tree, and Random
Forest [38]. As shown, the simulation results demonstrate the
efficiency of application of FNN model in the classification
of EEG signals. These clusters activate the corresponding
control signal which is then used to actuate the motors of the
wheelchair.

6. Conclusion
The paper presents the design of BCI based on FNN for a
wheelchair. The emotional and muscular states of the user
are evaluated for control purposes. The design of BCI has
been done to actuate a brain-controlled wheelchair using six
mental activities of the user: move backward, move forward,
turn left, turn right, turn on, start, and stop. For classification
of EEG signals, the FNN with 10-fold cross validation data set
is used. The design of the FNN system is implemented using
fuzzy ğ‘ means classification and gradient descent algorithm.
The obtained 100% classification results prove that the used
techniques are a potential candidate for the classification
of the EEG signals in the design of brain-based control
system. In the future, we are going to improve the number of
commands for control of wheelchair and decrease detection
time of the EEG signal used for measuring brain activities and
design efficient brain-controlled wheelchair.

BioMed Research International

[7]

[8]

[9]

[10]

[11]

[12]

[13]

Competing Interests
The authors declare that they have no competing interests.

[14]

References
[1] F. Velasco-AÌlvarez and R. Ron-Angevin, â€œAsynchronous braincomputer interface to navigate in virtual environments using
one motor imagery,â€ in Bio-Inspired Systems: Computational and
Ambient Intelligence, J. Cabestany, F. Sandoval, A. Prieto, and
J. M. Corchado, Eds., vol. 5517 of Lecture Notes in Computer
Science, pp. 698â€“705, Springer, Berlin, Germany, 2009.
[2] F. GalaÌn, M. Nuttin, D. Vanhooydonck et al., â€œContinuous
brain-actuated control of an intelligent wheelchair by human
EEG,â€ in Proceedings of the 4th International Brain-Computer
Interface Workshop and Training Course, pp. 315â€“320, TU
Graz/BuÌˆroservice, Graz, Austria, 2008.
[3] R. Leeb, D. Friedman, G. R. MuÌˆller-Putz, R. Scherer, M. Slater,
and G. Pfurtscheller, â€œSelf-paced (asynchronous) BCI control
of a wheelchair in virtual environments: a case study with a
tetraplegic,â€ Computational Intelligence and Neuroscience, vol.
2007, Article ID 79642, 8 pages, 2007.
[4] R. Scherer, F. Lee, A. SchloÌˆgl, R. Leeb, H. Bischof, and G.
Pfurtscheller, â€œToward self-paced brain-computer communication: navigation through virtual worlds,â€ IEEE Transactions on
Biomedical Engineering, vol. 55, no. 2, pp. 675â€“682, 2008.
[5] A. Fattouh, O. Horn, and G. Bourhis, â€œEmotional BCI control of
a smart wheelchair,â€ International Journal of Computer Science
Issues, vol. 10, no. 3, pp. 32â€“36, 2013.
[6] V. Khare, J. Santhosh, S. Anand, and M. Bhatia, â€œBraincomputer interface based real time control of wheelchair using

[15]

[16]

[17]

[18]

[19]

[20]

[21]

electroencephalogram,â€ International Journal of Soft Computing
and Engineering (IJSCE), vol. 1, no. 5, 2011.
M. A. Sharbafi, C. Lucas, and R. Daneshvar, â€œMotion control
of omni-directional three-wheel robots by brain-emotionallearning-based intelligent controller,â€ IEEE Transactions on Systems, Man and Cyberneticsâ€”Part C: Applications and Reviews,
vol. 40, no. 6, pp. 630â€“638, 2010.
Y. Chae, J. Jeong, and S. Jo, â€œToward brain-actuated humanoid
robots: asynchronous direct control using an EEG-Based BCI,â€
IEEE Transactions on Robotics, vol. 28, no. 5, pp. 1131â€“1144, 2012.
T. Shi, H. Wang, and C. Zhang, â€œBrain Computer Interface
system based on indoor semi-autonomous navigation and
motor imagery for Unmanned Aerial Vehicle control,â€ Expert
Systems with Applications, vol. 42, no. 9, pp. 4196â€“4206, 2015.
T. Carlson, R. Leeb, R. Chavarriaga, and J. del R Millan,
â€œThe birth of the brain-controlled wheelchair,â€ in Proceedings
of the 25th IEEE/RSJ International Conference on Robotics
and Intelligent Systems (IROS â€™12), pp. 5444â€“5445, Vilamoura,
Portugal, October 2012.
B. Rebsamen, C. Guan, H. Zhang et al., â€œA brain controlled
wheelchair to navigate in familiar environments,â€ IEEE Transactions on Neural Systems and Rehabilitation Engineering, vol.
18, no. 6, pp. 590â€“598, 2010.
I. Iturrate, J. M. Antelis, A. KuÌˆbler, and J. Minguez, â€œA noninvasive brain-actuated wheelchair based on a P300 neurophysiological protocol and automated navigation,â€ IEEE Transactions
on Robotics, vol. 25, no. 3, pp. 614â€“627, 2009.
G. Vanacker, J. del R MillaÌn, E. Lew et al., â€œContext-based
filtering for assisted brain-actuated wheelchair driving,â€ Computational Intelligence and Neuroscience, vol. 2007, Article ID
25130, 12 pages, 2007.
R. H. Abiyev, N. Akkaya, E. Aytac, I. GuÌˆnsel, and A. CÌ§agÌ†ma,
â€œBrain based control of wheelchair,â€ in Proceedings of the
World Congress in Computer Science, Computer Engineering,
and Applied Computing (ICAI â€™15), Las Vegas, Nev, USA, July
2015.
L. Cao, J. Li, H. Ji, and C. Jiang, â€œA hybrid brain computer
interface system based on the neurophysiological protocol
and brain-actuated switch for wheelchair control,â€ Journal of
Neuroscience Methods, vol. 229, pp. 33â€“43, 2014.
F. Lotte and C. Guan, â€œRegularizing common spatial patterns to
improve BCI designs: unified theory and new algorithms,â€ IEEE
Transactions on Biomedical Engineering, vol. 58, no. 2, pp. 355â€“
362, 2011.
X. Song and S.-C. Yoon, â€œImproving brain-computer interface
classification using adaptive common spatial patterns,â€ Computers in Biology and Medicine, vol. 61, pp. 150â€“160, 2015.
R. Salazar-Varas and D. GutieÌrrez, â€œAn optimized feature
selection and classification method for using electroencephalographic coherence in brain-computer interfaces,â€ Biomedical
Signal Processing and Control, vol. 18, pp. 11â€“18, 2015.
E. Hortal, D. Planelles, A. Costa et al., â€œSVM-based BrainMachine Interface for controlling a robot arm through four
mental tasks,â€ Neurocomputing, vol. 151, no. 1, pp. 116â€“121, 2015.
Y. Fang, M. Chen, and X. Zheng, â€œExtracting features from
phase space of EEG signals in brain-computer interfaces,â€
Neurocomputing, vol. 151, no. 3, pp. 1477â€“1485, 2015.
M. Kaur and P. Tanwar, â€œDeveloping brain-computer interface
using fuzzy logic,â€ International Journal of Information Technology and Knowledge Management, vol. 2, no. 2, pp. 429â€“434, 2010.

BioMed Research International
[22] R. Chai, S. H. Ling, G. P. Hunter, Y. Tran, and H. T. Nguyen,
â€œBrain-computer interface classifier for wheelchair commands
using neural network with fuzzy particle swarm optimization,â€
IEEE Journal of Biomedical and Health Informatics, vol. 18, no.
5, pp. 1614â€“1624, 2014.
[23] S. Darvishi and A. Al-Ani, â€œBrain-computer interface analysis
using continuous wavelet transform and adaptive neuro-fuzzy
classifier,â€ in Proceedings of the Annual International Conference
of the IEEE Engineering in Medicine and Biology Society, vol.
2007, pp. 3220â€“3223, Lyon, France, August 2007.
[24] R. H. Abiyev, R. A. Aliev, and R. R. Aliev, â€œThe synthesis of
fuzzy control system with neural networks based tuner,â€ News of
Academy of Sciences, Tech. Cybernetics, no. 2, pp. 192â€“197, 1994.
[25] R. A. Aliev, R. H. Abiyev, and R. R. Aliev, â€œSynthesis of industrial
neural controllers,â€ in Proceedings of the IEEE International
Conference on Neural Networks, 1994. IEEE World Congress on
Computational Intelligence, vol. 1â€“7, pp. 1644â€“1649, San Diego,
Colif, USA, July 1994.
[26] R. Abiyev, â€œNeuro-Fuzzy system for technological processes
control,â€ in Proceedings of the 6th World Multi-Conference on
Systemics, Cybernetics and Informatics, vol. 12, SCI-20002, pp.
249â€“253, Orlando, Florida, USA, July 2002.
[27] J.-S. R. Jang, C.-T. Sun, and E. Mizutani, Neuro-Fuzzy and Soft
Computing, chapter 17, Prentice-Hall, New Jersey, NJ, USA, 1997.
[28] J.-T. Lu, Y.-C. Chang, and C.-Y. Ho, â€œThe optimization of chiller
loading by adaptive neuro-fuzzy inference system and genetic
algorithms,â€ Mathematical Problems in Engineering, vol. 2015,
Article ID 306401, 10 pages, 2015.
[29] Q. H. Do and J.-F. Chen, â€œA neuro-fuzzy approach in the classification of studentsâ€™ academic performance,â€ Computational
Intelligence and Neuroscience, vol. 2013, Article ID 179097, 7
pages, 2013.
[30] J. C. Bezdek, Pattern Recognition with Fuzzy Objective Function
Algoritms, Plenum Press, New York, NY, USA, 1981.
[31] S. L. Chiu, â€œFuzzy model identification based on cluster estimation,â€ Journal on Intelligent Fuzzy Systems, vol. 2, pp. 267â€“278,
1994.
[32] K. Demirli and P. Muthukumaran, â€œHigher order fuzzy system
identification using subtractive clustering,â€ Journal of Intelligent
and Fuzzy Systems, vol. 9, no. 3-4, pp. 129â€“158, 2000.
[33] N. K. Kasabov and Q. Song, â€œDENFIS: dynamic evolving
neural-fuzzy inference system and its application for time-series
prediction,â€ IEEE Transactions on Fuzzy Systems, vol. 10, no. 2,
pp. 144â€“154, 2002.
[34] R. H. Abiyev, â€œFuzzy wavelet neural network based on fuzzy
clustering and gradient techniques for time series prediction,â€
Neural Computing and Applications, vol. 20, no. 2, pp. 249â€“259,
2011.
[35] R. H. Abiyev and O. Kaynak, â€œType 2 fuzzy neural structure
for identification and control of time-varying plants,â€ IEEE
Transactions on Industrial Electronics, vol. 57, no. 12, pp. 4147â€“
4159, 2010.
[36] N. Landwehr, M. Hall, and E. Frank, â€œLogistic model trees,â€
Machine Learning, vol. 59, no. 1, pp. 161â€“205, 2005.
[37] G. H. John and P. Langley, â€œEstimating continuous distributions
in bayesian classifiers,â€ in Proceedings of the 11th Conference on
Uncertainty in Artificial Intelligence, pp. 338â€“345, San Mateo,
Calif, USA, 1995.
[38] L. Breiman, â€œRandom forests,â€ Machine Learning, vol. 45, no. 1,
pp. 5â€“32, 2001.

9

International Journal of

Peptides

BioMed
Research International
Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Advances in

Stem Cells
International
Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Virolog y
Hindawi Publishing Corporation
http://www.hindawi.com

International Journal of

Genomics

Volume 2014

Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Journal of

Nucleic Acids

Zoology

International Journal of

Hindawi Publishing Corporation
http://www.hindawi.com

Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Volume 2014

Submit your manuscripts at
http://www.hindawi.com
The Scientific
World Journal

Journal of

Signal Transduction
Hindawi Publishing Corporation
http://www.hindawi.com

Genetics
Research International
Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Anatomy
Research International
Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Enzyme
Research

Archaea
Hindawi Publishing Corporation
http://www.hindawi.com

Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Volume 2014

Hindawi Publishing Corporation
http://www.hindawi.com

Biochemistry
Research International

International Journal of

Microbiology
Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

International Journal of

Evolutionary Biology
Volume 2014

Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Molecular Biology
International
Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Advances in

Bioinformatics
Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

Journal of

Marine Biology
Volume 2014

Hindawi Publishing Corporation
http://www.hindawi.com

Volume 2014

