VOL. 12, NO. 5, MARCH 2017

ISSN 1819-6608

ARPN Journal of Engineering and Applied Sciences
©2006-2017 Asian Research Publishing Network (ARPN). All rights reserved.

www.arpnjournals.com

DEVELOPMENT OF A SYSTEM OF DETECTION AND PREDICTION
OF SOMNOLENCE THROUGH ELECTROENCEPHALOGRAPHIC
SIGNAL PROCESSING
J. Salgado Patrón, J. Cruz Sanabria and I. Ávila Vidal
Universidad Surcolombiana, Neiva, Colombia
E-Mail: josesalgadop@usco.edu.co

ABSTRACT
This paper presents an algorithm for the processing of EEG electroencephalographic signals with the objective of
detecting drowsiness and wakefulness stages, mainly directed at individuals prone to cause accidents due to fatigue and/or
numbness. The device selected for the acquisition of EEG records used during the development of this project is EPOC +,
designed and manufactured by Emotiv Systems. Electroencephalographic samples, regularly contaminated by artifacts,
must be subjected to a pre-processing step before proceeding with the logical steps in the characterization process. The
artifact attenuation process was performed using the Wavelet discrete transform along with the soft threshold method, to
then reconstruct the signal with its inverse transform. By means of the power spectral density function, we proceed to
determine the stages of wakefulness and drowsiness. From this process, it was possible to extract six characteristics per
channel, to construct a final vector of 84 characteristics, which represent a window of time of four seconds of duration. The
Gaussian kernel support vector machine algorithm was the finally chosen supervised learning technique, which was
responsible for the procedures for classifying and recognizing patterns that would establish the state of the person and with
which it was reached 92% of accuracy.
Keywords: EEG, EPOC+, artifact, PSD, wavelet transform, thresholding, SVM.

INTRODUCTION
Drowsiness is the state in which a person tends to
sleep during the day, usually at different times to regular
sleeping, its main cause lies in poor sleep habits and
becomes a problem when it leadsto the subject to fall
asleep in inappropriate situations. (Pérez, 2016)
Drowsiness can be classified in two according to its origin,
physiological drowsiness, related to age or with specific
situations, such as Premenstrual Syndrome PMS,
pregnancy, intense physical exercise, among others; and
pathological somnolence, which manifests itself when
there is a disease that originates it. (Health, 2016)
The current rhythm of life has tried and achieved
that the process of sleep becomes altered by factors such
as stress, depression and work addiction, producing bad
habits of rest, which lead to intensify the ailments that
already each human has.In addition, creates new ones such
as
neurodegenerative
conditions,
gastrointestinal
disorders, increased appetite and obesity, directly affecting
the quality of life of individuals, affecting their work
performance, personal relationships and increasing the risk
of accidents.
According to the epidemiological bulletin issued
in December 2007 by the National Institute of Forensic
Medicine and Forensic Sciences of Colombia, there are
studies in different countries that have documented that
traffic accidents tend to be more frequent between
midnight, dawn and late in the afternoon, coinciding
curiously with the peaks tending to normal sleep in the
general population. (Forensic Services Expert Reference
Division, 2007).
A permanent vigil for more than 17 hours is
sometimes similar to having consumed an amount of
alcohol similar to the maximum limit allowed to drive.

Hence, hypersomnia decreases labor productivity and
social functioning in affected people. In Colombia, the
effects of hypersomnia on the health of workers are
unknown, with shift workers being more vulnerable, such
as health workers, night watchmen, pilots, military
personnel, drivers, among others. (Espectador, 2009)
ELECTROENCEPHALOGRAPHY AND
SOMNOLENCE
Brain electrical activity
The brain is composed of two kinds of cells:
neurons and glial cells, the latter being greater in quantity
by a factor of ten compared to neurons; (Kandel,
Schwartz, & Jessell, 2000). In addition, the different
classes have structural support, metabolic and
development modulation functions.
Neurons are the functional units of the nervous
system; they play the role of fundamental, structural and
functional units of the brain. It is estimated that within the
cerebral cortex there are between 15,000 and 30,000
million neurons and each of them is interconnected with
up to 10,000 synaptic connections, having as a specialty
the communication between cells through the generation,
transmission and reception of signals (Portellano, 2005)
The transmission of information and sensations
within the brain is produced by the activity of substances
capable of causing the transmission of nerve impulses,
these are called neurotransmitters. These, in turn, are
received in dendrites and are emitted in axons, where the
former are ramifications that connect with other cells and
the latter, a long extension of the body of the cell ending in
branches through of which the neuron can communicate

1620

VOL. 12, NO. 5, MARCH 2017

ISSN 1819-6608

ARPN Journal of Engineering and Applied Sciences
©2006-2017 Asian Research Publishing Network (ARPN). All rights reserved.

www.arpnjournals.com
through electrical signals with other cells (Portellano,
2005).
Electroencephalogram
Electroencephalography is the collection and
evaluation of brain bioelectrical activity originated by
brain neurons in basal conditions of rest, in wakefulness or
sleep, and during various activations. This can be
performed in isolation or associated with simultaneous and
synchronized videographic recording of the patient. (Diaz,
2012)
The frequencies of these waves move between
0.5 and 100 Hz and depend greatly on the degree of
activity of the cerebral cortex. In turn, this large range of
frequencies is divided into 5 bands called "cerebral
rhythms", which is given more detail later. The amplitude
of the registers may vary depending on the location of the
electrodes, if they are located on the surface (scalp) this
can be 100 μV and if it is in the cerebral cortex, it can
reach 10 mV.
Any unwanted interference that may affect the
biological signal studied is considered an artifact and these
can be classified according to the source that generates
them in physiological and external. The former have as
main source the body of the subjects themselves, while the
latter come from outside the body, such as the
environment or other measuring instruments, for example.
(Tandle & Jog, 2015)
Emotiv EPOC+
EPOC + is the second version of the popular
EPOC designed and distributed by Emotiv Systems. It is a
device that allows BCI and is used in different applications
in this area. It is not considered a medical device, but it
allows the EEG capture. As can be seen in Table 1, it has a
significant number of channels.

Alpha "α"(from 8 Hz to 14 Hz), Beta" "(from 14 to 30
Hz) and Gamma" "(frequencies above 30 Hz).

Figure-1. EEG waveforms.
https://www.computer.org/csdl/mags/co/2012/07/mco2012
070087-abs.html
In the following table, is shown the most relevant
characteristics of each cerebral rhythm, necessary to carry
out the analysis of the EEG signal for the detection of the
state of drowsiness
Table-2. EEG Rhythms.

Delta

Frequency
range
0.5 – 4 Hz

Theta

4 – 8 Hz

Alpha

8 – 14 Hz

Beta

14 – 30 Hz

Gamma

> 30 Hz

Rhythm

Table-1. Characteristics of Emotiv EPOC+.
Characteristic
Number of
channels
Channel names
Sampling method
Sampling rate

Description
14 (plus CMS/DRL references,
P3/P4 locations)
AF3, F7, F3, FC5, T7, P7, O1, O2,
P8, T8, FC6, F4, F8, AF4
Sequential sampling. Single ADC

Filtering

128 SPS (2048 Hz internal)
14 bits 1 LSB = 0.51µV (16-bit
ADC, 2 bits instrumental noise
floor discarded)
0.2 – 45 Hz, digital notch filters at
50 Hz and 60 Hz
Built in digital 5th order Sinc filter

Connectivity

Proprietary Wireless, 2.4GHz band

Resolution
Bandwidth

Brain rhythms
The brain rhythms allude to the electrical activity
produced by the brain, which is subdivided into Delta "δ"
(from 0.5 Hz to 4 Hz), Theta "θ" (from 4 Hz to 8 Hz),

Location

Charasteristic

Frontal lobe
Temporal
and parietal
lobe
Frontal and
occipital
lobe
Frontal lobe
and central
area

Deep sleep

---

Drowsiness and
meditation
Relaxation and
vigil with eyes
closed
Action, work
and
concentration
Anxiety and
panic.
Cognitive
functions

It can be stated from Table-2, that Theta and
Alpha activities are necessary for the identification of
drowsiness and / or states of relaxation (Dkhil, Neji, Wali,
& Alimi, 2015).Thus, the transition between wakefulness
and sleep is produced by the decrease in Alpha power and
the increase in Theta frequency.
Sleep phases
There are two stages in the sleep period, called
the slow sleep phase or the non-REM sleep phase, and the
REM sleep phase (Rapid Eye Movement). The REM sleep
is divided, in turn, into four phases with different
characteristics.

1621

VOL. 12, NO. 5, MARCH 2017

ISSN 1819-6608

ARPN Journal of Engineering and Applied Sciences
©2006-2017 Asian Research Publishing Network (ARPN). All rights reserved.

www.arpnjournals.com
In Figure-2, the distribution of the five phases is
shown alternating cyclically while the person remains
asleep (every 90/100 minutes approximately, a new sleep
cycle begins in which the last 20 or 30 minutes correspond
to the REM phase)

Figure-2. Sleep phases.
http://www.centerforsoundsleep.com/sleepdisorders/stages-of-sleep.
In Table-3, it is described the behavior of the
organism as it enters each stage of sleep, which do not
necessarily occur sequentially as shown in the graph
above.
Table-3. Sleep phases description.
Phase
I
II
III
IV
REM

Description
Light sleep. Drowsiness. The person is still
able to perceive most of the stimuli. Sleep is
little or nothing at all.
Decrease muscle tone, blocking sensory
information, facilitating sleep.
Decreases blood pressure and breathing rate.
Sensory block intensifies.
Greater depth of sleep. Muscle tone too low.
Deficits of this phase cause daytime
drowsiness.
It activates the central nervous system.
Presence of dreams. Paralysis prevents the
person from materializing what he dreams.

EEG SIGNAL PREPROCESSING
It starts with the acquisition of the signal from a
SDK with GNU license that allows to capture data from
the Emotiv EPOC +. Samples were taken within a set
period of 300 seconds (5 minutes) at a sample rate of 128
SPS (Samples per Second) and in each session it was
possible to capture between 12 and 18 samples.
Figure-3 shows the signals acquired through
channel F3, in drowsiness and wakefulness states.

Figure-3. Raw EEG signals fromF3.
All the dimensions of the signal must be on the
same scale, since it is easier to make decisions when
classifying EEG signals (Russell, Norvig, Canny, Malik,
& Edwards, 2003). A simple approximation is to compute
the mean and standard deviation of the values in each
dimension, and normalize them according to their values.
Windowing
In the bibliography consulted (Russell, Norvig,
Canny, Malik, & Edwards, 2003), sampling windows of 1
or 2 seconds were established in order to analyze the EEG
signal as stationary in small moments. However,
considering that most of these investigations were
performed with EEG equipment of high resolution and
high sampling frequency, it was decided to experiment
with different window times, to finally choose 4 seconds
as minimum window duration.
In addition, an overlap of 50% is applied to the
window to ensure that no signal information is lost,
allowing the distinction to be made between one state and
another.
IIR Butterworth filtering
Infinite Impulse Response (IIR) filters are types
of digital filters, which, as their acronym indicates, if their
input is a pulse signal, the output will have an infinite
number of nonzero terms. Which means that it never
returns to rest (Martínez, Gómez, Serrano, Vila, & d
'Enginyeria Department d'Enginyeria Electrònica, 2009).
This type of filters have poles and zeros that determine the
stability and causality of the system.
The properties of these filters are very similar to
those of the FIR (Finite Impulse Response) filters, but they
have a great advantage over these, and they can meet the
same requirements, with a lower filter order, leading to a
smaller computational expense.
Butterworth filters are among the basic filters.
These are obtained by imposing that the response in

1622

VOL. 12, NO. 5, MARCH 2017

ISSN 1819-6608

ARPN Journal of Engineering and Applied Sciences
©2006-2017 Asian Research Publishing Network (ARPN). All rights reserved.

www.arpnjournals.com
magnitude of the filter is as flat as possible (with
minimum ripple) in the pass band up to the cut-off
frequency and makes its approximation through the
criterion of maximum uniformity in the pass band
(Oppenheim, Willsky, & Nawab, 1983).
Knowing the characteristics of the filters suitable
for the present case, and bearing in mind that the quality of
the measured EEG signal is usually evaluated by how high
its Signal Noise Ratio (SNR) is,the objective is to
maximize the amplitude of the signal while minimizing
the noise, choosing to apply a 5th order Butterworth IIR
band pass filter between 0.2 Hz and 35 Hz.
The filter order was chosen by means of
empirical tests on a bank of 30 samples made to a single
subject only by varying this parameter in the range of 1 to
10, with 5 being the value that offered the best response
(Figure-4).

(www.pybytes.com, Discrete Wavelet Transform (DWT),
2012).
With the decomposition at different frequency
levels, it continues applying soft thresholding, this to
finish attenuating parasitic frequency values that may
affect the EEG signal in some way (Rodríguez & Bueno,
2010).
In order to apply the DWT, the parameters
chosen were Wavelet Mother Symlet type, 4thorder, with a
window of 512 samples, duration of 4 seconds and
sampling period of 128 Hz. With these parameters, it was
obtained Table-4 containing the approximation
coefficients and Table-5 containing the coefficient of
detail.
Table-4. Approximation coefficients.
D1

64 – 32 Hz

D2

32 – 16 Hz

D3

16 – 8 Hz

D4

8 – 4 Hz

D5

4 – 2 Hz

D6

2 – 1 Hz

Table-5. Coefficient of detail.
A7

1 – 0 Hz

Figure-5 shows the graphs obtained when
applying the DWT together with the soft-threshold
technique.

Figure-4. EEG signals from F3 after the Butterworth
IIR filter was applied.
Discrete Wavelet TRANSFORM (DWT)
The Wavelet Transform has recently become very
popular when it comes to analysis, de-noising and
compression of signals and images; this is a mathematical
function that allows data to be obtained from a signal by
dividing them into smaller frequency-time components,
facilitating their analysis separately (Cano, Salcedo, &
Soto, 2010)
Compared with the Fourier transform, the
Wavelet Transform allows working on non-stationary
waves with discontinuities or peaks and is distinguished
by its multiresolution capability (Samir Kouro & Rodrigo
Musalem, 2002).
The DWT Wavelet Discrete Transformation
allows a multilevel analysis through different frequency
windows, by means of which the threshold level (in this
case soft threshold) can be found that will be applied to the
signals to attenuate the impurities and obtain EEG content

Figure-5. EEG signal from F3 after the DWT application.
After the soft thresholding processes are applied
to the detail and approximation coefficients, the signal is
reconstructed for further processing, by means of the

1623

VOL. 12, NO. 5, MARCH 2017

ISSN 1819-6608

ARPN Journal of Engineering and Applied Sciences
©2006-2017 Asian Research Publishing Network (ARPN). All rights reserved.

www.arpnjournals.com
Inverse Discrete Wavelet Transform (Inverse Discrete
Wavelet Transform) & De Castro Fernandez, 2002).
The signal that is decomposed in different
windows must be reconstructed from a reverse filter bank
that was used for its decomposition in multilevel, which is
why it is vitally important that the mother wave of
decomposition and reconstruction be the same, in this case
Symlet 4.
PROCESSING AND CHARACTERIZATION OF
THE EEG SIGNAL
After the process of pre-processing of the signal
where the artifacts that distorted the EEG were attenuated,
the EEG was processed in order to take on characteristics
of the sleep or vigil states. For this reason it is used the
analysis of the signal by the Power Spectral Density PSD
(Power Spectral Density), which is in a plane of frequency
vs power where each frequency value is assigned a Power
value that results from the calculation of Fast Fourier
Transform FFT (Fast Fourier Transform) (Proakis &
Manolakis, 2007) (Garces, Orosco, & Laciar, 2014).
As explained in the previous section, the EEG
signal is analyzed as a stationary wave in windows of 4
seconds duration at 128 SPS, resulting in 512 samples.
When applying FFT in order to obtain a PSD for the
window, the first 256 values offer frequency information
between 0 Hz and 64 Hz, which obeys the Nyquist
criterion (Figure-6).

Figure-6. PSD of EEG signals after preprocessing stage.
Characteristics extraction
Based on the doctoral thesis of Agustina Garcés,
who takes 6 characteristics of the signal to determine
states of drowsiness using a classifier based on neural
networks with an average accuracy percentage of 84%
(Garcés, Orosco, & Laciar, 2014), and also complemented
by the work proposed by Anindya Bijoy Das and
Mohammed Imamul Hassan Bhuiyan (Das & Bhuiyan,
2016), where the entropy processes of the PSD are present,

the following method of characterization of the signal is
proposed, considering the parameters that are exposed
later.
The energy band between 4 Hz and 8 Hz is of
vital importance in detecting early drowsiness; therefore,
its calculation from the PSD in this frequency band can be
taken as a key feature to differentiate between both states
(Garcés Correa, Brain Signal Processing for Drivers
Drowsiness., 2011). Theta is the EEG rhythm present in
this band, and as it is know its characteristics, the greater
presence of this rhythm, the more evident the appearance
of drowsiness in a person; (Bermudez, Laencina,
González, & Dorda, 2012). In this study, it was found that
the number of people with a high level of sleep
deprivation was higher than in the previous years.
The energy band between 8 Hz and 12 Hz
provides equally important characteristics in the early
detection of drowsiness (Garcés Correa, Brain Signal
Processing for Conductor Drowsiness Detection, 2011).
Alpha is the EEG rhythm present in this band, and as its
characteristics are known, the greater presence of this
rhythm more evident will be the appearance of
somnolence in a person, also its energetic concentration
becomes greater in the early stages of sleep and when the
patient's eyes are closed (Bermudez, Laencina, González,
González, & Dorda, 2012).
The maximum power usually concentrates in low
frequencies, emphasizing that it is located between 5Hz
and 7Hz for a state of wakefulness; And below 1Hz for
drowsiness. The frequency that contains the maximum
power is considered a differential characteristic between
wakefulness and drowsiness (Garcés Correa, Brain Signal
Processing for the Dysnolence Detection in Conductors,
2011).
As shown in previous work, taking the entropy to
characterize the EEG signal in the window of short
duration, proves to be a very efficient method to
distinguish
between
the
dominance
of
an
electroencephalographic rhythm and another (Chai, et al.,
2016) (Das & Bhuiyan, 2016). Shannon's entropy
measures the uncertainty of the signal and was introduced
mainly as part of information theory (Proakis &
Manolakis, 2007) (Das & Bhuiyan, 2016). Its
mathematical concept measures the probability of the
logarithm of probability with which a data can be repeated
in a given signal.
𝐻𝑠ℎ𝑎

𝑁

= ∑ 𝑝𝑖 ∗ log 𝑝𝑖
𝑖=

The entropy of the energy logarithm measures the
irregularity of the spectrum of the signal produced by its
PSD. A high number of this entropy indicates that the
signal is highly regular (Das & Bhuiyan, 2016), being thus
determined that in sleep states the energy concentration is
grouped in low frequencies; Therefore, its value is lower
in comparison to the entropy of the vigil state, where the
signal energy is mostly distributed up to a frequency of
30Hz. This entropy is calculated from:

1624

VOL. 12, NO. 5, MARCH 2017

ISSN 1819-6608

ARPN Journal of Engineering and Applied Sciences
©2006-2017 Asian Research Publishing Network (ARPN). All rights reserved.

www.arpnjournals.com
𝑁

𝐻log𝐸𝑛𝑒𝑟𝑔𝑦 = ∑ log 𝑝𝑖
𝑖=

Renyi's entropy measures how random the data
that makes up the PSD of the signal to be analyzed are, a
high number in this entropy means a highly random signal
(Das & Bhuiyan, 2016), typical PSD trait for a sample in
vigil state,because in drowsiness the signal is more
concentrated in a band and the rest of its energy
distribution is very symmetrical with each other.
𝐻𝑅𝑒

𝑦𝑖

𝑁

= −log ∑ 𝑝𝑖
𝑖=

Up to this point,six defined characteristics have
been obtained for each four-second EEG window. The
information is taken from the 14 channels available on the
Emotiv EPOC +, obtaining 84 features per window.
Principal Component Analysis (PCA)
The Principal Component Analysis (PCA) is a
statistical technique that evaluates a list of parameters and
chooses only those that are orthogonal to each other. This
is done with the objective of reducing the number of
parameters to be analyzed and leaving only those that are
highly separable, providing relevant information for the
classifier (Bishop, 2007) (Proakis & Manolakis, 2007).
This method allows obtaining a set of
characteristics that are not correlated with each other,
which efficiently increases the classification and allows to
make even more differentiable one state of the other
(Pajares & de la Cruz Garcia, 2011).
By means of different experiments and observing
the incidence of decreased characteristics obtained, it is
observed that the number of PCA's that needs a classifier
to discern between a state of wakefulness and one of
drowsiness, is intrinsically linked to the type of classifier
used. Which means that the number of major signal
components expected to be obtained should be analyzed in
conjunction with the classifier design.

Dorda, 2012). It was developed by Vladimir Vapnik and
his team at AT&T Laboratories (Pedregosa, et al., 2011).
This algorithm takes the different training vectors and
begins to raise them to a hyperplane whose dimension is
much larger than the original, so that one can be reached,
where a border can be drawn between vectors from one
state to another, in order to provide a prediction for future
unknown vectors.Among its main advantages is that SVM
uses a convex classification process (Pedregosa, et al.,
2011), that is, that its training will always give the same
result for the same group of parameters and hyperparameters, offering an advantage over other methods
such as neural networks whose function is not convex.
Classifier hyperparameters
Kernel: sets the way in which the vectors or
characteristics will be divided into a hyperplane of order
much higher than the original of the vectors to be
classified (Bishop, 2007). There are different types of
kernel, in this case a Gaussian kernel of radial basis was
used, that traces a Gaussian border between the data, with
the objective of separating them and making them
differentiable with each other.
C: It is a penalty parameter that tells the SVM
how tight the kernel adjustment method will be (Bishop,
2007). If itis had a very low C, the training will be very
permissive and the kernel will not be adjusted efficiently,
giving space to a sub-training (Pedregosa, et al., 2011). In
the opposite case, with a large C, a kernel function is
obtained that is highly adjusted to the training data, which
leads to the system being unable to predict data that does
not approach the value of the support vectors.
In Figure-7 it can be seen how the
hyperparameter C varies in different levels in the correct
detection, being the one of the left overtraining, the one of
the center the correct training and the one of the right the
subtraining.

ALGORITHM OF RECOGNITION AND
CLASSIFICATION OF PATTERNS
Support Vector Machines (SVM)
A classifier is a computational algorithm that,
through supervised learning, is able to model or learn a
series of data in order to be able to discern between two or
more types of data. The classification labels for the
characteristics vector obtained are "Awake" for the vigil
state and "Asleep" for the state of drowsiness. The
classifier algorithm used is the Support Vector Machine
(SVM) with a radial base Gaussian Kernel.
SVM is a supervised and parametric algorithm,
very popular in the field of classification and recognition
of parameters in the digital processing of biomedical
signals (Bishop, 2007) (Bengio, Courville, & Vincent,
2013) (Bermúdez, Laencina, González, González, &

Figure-7. Graphical representations of the variation of the
hyperparameter C (Pedregosa et al, 2011).
Gamma: It is the hyperparameter of Gaussian
variance (Bishop, 2007). A small Gamma indicates that
the kernel function will have high variance and little
polarization, which determines the influence that some
vectors will have on the classification to be considered
support vectors, which means that if Gamma is not chosen
correctly, it could cause the Vectors to be predicted are
incorrectly classified by not estimating very well the
variance of their gaussianity (Pedregosa et al., 2011)

1625

VOL. 12, NO. 5, MARCH 2017

ISSN 1819-6608

ARPN Journal of Engineering and Applied Sciences
©2006-2017 Asian Research Publishing Network (ARPN). All rights reserved.

www.arpnjournals.com

Hyperparameter

Value

Number of PC

linspace (35,75,2)

have the same blocks for acquisition, pre-processing and
signal processing. In the training system, one-time tasks
are performed (parallel tasks are shown in Figure-8), while
the pattern recognition and classification system is cyclical
and is executed whenever it attempts to recognize patterns
ofdrowsiness or wakefulness through a previous history of
EEG obtained from the Emotiv EPOC +.
The division of this process into two systems may
facilitate the integration of the same into different
computers, taking into account that the training process
generates a higher computational cost than the process of
classification and recognition of EEG patterns.
The system has a high accuracy in the process of
detection of early drowsiness intrapersonal level, so it will
be necessary to train it for each individual who intends to
use it.
The test results of the radial Kernel SVM
designed and tuned for classification between states of
sleepiness and wakefulness are shown below.

C

logspace (10^-1, 10^5, 20)

Table-7. Training indicators for radial SVM testing.

Gamma

logspace (10^-7, 10^0, 20)

Cross validation

5

Resultant Pipeline Sets

38400

Classifier design
Once the parameter matrix, the characteristic
vector, and the hyperparameters to be tuned are
established, it is necessary to set the percentage of the data
that will be used for the training and the validation, and
which will be used for the classifier test. Classically, 80%
of the data are taken for training and validation, and finally
the remaining 20% for testing (Pedregosa et al., 2011).
From the above, a training pipeline is proposed to
combine parameters and hyperparameters in different
ways, in order to obtain the best possible intrapersonal
classifier. The pipeline is carried out using the Python
Scikit-Learn library, in which the following
hyperparameters were set:
Table-6. Hyperparameters for the pipeline.

RESULTS AND DISCUSSIONS
The proposed methodology makes a correct
detection between records of sleep and wake states at the
intrapersonal level. The system proposed in this document
meets high standards in the detection of drowsiness, even
though it is compared with the results obtained with highend medical equipment
The Emotiv EPOC + was sufficient to obtain the
signals that could be processed and classified. They serve
as a basis for applications for the detection of drowsiness
in drivers, operators and other people who require
permanent monitoring in their work, without the risk of
falling into a state of numbness. This state is sometimes
visually imperceptible, but easily perceived by the
potential changes in the frequency bands that make up the
EEG.
This work proposes the implementation of a
training system and a pattern recognition system, which

Label

Precision

Sensitivity

F-score

Vectors

Asleep

98 %

88 %

93 %

146

Awake

87 %

98 %

92 %

111

From the above it can be can see that the
algorithm is more accurate than sensible in drowsiness,
being completely inverse in wakefulness, due to this the
accuracy of the algorithm is almost the same for any of the
two states; This is because the records used for training
were more for drowsiness than for wakefulness, producing
such effects.
The results also show how a Gaussian kernel
SVM can make a highly efficient separation between two
frequency-differentiable states, opening a window to the
automation of drowsiness detection for supervised tasks.
EEG is the most reliable way to obtain
physiological information related to sleepiness and
wakefulness; a very important contribution is made to
process this signal with different types of applications
such as supervision of drivers and operators who perform
repetitive tasks requiring a high state of attention.

1626

VOL. 12, NO. 5, MARCH 2017

ISSN 1819-6608

ARPN Journal of Engineering and Applied Sciences
©2006-2017 Asian Research Publishing Network (ARPN). All rights reserved.

www.arpnjournals.com
Vector of states discriminated by
windows

Film history of the session

Emotiv
EPOC

Acquisition and storage of
samples during the session

Power Spectral
Density

Power Spectral
Density

Six level ITDWT with
Symlet 4 Mother

Features
extraction

Samples
loading

Soft
umbralization

Features
normalization

Sample windowing every 2 seconds
with window duration of 4 seconds

Multilevel WDT of six levels
with Symlet 4 Mother

Principal Components
Analisys

IIR Butterworth
filter

Radial Kernel SVM
Training

Pattern Recognition and states
classification with Radial Kernel SVM

Awake

Asleep

Signal
normalization

Determination
of the state

Data Processing

Figure-8. General block diagram of the proposed system.
CONCLUSIONS
BCI systems are the future for assistance and
monitoring of people's activities in order to avoid
accidents. The proposed methodology allows the design of
a signal processing system at the digital level, which is
able to characterize and recognize patterns of brain signals
characteristic of wakefulness and drowsiness.
The combination of classical preprocessing
methods such as LTI filters and contemporaries such as
DWT allow attenuating the artifacts enough to be able to
characterize the EEG signal at a frequency level through a
PSD, and later by PCA find the most relevant
characteristics of each state. Finally, vigilance or
drowsiness patterns are recognized through a radial kernel
SVM with an accuracy of 92%.
The proposed system for classification and
pattern recognition proves to be highly functional
intrapersonally without the need for expensive EEG
equipment. The opportunities that are opened with this
methodology are especially numerous taking into account
that it is a scalable system to embedded and portable
equipment.
The heart of the project is in the radial kernel
SVM classifier, which proved to be a robust algorithm for
classification because of its convex error function, which
always guarantees proper training if the hyper parameters,
signal parameters and classifier are the same.
This kind of kernel was necessary because the
data obtained physiologically are not as separable from
each other, or at least in a linear fashion. A Gaussian
kernel offers the possibility of a nonlinear separation with
a significantly lower training cost than if one were
working with a polynomial kernel.

REFERENCES
Alipoor M., Pooyan M. & Suratgar A. A. April de 2010.
Classification of EEG signals in four groups, including
healthy subjects with open/closed eyes and epilepsy
subjects with/without seizure by PSD estimate (using the
multitaper method) and ANN. Health Informatics and
Bioinformatics (HIBIT), 2010 5th International
Symposium on. (pp. 98-103).
AlSharabi K., Ibrahim S., Djemal R. & Alsuwailem A.
March de 2016. A DWT-entropy-ANN based architecture
for epilepsy diagnosis using EEG signals. 2016 2nd
International Conference on Advanced Technologies for
Signal and Image Processing (ATSIP). (pp. 288-291).
Ambulkar N. K. & Sharma S. N. Sept de 2015. Detection
of epileptic seizure in EEG signals using window width
optimized S-transform and artificial neural networks. 2015
IEEE Bombay Section Symposium (IBSS). (pp. 1-6).
Bengio Y., Courville A. & Vincent P. Aug de 2013)
Representation Learning: A Review and New
Perspectives. Pattern Analysis and Machine Intelligence,
IEEE Transactions on. 35(8): 1798-1828.
Bermúdez G. R., Laencina P. J., González J. L., González
J. R. & Dorda J. R. April de 2012. Técnicas de
reconocimiento de patrones para la clasificación de señales
EEG en sistemas BCI. En U. P. de Cartagena (Ed.), V
Jornadas de Introducción a la investigación en la UPCT
2012, 5, p. 3.
Bishop, C. M. (2007). Pattern Recognition and Machine
Learning (6 ed.). (M. Jordan, Ed.) Springer.

1627

VOL. 12, NO. 5, MARCH 2017

ISSN 1819-6608

ARPN Journal of Engineering and Applied Sciences
©2006-2017 Asian Research Publishing Network (ARPN). All rights reserved.

www.arpnjournals.com
Buitinck L., Louppe G., Blondel M. a., Mueller A., Grisel,
O. a., Prettenhofer P., Varoquaux G. 2013. API design for
machine learning software: experiences from the scikitlearn project. ECML PKDD Workshop: Languages for
Data Mining and Machine Learning. pp. 108-122.
Cattaneo C. A., Larcher L. I., Ruggeri A. I., Herrera A. C.
& Biasoni E. M. 2011. Métodos de Umbralización de
Imágenes Digitales Basados en Entrop\́ia de Shannon y
Otros. Asociación de Mecánica Computacional Argentina.
30, 2785-2805.
Chai R., Naik G., Nguyen T. N., Ling S., Tran Y., Craig
A. & Nguyen H. 2016. Driver Fatigue Classification with
Independent Component by Entropy Rate Bound
Minimization Analysis in an EEG-based System. IEEE
Journal of Biomedical and Health Informatics. pp. 1-1.
Chai R., Smith M. R., Nguyen T. N., Ling S. H., Coutts A.
J. & Nguyen H. T. Aug de 2015. Comparing features
extractors in EEG-based cognitive fatigue detection of
demanding computer tasks. 2015 37th Annual International
Conference of the IEEE Engineering in Medicine and
Biology Society (EMBC). pp. 7594-7597.
Correa A. G., Orosco L. & Laciar E. 2014. Automatic
detection of drowsiness in EEG records based on
multimodal analysis. Medical engineering & physics. 36.
Daphne R. R. & Raj A. A. 2012. A Drowsiness Detection
Architecture using Feature Extraction Methodology.
Procedia Engineering. 38(0): 959-963.
Das A. B. & Bhuiyan M. I. 2016. Discrimination and
classification of focal and non-focal EEG signals using
entropy-based features in the EMD-DWT domain .
Biomedical Signal Processing and Control. 29: 11-21.
Dkhil M. B., Neji M., Wali A. & Alimi A. M. May de
2015. A new approach for a safe car assistance system.
Advanced Logistics and Transport (ICALT), 2015 4th
International
Conference
on.
(pp.
217-222).
doi:10.1109/ICAdLT.2015.7136627.
Duda R. O., Hart P. E. & Stork D. G. 2001. Pattern
Classification (2 ed.). (W.-I. Publication, Ed.) Library of
Congress Cataloging-in-publication Data.
Espectador E. (Ed.). 2 de 2009. Cerca de la mitad de
accidentes de tránsito se producen por sueño.
Genomics I. & Bioinformatics. 2008. Cross-Validation
Explained. Tech. rep., Graz University of Applied
Sciences.
Garcés Correa A. 2011. Procesamiento de Señales
cerebrales para la Detección de Somnolencia en
Conductores. Ph.D. dissertation, Universidad Nacional de
San Juan.

Garcés Correa A. & Laciar Leber E. Aug de 2010. An
automatic detector of drowsiness based on spectral
analysis and wavelet decomposition of EEG records.
Engineering in Medicine and Biology Society (EMBC),
2010 Annual International Conference of the IEEE. pp.
1405-1408.
Garcés Correa A. & Laciar Leber E. Aug de 2010. An
automatic detector of drowsiness based on spectral
analysis and wavelet decomposition of EEG records.
Engineering in Medicine and Biology Society (EMBC),
2010 Annual International Conference of the IEEE. pp.
1405-1408.
Garcés A., Orosco L. & Laciar E. 2014. Automatic
detection of drowsiness in {EEG\} records based on
multimodal analysis . Medical Engineering & Physics.
36(2): 244-249.
Guerrero Martínez J. F. 2010. Tema 4: Procesado Digital
de Bioseñales. Escola Tècnica Superior d' Enginyeria.
Guo C., Lu F., Liu S. & Xu W. Dec de 2015. Sleep EEG
Staging Based on Hilbert-Huang Transform and Sample
Entropy. 2015 International Conference on Computational
Intelligence and Communication Networks (CICN). (pp.
442-445).
Hazarika N., Tsoi A. C. & Sergejew A. Apr de 1997.
Nonlinear considerations in EEG signal classification.
Signal Processing, IEEE Transactions on. 45(4): 829-836.
Jirayucharoensak S. & Israsena P. 2013. Automatic
removal of EEG artifacts using ICA and Lifting Wavelet
Transform. Computer Science and Engineering
Conference (ICSEC), 2013 International. pp. 136-139.
Jo J., Lee S. J., Park K. R., Kim I.-J. & Kim J. 2014.
Detecting driver drowsiness using feature-level fusion and
user-specific classification . Expert Systems with
Applications. 41(4, Part 1): 1139-1152.
Kandel E. R., Schwartz J. H. & Jessell T. M. 2000.
Principles of Neural Science. McGraw-Hill.
Lerga J., Saulig N., Mozetic V. & Lerga R. July de 2016.
Number of EEG signal components estimated using the
short-term
Renyi
entropy.
2016
International
Multidisciplinary Conference on Computer and Energy
Science (SpliTech), (pp. 1-6).
Li P., Yan C., Karmakar C. & Liu C. Aug de 2015.
Distribution entropy analysis of epileptic EEG signals.
2015 37th Annual International Conference of the IEEE
Engineering in Medicine and Biology Society (EMBC),
pp. 4170-4173.
Lin C.-T., Wu R.-C., Liang S.-F., Chao W.-H., Chen Y.-J.
& Jung T.-P. Dec de 2005. EEG-based drowsiness
estimation for safety driving using independent component

1628

VOL. 12, NO. 5, MARCH 2017

ISSN 1819-6608

ARPN Journal of Engineering and Applied Sciences
©2006-2017 Asian Research Publishing Network (ARPN). All rights reserved.

www.arpnjournals.com
analysis. IEEE Transactions on Circuits and Systems I:
Regular
Papers,
52,
2726-2738.
doi:10.1109/TCSI.2005.857555.

Samir Kouro R. & Rodrigo Musalem M. 7 de 2002.
Tutorial introductorio a la Teoría de Wavelet. Técnicas
Modernas en Automática.

Malo D. J. & de Castro Fernandez R. M. 2002. Análisis de
la teoría de ondículas orientada a las aplicaciones en
ingeniería eléctrica: Fundamentos. unpublished.

Sinha A., Chatterjee D., Das R., Datta S., Gavas R. &
Saha S. K. Oct de 2015. Artifact Removal from EEG
Signals Recorded Using Low Resolution Emotiv Device.
Systems, Man, and Cybernetics (SMC), 2015 IEEE
International
Conference
on.
pp.
1445-1451.
doi:10.1109/SMC.2015.256.

Manuel I. & Núñez B. 6 de 2010. EEG Artifact Detection.
Department of Cybernetics - Czech Technical University
in Prague.
Merzagora A. C., Bunce S., Izzetoglu M. & Onaral B. Aug
de 2006. Wavelet analysis for EEG feature extraction in
deception detection. Engineering in Medicine and Biology
Society, 2006. EMBS '06. 28th Annual International
Conference of the IEEE. pp. 2434-2437.
Ming M., Shaona L., Haitao M., Yuliang M. & Yunyuan
G. July de 2015. Feature extraction method of motor
imagery EEG based on DTCWT sample entropy. Control
Conference (CCC), 2015 34th Chinese, (pp. 3964-3968).
Murugavel A., Ramakrishnan S., Balasamy K. &
Gopalakrishnan T. Dec de 2011. Lyapunov features based
EEG signal classification by multi-class SVM.
Information and Communication Technologies (WICT),
2011 World Congress on. pp. 197-201.
Núñez B. & Manuel I. 2011. EEG artifact detection. Ph.D.
dissertation, Doctoral dissertation.
Pedregosa F., Varoquaux G., Gramfort A., Michel V.,
Thirion B., Grisel O., Duchesnay E. 2011) Scikit-learn:
Machine Learning in Python. Journal of Machine Learning
Research. 12, 2825-2830.
Phothisonothai M. & Nakagawa M. Aug de 2008. EEG
signal classification method based on fractal features and
neural network. Engineering in Medicine and Biology
Society, 2008. EMBS 2008. 30th Annual International
Conference of the IEEE. pp. 3880-3883.
Portellano J. A. 2005. Introducción a la Neuropsicología.
(J. M. Cejudo, Ed.) McGraw-Hill.
Proakis J., & Manolakis D. 2007. Tratamiento digital de
señales. Pearson Educacion.
Rajeev S., Bilas P. R. & U., R. A. 2015. Application of
Entropy Measures on Intrinsic Mode Functions for the
Automated Identification of Focal Electroencephalogram
Signals. Entropy.

Sun S. & Zhou J. July de 2014. A review of adaptive
feature extraction and classification methods for EEGbased brain-computer interfaces. Neural Networks
(IJCNN), 2014 International Joint Conference on. pp.
1746-1753.
Systems E. 2014. EMOTIV EPOC & TESTBENCH
SPECIFICATIONS
Systems E. 2014. EMOTIV EPOC+ 14 Channel Mobile
EEG.
Systems E. 2015. Comparison Chart - Epoc+ vs Insight.
Tandle A. and Jog N. 2015. Classification of Artefacts in
EEG Signal Recordings and Overview of Removing
Techniques. International Journal of Computer
Applications.
Wang Z., Quan X., Gong D. and Yu C. Sept de 2008.
Study
of
signal
processing
system
for
Electroencephalogram based on TMS320LF2407.
Automation Congress, 2008. WAC 2008. World, (pags. 14).
www.ehu.eus. 9 de 2016. Resumen de las Características
de los Filtros Analógicos de Butterworth y Chebyshev.
www.pybytes.com. 8 de 2012.
Transform (DWT). (S. 1.1.3, Editor)

Discrete

Wavelet

www.pybytes.com. 8 de 2012. Inverse Discrete Wavelet
Transform (IDWT). (S. 1.1.3, Editor)
Yeo M. V., Li X., Shen K. and Wilder-Smith E. P. 2009.
Can SVM be used for automatic EEG detection of
drowsiness during car driving? Safety Science. 47(1): 115124.
Yu W., Zhuang F., He Q. & Shi Z. 2015. Learning deep
representations via extreme learning machines .
Neurocomputing. 149, Part A(0): 308-315.

Rodríguez O. J. & Bueno D. A. 2010. Determinación De
Los Parámetros Asociados Al Filtro Wavelet Por
Umbralización Aplicado A Filtrado De Interferencias
Electrocardiográficas. Revista Uis Ingenieras, 6.

1629

