1 Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

Practical Designs of Brain-Computer Interfaces Based on the
Modulation of EEG Rhythms
Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao
Department of Biomedical Engineering, School of Medicine, Tsinghua University,
Beijing, China 100084 (gsk-dea@tsinghua.edu.cn)

1. Introduction
A brain-computer interface (BCI) is a communication channel which does
not depend on the brain’s normal output pathways of peripheral nerves and
muscles [1-3]. It supplies paralyzed patients with a new approach to communicate
with the environment. Among various brain monitoring methods employed in
current BCI research, electroencephalogram (EEG) is the main interest due to its
advantages of low cost, convenient operation and non-invasiveness. In
present-day EEG-based BCIs, the following signals have been paid much
attention: visual evoked potential (VEP), sensorimotor mu/beta rhythms, P300
evoked potential, slow cortical potential (SCP), and movement-related cortical
potential (MRCP) [4]. These systems offer some practical solutions (e.g., cursor
movement and word processing) for patients with motor disabilities.
In this chapter, practical designs of several BCIs developed in Tsinghua
University will be introduced. First of all, we will propose the paradigm of BCIs
based on the modulation of EEG rhythms and challenges confronting practical
system designs. In Section 2, modulation and demodulation methods of EEG
rhythms will be further explained. Furthermore, practical designs of a VEP-based
BCI and a motor imagery based BCI will be described in section 3. Finally,
Section 4 will present some real-life application demos using these practical BCI
systems.

1.1 BCIs Based on the Modulation of Brain Rhythms
Many of the current BCI systems are designed based on the modulation of
brain rhythms. For example, power modulation of mu/beta rhythms is used in the

2 Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

BCI system based on motor imagery [5]. Besides, phase modulation is another
method which has been employed in a steady-state visual evoked potential
(SSVEP) based BCI [6]. More generally, evoked potentials can be considered to
result partially from a reorganization of the phases of the ongoing EEG rhythms
[7].
From the viewpoint of psychophysiology, EEG signals are divided into five
rhythms in different frequency bands: delta rhythm (0.1-3.5Hz), theta rhythm
(4-7.5Hz), alpha rhythm (8-13Hz), beta rhythm (14-30Hz), and gamma rhythm
(>30Hz) [8]. Although the rhythmic character of EEG has been observed for a
long period, many new studies on the mechanisms of brain rhythms emerged after
the 1980s. So far, the cellular bases of EEG rhythms are still under investigation.
The knowledge of EEG rhythms is limited; however, numerous neurophysiologic
studies indicate that brain rhythms can reflect changes of brain states caused by
stimuli from the environment or cognitive activities. For example, EEG rhythms
can indicate working state or idling state of the functional areas of the cortex. It is
known that the alpha rhythm recorded over the visual cortex is considered to be
an indicator of activities in the visual cortex. The clear alpha wave while eyes are
closed indicates the idling state of the visual cortex, while the block of the alpha
rhythm when eyes are open reflects the working state of the visual cortex.
Another example is mu rhythm, which can be recorded over the sensorimotor
cortex. A significant mu rhythm only exists during the idling state of the
sensorimotor cortex. The block of mu rhythm accompanies activation of the
sensorimotor cortex.
Self control of brain rhythms serves an important function in brain-computer
communication. Modulation of brain rhythms is used here to describe the
detectable changes of EEG rhythms. BCIs based on the modulation of brain
rhythms recognize changes of specific EEG rhythms induced by self-controlled
brain activities. In our studies, we focus on EEG rhythms located in the frequency
band of alpha and beta rhythms (8-30Hz). Compared with the low-frequency
evoked potentials, these components have several advantages as follows:

3 Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

1) Affected less by artifacts. The lower frequency components are always
easily affected by the artifacts introduced by electrooculogram (EOG) and
electromyogram (EMG). For example, removal of the eye movement artifact is an
important procedure in event-related potential (ERP) processing, whereas it can
be omitted in analyzing mu/beta rhythms after specific band-pass filtering.
2) More stable and lasting, and thus with a higher signal-to-noise ratio
(SNR). Modulation of these rhythms can last for a relatively long period (e.g.,
several seconds), while transient evoked potentials only occur within several
hundred milliseconds. Therefore, it is more promising to realize single-trial
identification for high-frequency brain rhythms. Moreover, due to the
phase-locked character of the evoked potentials, strict time precision is necessary
for data alignment in the averaging procedure, while analysis of the power-based
changes of the high-frequency rhythms permits a lower precision, and thus
facilitates online designs of hardware and software.
3) More applicable signal processing techniques. For wave-based analysis of
evoked potentials, analysis is always done in the temporal domain. However, for
the high-frequency rhythms, various temporal and frequency methods (e.g.,
power and coherence analysis methods in the temporal and frequency domains,
respectively) can be applied to extract EEG features. Therefore, the BCI based on
the high-frequency rhythms provides a better platform for studying signal
processing techniques and has a bigger potential in system performance.
Figure 1 is the block diagram of a BCI based on the modulation of brain
rhythms. The control intention of the subject is embedded in the modulated brain
rhythms through specific approaches, e.g., frequency coding or phase coding.
According to the modulation approaches, the signal processing procedure aims to
demodulate the brain rhythms and then extract the features, which will be
translated into control signals to operate the output device. For instance, the
SSVEP-based BCI and the motor imagery based BCI adopt typical approaches of
brain rhythm modulation. The SSVEP system uses detection of frequency-coded
or phase-coded SSVEPs to determine the gaze or spatial selective attention

4 Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

direction of the subject. Unlike the SSVEP BCI, the motor imagery BCI
recognizes spatial distributions of amplitude-modulated mu/beta rhythms
corresponding to the motor imagery states of different body parts. The methods
for demodulating brain rhythms applied in BCIs will be introduced in the next
section.

Brain-Computer Interface
Data
Recording

Brain Rhythm
Demodulation

Device
Control

Feedback

Fig.1. Diagram of a BCI based on the modulation of brain rhythms.

1.2 Challenges Confronting Practical System Designs
The design and implementation of an online system plays an important role
in current BCI research, with the purpose of producing practical devices for
real-life clinical application [9]. Compared with offline data analysis, an online
BCI has difficulties in fulfilling real-time processing, system practicability and
brain-machine co-adaptation. In this chapter, the principle of an online BCI based
on the rhythmic modulation of EEG signals will be proposed. In our studies, two
rhythmic EEG components corresponding to brain activities from the
sensorimotor cortex and the visual cortex, i.e., mu rhythm and SSVEP, have been
investigated and employed in constructing different types of online BCI systems.
After many studies carried out to implement and evaluate demonstration
systems in laboratory settings, the challenge facing the development of practical
BCI systems for real-life applications needs to be emphasized. There is still a long
way to go before BCI systems can be put into practical use. The feasibility for

5 Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

practical application is a serious challenge in the current study. To design a
practical BCI product, the following issues need to be addressed.
1) Convenient and comfortable to use. Current EEG recording systems use
standard wet electrodes, in which electrolytic gel is required to reduce
electrode-skin interface impedance. Using electrolytic gel is uncomfortable and
inconvenient, especially when a large number of electrodes are adopted. An
electrode cap with a large numbers of electrodes is uncomfortable for users to
wear and thus unsuitable for long-term recording. Besides, the preparation for
EEG recording takes a long time, thus making BCI operation boring. Moreover,
recording hardware with a large amount of channels is quite expensive, so that it
is difficult for common users to afford. For these reasons, reducing the number of
electrodes in BCI systems is a critical issue for the successful development of
clinical applications of BCI technology [10].
2) Stable system performance. Considering data recording in unshielded
environments with strong electromagnetic interference, employment of an active
electrode may be much better than a passive electrode. It can ensure that the
recorded signal is insensitive to interference [11]. During system operation, to
reduce the dependence on technical assistance, ad hoc functions should be
provided in the system to adapt to non-stationarity of the signal caused by
changes of electrode impedance or brain state. For example, software should be
able to detect bad electrode contact in real time and automatically adjust
algorithms to be suitable for the remaining good channels.
3) Low-cost hardware. Most BCI users belong to the disabled persons’
community; therefore, the system can not be popularized if it costs too much, no
matter how good its performance is. When considering the following aspects,
reducing system costs while maintaining performance might be expected. On one
hand, to reduce the cost of commercial EEG equipment, a portable EEG recording
system should be designed just to satisfy the requirement of recording the specific
brain rhythms. On the other hand, to eliminate the cost of a computer used for
signal processing in most current BCIs, a digital signal processor (DSP) should be

6 Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

employed to construct a system without dependency on a computer.

2. Modulation and Demodulation Methods for Brain Rhythms
In rhythm modulation-based BCIs, the input of a BCI system is the modulated
brain rhythms with embedded control intentions. Brain rhythm modulation is
realized by executing task-related activities, e.g., attending to one of several
visual stimuli. Demodulation of brain rhythms can extract the embedded
information, which will be converted into a control signal. The brain rhythm
modulations could be sorted into the following three classes: power modulation,
frequency modulation, and phase modulation. For a signal s(t), its analytical
signal z(t) is a complex function defined as:

z (t ) = s (t ) + jsˆ(t ) = A(t )e jφ (t )

(1)

where sˆ(t ) is the Hilbert transform of s(t), A(t) is the envelope of the signal,
and

φ (t ) is the instantaneous phase. Changes of the modulated brain rhythms

can be reflected by A(t) or

φ (t ) . In this section, three examples will be

introduced to present the modulation and demodulation methods for mu rhythm
and SSVEPs. More information about BCI related signal processing methods can
be found in [12].

2.1 Power Modulation/Demodulation of Mu Rhythm
BCI systems based on classifying single-trial EEGs during motor imagery
have developed rapidly in recent years [5, 13, 14]. The physiological studies on
motor imagery indicate that EEG power differs between different imagined
movements in the motor cortex. The event-related power change of brain rhythms
in a specific frequency band is well known as event-related desynchronization
and synchronization (ERD/ERS) [15]. During motor imagery, mu (8-12Hz) and
beta (18-26Hz) rhythms display specific areas of ERD/ERS corresponding to
each imagery state. Therefore, motor imagery can be performed to implement a

7 Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

BCI based on the power modulation of mu rhythms.
The information coding by power modulation is reflected by A(t) in (1). The
features extracted from the modulated mu rhythms for further recognition of the
N-class motor imagery states can be defined as:

fi Power (t ) = Ai (t ), i = 1, 2,...N

(2)

The method by means of the analytical signal presents a theoretical description of
EEG power modulation and demodulation. In real systems, demodulation is
usually realized through estimating power spectral density (PSD) [16]. In online
systems, to reduce computational cost, a practical approach is to calculate
band-pass power in the temporal domain, i.e., calculating the mean value of the
power samples derived from squaring the amplitude samples. Figure 2 shows
three single-trial EEG waveforms and PSDs over the left motor cortex (electrode
C3), corresponding to imaginations of left/right hand and foot movements for one
subject. PSD was estimated by the periodogram algorithm, which can be easily
executed by fast Fourier transform (FFT). Compared to the state of left-hand
imagination, right-hand imagination induces an obvious ERD (i.e., power
decrease), while foot imagination results in a significant ERS characterized as a
power increase.

Visual Cue
Rest

6

Motor Imagery
Power Spectrum Density (uV2)

Foot

Left Hand

ERD
Right Hand
10uV

ERS

Foot

0

0.5

1

1.5

2

2.5

Right Hand

5

Left Hand

4
3
2
1
0

Time (s)

10

15
20
Frequency(Hz)

(a)

(b)

25

30

Fig.2. (a) Examples of single-trial waveforms of mu rhythms on electrode C3
during three different motor imagery tasks. Data were band-pass filtered at

8 Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

10-15Hz. A visual cue for starting motor imagery appears at 0.5 s, indicated by
the dotted line. On electrode C3, ERD and ERS of mu rhythms correspond to
imagination of right hand and foot movements, respectively. (b) Averaged PSDs
on electrode C3 corresponding to three different motor imagery tasks.

2.2 Frequency Modulation/Demodulation of SSVEPs
The BCI system based on VEPs has been studied since the 1970s [17].
Studies on the VEP BCI demonstrate convincing robustness of system
performance through many laboratory and clinical tests [18-24]. The recognized
advantages of this BCI include easy system configuration, little user training, and
a high information transfer rate (ITR). VEPs are derived from the brain’s response
to visual stimulation. SSVEP is a response to a visual stimulus modulated at a
frequency higher than 6 Hz. The photic driving response, which is characterized
by an increase in amplitude at the stimulus frequency, results in significant
fundamental and second harmonics. The amplitude of SSVEP increases
enormously as the stimulus is moved closer to the central visual field. Therefore,
different SSVEPs can be produced by looking directly at one of a number of
frequency-coded stimuli. Frequency modulation is the basic principle of the BCIs
using SSVEPs to detect gaze direction.
s(t) in (1) is supposed to be the frequency-coded SSVEP, and the feature
used for identifying the fixed visual target is the instantaneous frequency, which
can be calculated as:

fi Frequency (t ) =
where

dφi (t )
, i = 1, 2,...N
dt

(3)

φ (t ) is the instantaneous phase, and N is the number of visual targets.

Ideally, the instantaneous frequency of the SSVEP should be in accord with the
stimulation frequency. In a real system, frequency recognition adopts the
approach of detecting the peak value in the power spectrum. The visual target will
induce a peak in the amplitude spectrum at the stimulus frequency. For most
subjects, the amplitudes in the frequency bands on both sides will be depressed,

9 Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

thus facilitating peak detection. Demodulation of a frequency-coded SSVEP is to
search for the peak value in the power spectrum and determine the corresponding
frequency. Figure 3 shows three waveforms of frequency-coded SSVEPs (at 9Hz,
11Hz, and 13Hz, respectively) and their corresponding power spectra. The target
can be easily identified through peak detection in the power spectrum.
5

Power Spectrum Density (uV 2)

9Hz

11Hz

10uV

9Hz
11Hz
13Hz

4

3

2

1

13Hz
0

0.5

1
Time (s)

1.5

2

0

8

(a)

10
12
Frequency (Hz)

14

(b)

Fig.3. (a) Examples of single-trial SSVEP waveforms over the occipital region.
Data were band-pass filtered at 7-15Hz. The stimulation frequencies were 9Hz,
11Hz, and 13Hz. (b) PSDs of the three single-trial SSVEPs. The stimulation
frequency is clearly shown at the peak value of the PSD.

2.3 Phase Modulation/Demodulation of SSVEPs
In the SSVEP-BCI system based on frequency modulation, flickering
frequencies of the visual targets are different. In order to ensure a high
classification accuracy, a sufficient frequency interval should be kept between
two adjacent stimuli and the number of targets will then be restricted. If phase
information embedded in SSVEP can be added, the number of flickering targets
may be increased and a higher ITR can be expected. An SSVEP BCI based on
phase coherent detection was first proposed in [6], and its effectiveness was
confirmed. However, only two stimuli with the same frequency but different
phases were dealt with in their design, and the advantages of phase detection were
not sufficiently shown. Inspired by their work, we tried to further the work by
designing a system with stimulating signals of six different phases under the same

10

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

frequency.
The phase-coded SSVEP can ideally be considered a sine wave at a
frequency similar to the stimulation frequency. Suppose s(t) in (1) is the
phase-coded SSVEP, the feature used for identifying the fixed visual target is the
instantaneous phase:

fi Phase (t ) = φi (t ), i = 1, 2,...N

(4)

The first step of implementing a phase-encoded SSVEP BCI is its stimuli
design. Spots flickering on a computer screen at the same frequency with strictly
constant phase differences are required. For example, a computer screen
refreshing signal (60Hz) can be used as a basic clock to produce stable 10Hz
signals. In our phase modulation-based BCI, six visual targets flickering at the
same frequency of 10Hz but with different phases appear on the screen. The
flashing moments of the visual targets are staggered by one refreshing period of
the screen (1/60 s), and thus produce a phase difference of 60 degrees between
two adjacent stimuli (taking six refreshing periods as 360 degrees). During the
experiment, the subject was asked to gaze at the six targets, respectively, and the
SSVEP was gathered from electrodes located in the occipital region. The initial
phases

φ0i (t ) of the SSVEPs can be obtained through calculating the angle of

the spectrum value at the characteristic frequency simply by the following
formula:

φ0i = angle[

1
K

K

∑ s ( n )e
n =1

i

− j 2π ( f 0 / f s ) n

], i = 1, 2,...N

(5)

where fs is the sampling frequency, f0 is the stimulation frequency, and K is the
data length (the number of samples). The six-target phase-coding SSVEP system
was tested with a volunteer. The results are shown in Fig.4. It is clearly shown that
the SSVEPs and the stimulating signals are stably phase locked. The responses
evoked by stimulating signals with a phase difference of 60 degrees also have a
phase difference of approximately 60 degrees.

11

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao
20

0-degree

0-degree
60-degree
120-degree
180-degree
240-degree
300-degree

15
10

Imagery part

60-degree

120-degree
25uV
180-degree

5
0
-5
-10

240-degree

-15

300-degree
0

0.1

0.2

0.3

0.4

0.5
0.6
Time (s)

0.7

0.8

0.9

(a)

1

-20
-20

-15

-10

-5

0

5

10

15

20

Real part

(b)

Fig.4. (a) Examples of six phase-coded SSVEP waveforms over the occipital
region. The stimulation frequency is 10Hz. Data were preprocessed through
narrow-band filtering at 9-11Hz. (b) Scatter diagram of complex spectrum values
at the stimulation frequency. Horizontal and vertical axes correspond to real and
imaginary parts of the spectrum values. The cross indicates the origin of the
coordinate system.

3. Designs of Practical BCIs
The principles of BCIs based on the modulation of EEG rhythms have been
systematically described above. Toward the aim of practical applications, we have
made great efforts in facilitating system configuration and improving system
performance. According to the practicality issues described in the first section, we
focus on the two aspects: parameter optimization and information processing.
These designs can significantly reduce system cost and improve system
performance. In the present BCI systems, reducing the number of electrodes is
important for developing clinical applications of BCI. Therefore, design of
electrode layout is a common problem for all the BCI systems. In our studies, the
method of bipolar lead was employed. To ensure a stable system performance,
appropriate approaches to information processing play important roles. Frequency
features of SSVEP harmonics have been investigated in our designs for a
frequency-coded system and have shown an increased performance. In the motor

12

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

imagery BCI, phase synchrony measurement has been employed, providing
information in addition to the power feature.

3.1 Designs of a Practical SSVEP-based BCI
The SSVEP BCI based on frequency coding seems to be rather simple in
principle, but a number of problems have to be solved during its implementation.
Among them, lead position, stimulation frequency, and frequency feature
extraction are most important. Due to differences in the subjects’ physiological
conditions, a preliminary experiment was designed to be carried out for a new
user to set the subject-specific optimal parameters. The practicability of the
system has been demonstrated by tests in many normal subjects and some patients
with spinal cord injury (SCI).

Lead Position
The goal of lead selection is to achieve SSVEPs with a high SNR using the
fewest number of electrodes. Only one bipolar lead is chosen as input in our
system. The procedure includes two steps: finding a signal electrode and a
reference electrode. From physiological knowledge, the electrode giving the
strongest SSVEP, which is generally located in the occipital region, is selected as
the signal electrode. The reference electrode is searched under the following
considerations: its amplitude of the SSVEP should be lower, and its position
should lie in the vicinity of the signal electrode so that its noise component is
similar to that of the signal electrode. A high SNR can then be gained when the
potentials of the two electrodes are subtracted, producing a bipolar signal. Most
of the spontaneous background activities are eliminated after the subtraction,
while the SSVEP component is retained. Details of this method can be found in
[24]. According to our experience, although the selection varies between subjects,
once it is selected, it is relatively stable over a period of time. This finding makes
this method feasible for practical BCI application. For a new subject, the
multi-channel recording only needs to be done once for optimization of the lead

13

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

position.

Stimulation Frequency
Three problems related to stimulation frequency must be considered
carefully. The first one concerns false positives. Generally, the SSVEPs in the
alpha region (8-13Hz) have high amplitudes, which can facilitate frequency
detection. However, if the stimulation frequency band overlaps with alpha
rhythms, the spontaneous EEG may be likely to satisfy the criteria of peak
detection even though the user has not performed any intentional action. To
implement an asynchronous BCI that allows the user to operate the system at any
moment, avoidance of false positive is absolutely necessary. The second problem
is about the efficiency of frequency detection. The criteria for confirming a
stimulus frequency is the SNR threshold (SNR is defined as the ratio of EEG
power at the stimulation frequency to the mean power of the adjacent frequency
bands). For most subjects, background components in the SSVEP are depressed,
while the signal amplitude at the stimulus frequency increases enormously.
However, for some subjects, the majority of signal energy still lies within the
region of background alpha activities. In these circumstances, although the
stimulus frequency can be clearly identified, the SNR cannot reach the threshold
predefined, and thus the decision of a command can not be made. Due to these
reasons, some frequency components in the alpha region should be excluded to
avoid the interference of background alpha rhythms effectively. The third
problem concerns the bandwidth of usable SSVEPs. Increasing the number of
visual targets is an effective approach to increase the ITR. It can be realized
through extending the stimulation frequency bandwidth. In our previous study, we
demonstrated that the high-frequency SSVEP (>20Hz) has an SNR similar to the
low-frequency SSVEP [25]. By extending stimulation frequency to a wider range,
a system with more options can be designed and a higher performance can be
expected.

14

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

Frequency Feature
Due to the nonlinearity during information transfer in the visual system,
strong harmonics may often be found in the SSVEPs. For example, in Fig.5, the
SSVEPs elicited by the 9Hz and 10Hz stimulations show characteristic frequency
components with peaks at the fundamental and the second harmonic frequencies
(18Hz and 20Hz, respectively). Muller-Putz et al. investigated the impact of using
SSVEP harmonics on the classification result of a four-class SSVEP-based BCI
[26]. In their study, the accuracy obtained with combined harmonics (up to the
third harmonic) was significantly higher than with only the first harmonic. In our
experience, for some subjects, the intensity of the second harmonic may
sometimes be even stronger than that of the fundamental component. Thus,
analysis of the frequency band should cover the second harmonic and the
frequency feature has to be taken as the weighted sum of their powers, namely:

Pi = α Pf1i + (1 − α ) Pf2 i , i = 1, 2,...N

(6)

where N is the number of targets and Pf1i , Pf 2i are respectively the spectrum
peak values of fundamental and second harmonics of the ith frequency (i.e., ith
target) and

α is the optimized weighting factor that varies between subjects. Its

empirical value may be taken as:

α=

1
N

N

∑ P /(P
i =1

f1i

f1i

)

+ Pf2 i .

(7)

Power Spectrum Density (uV2)

15

9Hz
10Hz

9Hz
10
10Hz
18Hz
20Hz

5

0

6

8

10

12
14
16
Frequency (Hz)

18

20

22

24

15

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

Fig.5. Power spectra of SSVEPs at the O2 electrode for one subject. The
stimulation frequencies were 9Hz and 10Hz. Length of the data used for
calculating the PSD is 4 seconds. The spectra show clear peaks at the
fundamental and the 2nd harmonic frequencies.

3.2 Designs of a Practical Motor Imagery Based BCI
In the study of EEG-based BCI, the system based on imagery movement is
another active theme due to its relatively robust performance for communication
and intrinsic neurophysiological significance for studying the mechanism of
motor imagery [14]. Moreover, it is a totally independent BCI system which is
likely to be more useful for completely paralyzed patients than the SSVEP-based
BCI. Most of the current motor imagery based BCIs are based on characteristic
ERD/ERS spatial distributions corresponding to different motor imagery states.
Figure 6 displays characteristic mappings of ERD/ERS for one subject
corresponding to three motor imagery states, i.e., imagining movements of
left/right hands and foot. Due to the widespread distribution of ERD/ERS,
techniques of spatial filtering, e.g, common spatial pattern (CSP), were widely
used to obtain a stable system performance. However, due to the limit of
electrodes in a practical system, electrode layout has to be carefully considered.
With only a small number of electrodes, searching for new features using new
information processing methods will contribute significantly to classifying motor
imagery states.

Foot

1

Left Hand

0.6

Right Hand

0.6

0.4

0.4

0.2

0.2

0

0

-0.2

-0.2

-0.4

-0.4

0.5

0

-0.5

-1

Fig.6. Mappings of ERD/ERS of mu rhythms during motor imagery. ERD over
hand areas has a distribution with contralateral dominance during hand movement

16

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

imagination. During foot movement imagination, an obvious ERS appears in
central and frontal areas.

Phase Synchrony Measurement
In recent years, measurement of phase coupling (or phase locking) of EEG
or magnetoencephalogram (MEG) has been used for exploring the dynamics of
brain networking [27]. The phase-locking value (PLV) measurement has been
introduced recently to extract EEG features in BCI research [28, 29].
Given sx (t ) and sy (t ) as the signals at electrodes x and y, and φx (t )
and φy (t ) as their corresponding instantaneous phases, the instantaneous phase
difference between the two signals is defined as ∆φ (t ) . ∆φ (t ) is a constant
when the two signals are perfectly synchronized. In scalp EEG signals with low
SNR, the true synchrony is always buried in a considerable background noise;
therefore, a statistical criterion has to be provided to quantify the degree of phase
locking [27]. A single-trial phase-locking value is defined for each individual trial
as:

PLV = e j∆φ (t )
where

⋅

t

t

(8)

is the operator of averaging over time. In the case of completely

synchronized signals, ∆φ (t ) is a constant and PLV is equal to 1. If the signals are
unsynchronized, ∆φ (t ) follows a uniform distribution and PLV approaches 0.
Since supplementary motor area (SMA) and primary motor cortex (M1)
areas are considered primary cortical regions involved in the task of motor
imagery, we investigated EEG synchrony between these regions (i.e., electrode
pairs of FCz-C3, FCz-C4, and C3-C4 shown in Fig. 7). The statistical PLV
obtained through averaging over all trials in each class presents a contralateral
dominance during hand movement imagery, e.g., PLV of C3-FCz has a higher
value during right-hand imagery than that of the left hand. In contrast to C3-FCz

17

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

and C4-FCz, PLV shows a low synchrony level between C3 and C4 and there
exists no significant difference between left- and right-hand imagery. Power
features derived from ERD/ERS indicate the brain activities focused on both M1
areas, while synchronization features introduce additional information from the
SMA areas. Compared with detecting the power change, the synchrony measure
was proved effective to supply additional information of the brain activities in the
motor cortex. Therefore, the combination of power and synchrony features is
theoretically expected to improve the performance of classification. As illustrated
in Table I, the averaged accuracy derived from the synchrony and the power
features was 84.27% and 84.04%, respectively, on three subjects (10-fold
cross-validation with 120 trials per class for each subject). Feature combination
led to an improved performance of 89.76%. The synchrony feature vector consists
of two PLVs of two electrode pairs, i.e., FCz-C3, FCz-C4. The power features are
the band-pass power on C3 and C4 electrodes. A subject-specific band-pass filter
was used to preprocess the EEG data in order to focus on the mu rhythm. PLV
and power features were calculated using a time window corresponding to the
motor imagery period (0.5-6s after a visual cue). More details about the
experiment paradigm can be found in [30]. For feature combination, classification
is applied to the concatenation of the power features and the synchrony features.
Linear discriminant analysis (LDA) was used as the classifier. The multi-class
classifier was designed in a one-versus-one manner.

Table 1. Accuracy (±standard deviation, %) of classifying single-trial EEG during
imagining movements of left/right hands and foot. The dataset of each subject
consists of 360 trials (120 trials per class). Three electrodes, i.e. C3/C4 and FCz,
were used for feature extraction.

Subject

Synchrony

Power

Synchrony+Power

S1

87.47±2.19

84.83±2.47

91.50±1.98

S2

83.25±1.78

86.64±1.97

90.60±1.79

18

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

S3

82.08±2.24

80.64±2.44

87.19±2.12

Mean

84.27

84.04

89.76

Fig.7. Placement of electrodes in the motor imagery based BCI. Electrodes C3
and C4 represent lateral hand areas in M1, and electrode FCz indicates the SMA.
Anatomical regions of the SMA and M1 areas can be found in [31].

Electrode Layout
Since the SMA can be considered zero-phase synchronized with the M1 area
displaying ERD, the power difference between M1 areas can be more significant
if using FCz as the reference electrode [32]. For example, during left-hand
imagination, the subtraction of zero-phase synchronized SFCz(t) from SC4(t) results
in a much lower power, whereas the power of SC3(t) changes slightly after the
subtraction (SC3(t), SC4(t), and SFCz(t) are ear-referenced EEG signals on C3/C4
and FCz, between which the power difference is not very significant). This idea
can be summarized as the following inequality:

SC4 (t ) − S FCz (t )
where

⋅

t

2
t

< SC4 (t )

2
t

< SC3 (t )

2
t

≈ SC3 (t ) − S FCz (t )

2

(9)
t

is the operator of averaging over the left-hand imagination period,

and the power difference between SC3(t) and SC4(t) is due to ERD. Therefore, the
midline FCz electrode is a good reference to extract the power difference between

19

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

left and right hemispheres, because it contains additional information derived
from brain synchronization.
Compared with the approach of concatenating power and synchrony features,
this bipolar approach has the advantages of a lower dimension of the features and
smaller computational cost. A lower feature dimension can obtain a better
generalization ability of the classifier, and smaller computational cost can assure
the real-time processing. In the online system, the bipolar approach (i.e. FCz-C3
and FCz-C4) was employed to provide integrated power and synchrony
information over the motor cortex areas. Considering the necessity of a practical
BCI (e.g., easy electrode preparation, high performance, and low cost), electrode
placement with an implicit embedding method is an efficient approach to
implement a practical motor imagery based BCI. Recently, a method for
optimizing subject specific bipolar electrodes was proposed and demonstrated in
[33].

4. Potential Applications
4.1 Communication and Control
BCI research aims to provide a new channel for the motion disabled to
communicate with the environment. Up to now, although clinical applications
have been involved in some studies, most BCIs have been tested in the laboratory
with normal subjects [34]. Practical designs of BCIs proposed in this chapter will
benefit spreading real-life applications for the patients. For the BCI community,
further investigation of clinical applications should be emphasized. In our studies,
online demonstrations have been designed to fulfill some real-life applications.
Due to its advantage of a high ITR, the SSVEP BCI has been employed in various
applications, e.g., spelling, cursor control, and appliance control. Moreover, an
environmental controller has been tested in patients with spinal cord injury [24].
Figure 8 presents the scene of using the SSVEP-based BCI to make a phone call
[35]. The system consists of a small EEG recording system, an LED stimulator
box including a 12-target number pad and a digitron display, and a laptop for

20

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

signal processing and command transmission. A simple head-strap with two
embedded electrodes was used to record data on one bipolar channel. The user
could input a number easily through directing his or her gaze on the target
number, and then fulfill the task of making a phone call conveniently with the
laptop modem.

Fig.8. Application of the SSVEP-based BCI for making a phone call. The system
consists of two-lead EEG recording hardware, an LED visual stimulator, and a
laptop.

4.2 Rehabilitation Training
In addition to applications for communication and control technologies, a
new area of BCI application has emerged in rehabilitation research [36, 37]. It has
been proposed that BCIs may have value in neurorehabilitation by reinforcing the
use of damaged neural pathways [38]. For example, some studies have
demonstrated that motor imagery can help to restore motor function for stroke
patients [39-41]. Based on these findings, positive rehabilitation training directed
by motor intention should have a better efficiency than conventional passive
training. Figure 9 shows such a device used for lower limb rehabilitation.
Imagination of foot movement will start the device, while a resting state without
foot movement imagination will stop the training. This system still needs further
clinical investigation in the future to confirm its superiority.

21

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

Fig.9. A system used for lower limb rehabilitation. The motor imagery based BCI
is used to control the device. Positive rehabilitation training is performed in
accordance with the concurrent motor imagery of foot movement.

4.3 Computer Games
BCI technology was first proposed to benefit users belonging to the disabled
persons’ community. However, it also has potential applications for healthy users.
With numerous players, computer gaming is a potential area to employ the BCI
technique [42, 43]. Through integrating BCI to achieve additional mental control,
a computer game will be more appealing. Recently, BCI technology has been
used in the electronic games industry to make it possible for games to be
controlled and influenced by the player’s mind, e.g., Emotiv and NeuroSky
systems [44, 45]. In Fig.10, a player is absorbed in playing a game using a
portable motor imagery based BCI developed in our lab. In the near future,
besides the gaming industry, applications of BCI will also span various potential
industries, such as neuroeconomics research and neurofeedback therapy.

22

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

Fig.10. A player is playing a computer game controlled through a motor imagery
based BCI. This system is available for visitors to the Zhengzhou Science and
Technology Center in China.

5. Conclusion
Most of current BCI studies are still at the stage of laboratory
demonstrations. Here we described the challenges in changing BCIs from demos
to practically applicable systems. Our work on designs and implementations of
the BCIs based on the modulation of EEG rhythms showed that by adequately
considering parameter optimization and information processing, system cost
could be greatly decreased while system usability could be improved at the same
time. These efforts will benefit future development of BCI products with potential
applications in various fields.

Acknowledgments
This project is supported by the National Natural Science Foundation of
China (30630022) and the Science and Technology Ministry of China under
Grant 2006BAI03A17.

References

23

1.

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

J. R. Wolpaw, N. Birbaumer, D. J. McFarland, G. Pfurtscheller, and T. M.
Vaughan, “Brain-computer interfaces for communication and control,” Clin.
Neurophysiol., vol. 113, no. 6, pp. 767-791, 2002.

2.

M. A. Lebedev and M. A. L. Nicolelis, “Brain-machine interfaces: past,
present and future,” Trends Neurosci., vol. 29, no. 9, pp. 536-546, 2006.

3.

N. Birbaumer, “Brain-computer-interface research: Coming of age,” Clin.
Neurophysiol., vol. 117, no. 3, pp. 479-483, 2006.

4.

the chapter by Wolpaw and Boulay in this book

5.

G. Pfurtscheller and C. Neuper, “Motor imagery and direct brain-computer
communication,” Proc. IEEE, vol. 89, no. 7, pp. 1123-1134, 2001.

6.

T. Kluge and M. Hartmann, “Phase coherent detection of steady-state evoked
potentials:

experimental

results

and

application

to

brain-computer

interfaces,” Proc. 3rd Int. IEEE EMBS Neural Eng. Conf., pp. 425-429,
2007.
7.

S. Makeig, M. Westerfield, T. P. Jung, S. Enghoff, J. Townsend, E.
Courchesne, and T. J. Sejnowski, “Dynamic brain sources of visual evoked
responses,” Science, vol. 295, no. 5555, pp. 690-694, 2002.

8.

E. Niedermeyer and F. H. Lopes da Silva, Electroencephalography: basic
principles, clinical applications and related fields. Baltimore: Williams and
Wilkins, 1999.

9.

Y. Wang, X. Gao, B. Hong, C. Jia, and S. Gao, “Brain-Computer Interfaces
Based on Visual Evoked Potentials: Feasibility of Practical System Designs”,
IEEE EMB Mag., vol. 27, no. 5, pp. 64-71, 2008.

10. the Pfurtscheller chapter in this book on adaptive BCI, also indicating

importance of reducing number of electrodes
11. A. C. MettingVanRijn, A. P. Kuiper, T. E. Dankers, and C. A. Grimbergen,
“Low-cost active electrode improves the resolution in biopotential
recordings,” Proc. 18th Int. IEEE EMBS Conf., pp. 101-102, 1996.
12. the Li and Guan signal processing chapter in this book
13. J. R. Wolpaw and D. J. McFarland, “Control of a two-dimensional

24

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

movement signal by a noninvasive brain-computer interface in humans,”
Proc. Natl Acad. Sci. USA, vol. 101, no. 51, pp. 17849-17854, 2004.
14. B. Blankertz, K. R. Muller, D. J. Krusienski, G. Schalk, J. R. Wolpaw, A.
Schlogl, G. Pfurtscheller, J. D. R. Millan, M. Schroder, and N. Birbaumer,
“The BCI competition III: Validating alternative approaches to actual BCI
problems,” IEEE Trans. Neural Syst. Rehab. Eng., vol. 14, no. 2, pp.
153-159, 2006.
15. G. Pfurtscheller and F. H. Lopes da Silva, “Event-related EEG/MEG
synchronization

and

desynchronization:

basic

principles,”

Clin.

Neurophysiol., vol. 110, no. 11, pp. 1842-1857, 1999.
16. D. J. McFarland, C. W. Anderson, K. R. Muller, A. Schlogl, and D. J.
Krusienski, “BCI Meeting 2005 - Workshop on BCI signal processing:
Feature extraction and translation,” IEEE Trans. Neural Syst. Rehab. Eng.,
vol. 14, no. 2, pp. 135-138, 2006.
17. J. J. Vidal, “Real-time detection of brain events in EEG,” Proc. IEEE, vol. 65,
no.5, pp. 633-641, 1977.
18. E. E. Sutter, “The brain response interface: communication through
visually-induced electrical brain response,” J. Microcomput. Appl., vol. 15,
no. 1, pp. 31-45, 1992.
19. M. Middendorf, G. McMillan, G. Calhoun, and K. S. Jones, “Brain-computer
interfaces based on the steady-state visual-evoked response,” IEEE Trans.
Rehabil. Eng., vol. 8, no. 2, pp. 211-214, 2000.
20. M. Cheng, X. R. Gao, S. G. Gao, and D. F. Xu, “Design and implementation
of a brain-computer interface with high transfer rates,” IEEE Trans. Biomed.
Eng., vol. 49, no. 10, pp. 1181-1186, 2002.
21. X. Gao, D. Xu, M. Cheng, and S. Gao, “A BCI-based environmental
controller for the motion-disabled,” IEEE Trans. Neural Syst. Rehabil. Eng.,
vol. 11, no. 2, pp. 137-140, 2003.
22. B. Allison, D. McFarland, G. Schalk, S. Zheng, M. Jackson, and J. Wolpaw,
“Towards an independent brain–computer interface using steady state visual

25

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

evoked potentials,” Clin. Neurophysiol., vol. 119, no. 2, pp. 399-408, 2007.
23. F. Guo, B. Hong, X. Gao, and S. Gao, “A brain–computer interface using
motion-onset visual evoked potential,” J. Neural Eng., vol. 5, no. 4, pp.
477-485, 2008.
24. Y. Wang, R. Wang, X. Gao, B. Hong, and S. Gao, “A practical VEP-based
brain-computer interface,” IEEE Trans. Neural Syst. Rehabil. Eng., vol. 14,
no. 2, pp. 234-239, 2006.
25. Y. Wang, R. Wang, X. Gao, and S. Gao, “Brain-computer interface based on
the high frequency steady-state visual evoked potential,” Proc. 1st Int. NIC.
Conf., pp. 37-39, 2005.
26. G. R. Muller-Putz, R. Scherer, C. Brauneis, and C. Pfurtscheller,
“Steady-state visual evoked potential (SSVEP)-based communication:
impact of harmonic frequency components,” J. Neural Eng., vol. 2, no. 4, pp.
123-130, 2005.
27. J. P. Lachaux, E. Rodriguez, J. Martinerie, and F. J. Varela, “Measuring
phase synchrony in brain signals,” Hum. Brain Mapp., vol. 8, no. 4, pp.
194-208, 1999.
28. E. Gysels and P. Celka, “Phase synchronization for the recognition of mental
tasks in a brain-computer interface,” IEEE Trans. Neural Syst. Rehabil. Eng.,
vol. 12, no. 4, pp. 406-415, 2004.
29. Y. Wang, B. Hong, X. Gao, and S. Gao, “Phase synchrony measurement in
motor cortex for classifying single-trial EEG during motor imagery,” Proc.
28th Int. IEEE EMBS Conf., pp. 75-78, 2006.
30. Y. Wang, B. Hong, X. Gao, and S. Gao, “Implementation of a
brain-computer interface based on three states of motor imagery,” Proc. 29th
Int. IEEE EMBS Conf., pp. 5059-5062, 2007.
31. M. F. Bear, B. W. Connors, and M. A. Paradiso, Neuroscience: exploring the
brain. Baltimore: Lippincott Williams and Wilkins, 2001.
32. Y. Wang, B. Hong, X. Gao, and S. Gao, “Design of electrode layout for
motor imagery based brain-computer interface,” Electron. Lett., vol. 43, no.

26

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

10, pp. 557-558, 2007.
33. B. Lou, B. Hong, X. Gao, and S. Gao, “Bipolar electrode selection for a
motor imagery based brain-computer interface,” J. Neural Eng., vol. 5, vol.
3, pp. 342-349, 2008.
34. S. G. Mason, A. Bashashati, M. Fatourechi, K. F. Navarro, and G. E. Birch,
“A comprehensive survey of brain interface technology designs,” Ann.
Biomed. Eng., vol. 35, no. 2, pp. 137-169, 2007.
35. C. Jia, H. Xu, B. Hong, X. Gao, and S. Gao, “A human computer interface
using SSVEP-based BCI technology,” Lecture Notes in Computer Science,
vol. 4565, pp. 113-119, 2007.
36. E. Buch, C. Weber, L. G. Cohen, C. Braun, M. A. Dimyan, T. Ard, J.
Mellinger, A. Caria, S. Soekadar, A, Fourkas, and N. Birbaumer, “Think to
move: a neuromagnetic brain-computer interface (BCI) system for chronic
stroke,” Stroke, vol. 39, no. 3, pp. 910-917, 2008.
37. the Birbaumer and Sauseng chapter in this book about neurorehabilitation
38. A. Kubler, V. K. Mushahwar, L. R. Hochberg, and J. P. Donoghue, “BCI
Meeting 2005 - Workshop on clinical issues and applications,” IEEE Trans.
Neural Syst. Rehabil. Eng., vol. 14, no. 2, pp. 131-134, 2006.
39. S. de Vries and T. Mulder, “Motor imagery and stroke rehabilitation: A
critical discussion,” J. Rehabil. Med., vol. 39, no. 1, pp. 5-13, 2007.
40. D. Ertelt, S. Small, A. Solodkin, C. Dettmers, A. McNamara, F. Binkofski,
and G. Buccino, “Action observation has a positive impact on rehabilitation
of motor deficits after stroke,” NeuroImage, vol. 36, suppl. 2, pp. T164-T173,
2007.
41. M. Iacoboni and J. C. Mazziotta, “Mirror neuron system: Basic findings and
clinical applications,” Ann. Neurol., vol. 62, no. 3, pp. 213-218, 2007.
42. J. A. Pineda, D. S. Silverman, A. Vankov, and J. Hestenes, “Learning to
control brain rhythms: making a brain-computer interface possible,” IEEE
Trans. Neural Syst. Rehabil. Eng., vol. 11, no. 2, pp. 181-184, 2003.
43. E. C. Lalor, S. P. Kelly, C. Finucane, R. Burke, R. Smith, R. B. Reilly, and G.

27

Yijun Wang, Xiaorong Gao, Bo Hong and Shangkai Gao

McDarby, “Steady-state VEP-based brain-computer interface control in an
immersive 3D gaming environment,” EURASIP J. Appl. Signal Process., vol.
2005, no. 19, pp. 3156-3164, 2005.
44. http://www.emotiv.com.
45. http://www.neurosky.com.

